var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.inherits=function(n,r){function k(){}k.prototype=r.prototype;n.superClass_=r.prototype;n.prototype=new k;n.prototype.constructor=n;for(var g in r)if(Object.defineProperties){var f=Object.getOwnPropertyDescriptor(r,g);f&&Object.defineProperty(n,g,f)}else n[g]=r[g]};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,r,k){n!=Array.prototype&&n!=Object.prototype&&(n[r]=k.value)};$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.symbolCounter_=0;$jscomp.Symbol=function(n){return $jscomp.SYMBOL_PREFIX+(n||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.iterator;n||(n=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[n]&&$jscomp.defineProperty(Array.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(n){var r=0;return $jscomp.iteratorPrototype(function(){return r<n.length?{done:!1,value:n[r++]}:{done:!0}})};$jscomp.iteratorPrototype=function(n){$jscomp.initSymbolIterator();n={next:n};n[$jscomp.global.Symbol.iterator]=function(){return this};return n};$jscomp.makeIterator=function(n){$jscomp.initSymbolIterator();var r=n[Symbol.iterator];return r?r.call(n):$jscomp.arrayIterator(n)};
$jscomp.arrayFromIterator=function(n){for(var r,k=[];!(r=n.next()).done;)k.push(r.value);return k};$jscomp.arrayFromIterable=function(n){return n instanceof Array?n:$jscomp.arrayFromIterator($jscomp.makeIterator(n))};$jscomp.polyfill=function(n,r,k,g){if(r){k=$jscomp.global;n=n.split(".");for(g=0;g<n.length-1;g++){var f=n[g];f in k||(k[f]={});k=k[f]}n=n[n.length-1];g=k[n];r=r(g);r!=g&&null!=r&&$jscomp.defineProperty(k,n,{configurable:!0,writable:!0,value:r})}};
$jscomp.polyfill("Array.from",function(n){return n?n:function(n,k,g){$jscomp.initSymbolIterator();k=null!=k?k:function(a){return a};var f=[],e=n[Symbol.iterator];if("function"==typeof e)for(n=e.call(n);!(e=n.next()).done;)f.push(k.call(g,e.value));else for(var e=n.length,a=0;a<e;a++)f.push(k.call(g,n[a]));return f}},"es6-impl","es3");
$jscomp.iteratorFromArray=function(n,r){$jscomp.initSymbolIterator();n instanceof String&&(n+="");var k=0,g={next:function(){if(k<n.length){var f=k++;return{value:r(f,n[f]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};$jscomp.polyfill("Array.prototype.keys",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(n){return n})}},"es6-impl","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(n){function r(){this.batch_=null}function k(a){return a instanceof f?a:new f(function(b,m){b(a)})}if(n&&!$jscomp.FORCE_POLYFILL_PROMISE)return n;r.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};r.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var g=$jscomp.global.setTimeout;r.prototype.asyncExecuteFunction=function(a){g(a,
0)};r.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var m=a[b];delete a[b];try{m()}catch(c){this.asyncThrow_(c)}}}this.batch_=null};r.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var f=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(m){b.reject(m)}};f.prototype.createResolveAndReject_=
function(){function a(a){return function(c){m||(m=!0,a.call(b,c))}}var b=this,m=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};f.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof f)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};f.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(m){this.reject_(m);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};f.prototype.reject_=function(a){this.settle_(2,a)};f.prototype.fulfill_=function(a){this.settle_(1,a)};f.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};f.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var e=new r;f.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};f.prototype.settleSameAsThenable_=function(a,b){var m=this.createResolveAndReject_();try{a.call(b,m.resolve,m.reject)}catch(c){m.reject(c)}};f.prototype.then=function(a,b){function m(a,b){return"function"==typeof a?function(b){try{c(a(b))}catch(t){e(t)}}:b}var c,e,l=new f(function(a,
b){c=a;e=b});this.callWhenSettled_(m(a,c),m(b,e));return l};f.prototype.catch=function(a){return this.then(void 0,a)};f.prototype.callWhenSettled_=function(a,b){function m(){switch(c.state_){case 1:a(c.result_);break;case 2:b(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?e.asyncExecute(m):this.onSettledCallbacks_.push(function(){e.asyncExecute(m)})};f.resolve=k;f.reject=function(a){return new f(function(b,m){m(a)})};f.race=function(a){return new f(function(b,
m){for(var c=$jscomp.makeIterator(a),e=c.next();!e.done;e=c.next())k(e.value).callWhenSettled_(b,m)})};f.all=function(a){var b=$jscomp.makeIterator(a),m=b.next();return m.done?k([]):new f(function(a,e){function c(b){return function(c){h[b]=c;d--;0==d&&a(h)}}var h=[],d=0;do h.push(void 0),d++,k(m.value).callWhenSettled_(c(h.length-1),e),m=b.next();while(!m.done)})};return f},"es6-impl","es3");$jscomp.owns=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)};
$jscomp.polyfill("WeakMap",function(n){function r(a){$jscomp.owns(a,g)||$jscomp.defineProperty(a,g,{value:{}})}function k(a){var b=Object[a];b&&(Object[a]=function(a){r(a);return b(a)})}if(function(){if(!n||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),m=new n([[a,2],[b,3]]);if(2!=m.get(a)||3!=m.get(b))return!1;m.delete(a);m.set(b,4);return!m.has(a)&&4==m.get(b)}catch(c){return!1}}())return n;var g="$jscomp_hidden_"+Math.random().toString().substring(2);k("freeze");k("preventExtensions");
k("seal");var f=0,e=function(a){this.id_=(f+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(a,b){r(a);if(!$jscomp.owns(a,g))throw Error("WeakMap key fail: "+a);a[g][this.id_]=b;return this};e.prototype.get=function(a){return $jscomp.owns(a,g)?a[g][this.id_]:void 0};e.prototype.has=function(a){return $jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)};e.prototype.delete=
function(a){return $jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)?delete a[g][this.id_]:!1};return e},"es6-impl","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(n){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!n||!n.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),m=new n($jscomp.makeIterator([[a,"s"]]));if("s"!=m.get(a)||1!=m.size||m.get({x:4})||m.set({x:4},"t")!=m||2!=m.size)return!1;var c=m.entries(),e=c.next();if(e.done||e.value[0]!=a||"s"!=e.value[1])return!1;e=c.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!c.next().done?!1:!0}catch(l){return!1}}())return n;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var r=new WeakMap,k=function(a){this.data_={};this.head_=e();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};k.prototype.set=function(a,m){var b=g(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=m:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:m},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};k.prototype.delete=
function(a){a=g(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};k.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=e();this.size=0};k.prototype.has=function(a){return!!g(this,a).entry};k.prototype.get=function(a){return(a=g(this,a).entry)&&a.value};k.prototype.entries=function(){return f(this,function(a){return[a.key,
a.value]})};k.prototype.keys=function(){return f(this,function(a){return a.key})};k.prototype.values=function(){return f(this,function(a){return a.value})};k.prototype.forEach=function(a,m){for(var b=this.entries(),e;!(e=b.next()).done;)e=e.value,a.call(m,e[1],e[0],this)};k.prototype[Symbol.iterator]=k.prototype.entries;var g=function(b,m){var c=m&&typeof m;"object"==c||"function"==c?r.has(m)?c=r.get(m):(c=""+ ++a,r.set(m,c)):c="p_"+m;var e=b.data_[c];if(e&&$jscomp.owns(b.data_,c))for(b=0;b<e.length;b++){var l=
e[b];if(m!==m&&l.key!==l.key||m===l.key)return{id:c,list:e,index:b,entry:l}}return{id:c,list:e,index:-1,entry:void 0}},f=function(a,m){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:m(b)};b=null}return{done:!0,value:void 0}})},e=function(){var a={};return a.previous=a.next=a.head=a},a=0;return k},"es6-impl","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6-impl","es3");$jscomp.polyfill("Array.prototype.values",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(n,k){return k})}},"es6","es3");$jscomp.findInternal=function(n,r,k){n instanceof String&&(n=String(n));for(var g=n.length,f=0;f<g;f++){var e=n[f];if(r.call(k,e,f,n))return{i:f,v:e}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(n){return n?n:function(n,k){return $jscomp.findInternal(this,n,k).v}},"es6-impl","es3");$jscomp.polyfill("Object.is",function(n){return n?n:function(n,k){return n===k?0!==n||1/n===1/k:n!==n&&k!==k}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.includes",function(n){return n?n:function(n,k){var g=this;g instanceof String&&(g=String(g));var f=g.length;for(k=k||0;k<f;k++)if(g[k]==n||Object.is(g[k],n))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(n,r,k){if(null==n)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(r instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return n+""};$jscomp.polyfill("String.prototype.includes",function(n){return n?n:function(n,k){return-1!==$jscomp.checkStringArgs(this,n,"includes").indexOf(n,k||0)}},"es6-impl","es3");
$jscomp.polyfill("Object.assign",function(n){return n?n:function(n,k){for(var g=1;g<arguments.length;g++){var f=arguments[g];if(f)for(var e in f)$jscomp.owns(f,e)&&(n[e]=f[e])}return n}},"es6-impl","es3");$jscomp.polyfill("String.prototype.startsWith",function(n){return n?n:function(n,k){var g=$jscomp.checkStringArgs(this,n,"startsWith");n+="";var f=g.length,e=n.length;k=Math.max(0,Math.min(k|0,g.length));for(var a=0;a<e&&k<f;)if(g[k++]!=n[a++])return!1;return a>=e}},"es6-impl","es3");
$jscomp.polyfill("String.prototype.endsWith",function(n){return n?n:function(n,k){var g=$jscomp.checkStringArgs(this,n,"endsWith");n+="";void 0===k&&(k=g.length);k=Math.max(0,Math.min(k|0,g.length));for(var f=n.length;0<f&&0<k;)if(g[--k]!=n[--f])return!1;return 0>=f}},"es6-impl","es3");
var Erizo=function(n){function r(g){if(k[g])return k[g].exports;var f=k[g]={i:g,l:!1,exports:{}};n[g].call(f.exports,f,f.exports,r);f.l=!0;return f.exports}var k={};r.m=n;r.c=k;r.d=function(g,f,e){r.o(g,f)||Object.defineProperty(g,f,{configurable:!1,enumerable:!0,get:e})};r.n=function(g){var f=g&&g.__esModule?function(){return g["default"]}:function(){return g};r.d(f,"a",f);return f};r.o=function(g,f){return Object.prototype.hasOwnProperty.call(g,f)};r.p="";return r(r.s=24)}([function(n,r,k){var g=
function(){var f="";var e=function(a){console.log.apply(console,[].concat($jscomp.arrayFromIterable(a)))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){var b=a;a>g.NONE?b=g.NONE:a<g.DEBUG&&(b=g.DEBUG);g.logLevel=b},setOutputFunction:function(a){e=a},setLogPrefix:function(a){f=a},log:function(a,b){for(var m=[],c=1;c<arguments.length;++c)m[c-1]=arguments[c];c=f;if(!(a<g.logLevel))if(a===g.DEBUG?c+="DEBUG":a===g.TRACE?c+="TRACE":a===g.INFO?c+="INFO":a===g.WARNING?c+=
"WARNING":a===g.ERROR&&(c+="ERROR"),m=[c+": "].concat(m),void 0!==g.panel){for(var c="",q=0;q<m.length;q+=1)c+=m[q];g.panel.value=g.panel.value+"\n"+c}else e.apply(g,[m])},debug:function(a){for(var b=[],m=0;m<arguments.length;++m)b[m-0]=arguments[m];g.log.apply(g,[].concat([g.DEBUG],$jscomp.arrayFromIterable(b)))},trace:function(a){for(var b=[],m=0;m<arguments.length;++m)b[m-0]=arguments[m];g.log.apply(g,[].concat([g.TRACE],$jscomp.arrayFromIterable(b)))},info:function(a){for(var b=[],m=0;m<arguments.length;++m)b[m-
0]=arguments[m];g.log.apply(g,[].concat([g.INFO],$jscomp.arrayFromIterable(b)))},warning:function(a){for(var b=[],m=0;m<arguments.length;++m)b[m-0]=arguments[m];g.log.apply(g,[].concat([g.WARNING],$jscomp.arrayFromIterable(b)))},error:function(a){for(var b=[],m=0;m<arguments.length;++m)b[m-0]=arguments[m];g.log.apply(g,[].concat([g.ERROR],$jscomp.arrayFromIterable(b)))}}}();r.a=g},function(n,r,k){k.d(r,"b",function(){return f});k.d(r,"c",function(){return e});k.d(r,"d",function(){return a});k.d(r,
"e",function(){return m});k.d(r,"f",function(){return c});k.d(r,"a",function(){return b});var g=k(0),f=function(){var a={},b={};a.addEventListener=function(a,d){void 0===b[a]&&(b[a]=[]);b[a].push(d)};a.removeEventListener=function(a,d){b[a]&&(d=b[a].indexOf(d),-1!==d&&b[a].splice(d,1))};a.removeAllListeners=function(){b={}};a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");for(var d=b[a.type]||[],d=d.slice(0),h=0;h<d.length;h+=1)try{d[h](a)}catch(t){g.a.info("Error triggering event: "+
a.type+", error: "+t)}};a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;return a},e=function(){this.emitter=f()};e.prototype.addEventListener=function(a,b){this.emitter.addEventListener(a,b)};e.prototype.removeEventListener=function(a,b){this.emitter.removeEventListener(a,b)};e.prototype.dispatchEvent=function(a){this.emitter.dispatchEvent(a)};e.prototype.on=function(a,b){this.addEventListener(a,b)};e.prototype.off=function(a,b){this.removeEventListener(a,b)};e.prototype.emit=
function(a){this.dispatchEvent(a)};var a=function(a){var b={};b.type=a.type;return b},b=function(b){var c=a(b);c.stream=b.stream;c.state=b.state;return c},m=function(b){var c=a(b);c.streams=b.streams;c.message=b.message;return c},c=function(b){var c=a(b);c.stream=b.stream;c.msg=b.msg;c.origin=b.origin;c.bandwidth=b.bandwidth;c.attrs=b.attrs;return c}},function(n,r,k){var g=k(6)("ACTIVE","PASSIVE","ACTPASS","INACTIVE");g.byValue=function(f){return g[f.toUpperCase()]};g.toString=function(f){switch(f){case g.ACTIVE:return"active";
case g.PASSIVE:return"passive";case g.ACTPASS:return"actpass";case g.INACTIVE:return"inactive";default:return null}};g.reverse=function(f){switch(f){case g.ACTIVE:return g.PASSIVE;case g.PASSIVE:return g.ACTIVE;case g.ACTPASS:return g.PASSIVE;case g.INACTIVE:return g.INACTIVE;default:return g.ACTIVE}};n.exports=g},function(n,r,k){var g=k(6)("SEND","RECV");g.byValue=function(f){return g[f.toUpperCase()]};g.toString=function(f){switch(f){case g.SEND:return"send";case g.RECV:return"recv";default:return"unknown"}};
g.reverse=function(f){switch(f){case g.SEND:return g.RECV;case g.RECV:return g.SEND;default:return g.SEND}};n.exports=g},function(n,r,k){var g=k(6)("SENDRECV","SENDONLY","RECVONLY","INACTIVE");g.byValue=function(f){return g[f.toUpperCase()]};g.toString=function(f){switch(f){case g.SENDRECV:return"sendrecv";case g.SENDONLY:return"sendonly";case g.RECVONLY:return"recvonly";case g.INACTIVE:return"inactive";default:return"unknown"}};g.reverse=function(f){switch(f){case g.SENDRECV:return g.SENDRECV;case g.SENDONLY:return g.RECVONLY;
case g.RECVONLY:return g.SENDONLY;case g.INACTIVE:return g.INACTIVE;default:return g.SENDRECV}};n.exports=g},function(n,r,k){var g=k(1);r.a=function(){var f=Object(g.b)({});f.url="";return f}},function(n,r){function k(g){for(var f=[],e=0;e<arguments.length;++e)f[e-0]=arguments[e];var a=this;if(!(this instanceof k))return new (Function.prototype.bind.apply(k,[null].concat(Array.prototype.slice.call(f))));Array.from(f).forEach(function(b){$jscomp.initSymbol();a[b]=Symbol.for("LICODE_SEMANTIC_SDP_"+
b)})}n.exports=k},function(n,r,k){r.a=function(){var g={},f={};g.add=function(e,a){f[e]=a};g.get=function(e){return f[e]};g.has=function(e){return void 0!==f[e]};g.size=function(){return Object.keys(f).length};g.forEach=function(e){for(var a=Object.keys(f),b=0;b<a.length;b+=1){var m=a[b];e(f[m],m)}};g.keys=function(){return Object.keys(f)};g.remove=function(e){delete f[e]};g.clear=function(){f={}};return g}},function(n,r,k){(function(g){var f=k(0),e=function(){var a="none";"undefined"!==typeof g&&
g.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(a="electron")):null!==window.navigator.userAgent.match("Safari")?a="safari":null!==window.navigator.userAgent.match("AppleWebKit")&&(a="safari");return a};r.a={GetUserMedia:function(a,b,m){b=void 0===b?function(){}:b;m=void 0===m?function(){}:m;var c,q=function(a,b,c){navigator.mediaDevices.getUserMedia(a).then(b).catch(c)},
l=function(a,b,c){navigator.mediaDevices.getDisplayMedia(a).then(b).catch(c)},h=function(){switch(e()){case "electron":f.a.debug("Screen sharing in Electron");c={};c.video=a.video||{};c.video.mandatory=a.video.mandatory||{};c.video.mandatory.chromeMediaSource="desktop";c.video.mandatory.chromeMediaSourceId=a.desktopStreamId;q(c,b,m);break;case "mozilla":f.a.debug("Screen sharing in Firefox");c={};void 0!==a.video?(c.video=a.video,c.video.mediaSource||(c.video.mediaSource="window")):c={audio:a.audio,
video:{mediaSource:"window"}};q(c,b,m);break;case "chrome-stable":f.a.debug("Screen sharing in Chrome");c={};if(a.desktopStreamId)c.video=a.video||{mandatory:{}},c.video.mandatory=c.video.mandatory||{},c.video.mandatory.chromeMediaSource="desktop",c.video.mandatory.chromeMediaSourceId=a.desktopStreamId,q(c,b,m);else{var d="okeephmleflklcdebijnponpabbmmgeo";a.extensionId&&(f.a.debug("extensionId supplied, using "+a.extensionId),d=a.extensionId);f.a.debug("Screen access on chrome stable, looking for extension");
try{chrome.runtime.sendMessage(d,{getStream:!0},function(d){void 0===d?(f.a.error("Access to screen denied"),m({code:"Access to screen denied"})):(d=d.streamId,void 0!==a.video.mandatory?(c.video=a.video||{mandatory:{}},c.video.mandatory.chromeMediaSource="desktop",c.video.mandatory.chromeMediaSourceId=d):c={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:d}}},q(c,b,m))})}catch(x){f.a.debug("Screensharing plugin is not accessible "),m({code:"no_plugin_present"})}}break;default:f.a.error("This browser does not support ScreenSharing")}};
a.screen?a.desktopStreamId||a.extensionId?(f.a.debug("Screen access requested using GetUserMedia"),h()):(f.a.debug("Screen access requested using GetDisplayMedia"),l(a,b,m)):"undefined"!==typeof g&&g.exports?f.a.error("Video/audio streams not supported in erizofc yet"):(f.a.debug("Calling getUserMedia with config",a),q(a,b,m))},getBrowser:e}}).call(r,k(41)(n))},function(n,r,k){var g=this;n=k(28);var f=k.n(n);n=k(2);var e=k.n(n);n=k(4);var a=k.n(n),b=k(36),m=k(21),c=k(0),q=k(38);r.a=function(l){var h=
{},d=new q.a,x=new q.a,t=!1,p,u,v,k,w=-1;c.a.info("Starting Base stack",l);h.pcConfig={iceServers:[],sdpSemantics:"plan-b"};h.con={};void 0!==l.iceServers&&(h.pcConfig.iceServers=l.iceServers);!0===l.forceTurn&&(h.pcConfig.iceTransportPolicy="relay");h.audio=l.audio;h.video=l.video;void 0===h.audio&&(h.audio=!0);void 0===h.video&&(h.video=!0);l.remoteCandidates=[];l.localCandidates=[];l.remoteDescriptionSet=!1;h.mediaConstraints={offerToReceiveVideo:void 0!==h.video&&!1!==h.video,offerToReceiveAudio:void 0!==
h.audio&&!1!==h.audio};h.peerConnection=new RTCPeerConnection(h.pcConfig,h.con);var A=0;h.peerConnection.onnegotiationneeded=function(){var a=h.audio?1:0,a=a+(h.video?1:0);0===A%a&&h.createOffer(!0,!0);A+=1};var z=function(a){h.peerConnectionFsm.error(a)},n=function(){p.sdp=h.enableSimulcast(p.sdp);p.type="answer";v=f.a.SDPInfo.processString(p.sdp);m.a.setMaxBW(v,l);var b=h.remoteSdp.getStreams().size,d=v.getStreams().size,c=a.a.reverse("sendrecv"),c=0<b&&0<d?a.a.reverse("sendrecv"):0<b&&0===d?a.a.reverse("recvonly"):
0===b&&0<d?a.a.reverse("sendonly"):a.a.reverse("inactive");v.getMedias().forEach(function(a){a.setDirection(c)});p.sdp=v.toString();h.localSdp=v},C=function(){p.sdp=h.enableSimulcast(p.sdp);p.type="offer";v=f.a.SDPInfo.processString(p.sdp);m.a.setMaxBW(v,l);v.medias.forEach(function(a){a.getSetup()!==e.a.ACTPASS&&a.setSetup(e.a.ACTPASS)});p.sdp=v.toString();h.localSdp=v},y=function(a,b){p=b;C();l.callback({type:p.type,sdp:p.sdp,config:{maxVideoBW:l.maxVideoBW}})},H=function(a){p=a;n();l.callback({type:p.type,
sdp:p.sdp,config:{maxVideoBW:l.maxVideoBW}});c.a.info("Setting local description",p);c.a.debug("processOffer - Local Description",p.type,p.sdp);return h.peerConnection.setLocalDescription(p).then(function(){h.setSimulcastLayersBitrate()})};h.enqueuedCalls={negotiationQueue:{createOffer:d.protectFunction(function(a){(a=h.peerConnectionFsm.createOffer(void 0===a?!1:a))&&a.catch(z.bind(g))}),processOffer:d.protectFunction(function(a){(a=h.peerConnectionFsm.processOffer(a))&&a.catch(z.bind(g))}),processAnswer:d.protectFunction(function(a){(a=
h.peerConnectionFsm.processAnswer(a))&&a.catch(z.bind(g))}),negotiateMaxBW:d.protectFunction(function(a,b){(a=h.peerConnectionFsm.negotiateMaxBW(a,b))&&a.catch(z.bind(g))}),processNewCandidate:d.protectFunction(function(a){try{var b="object"===typeof a.candidate?a.candidate:JSON.parse(a.candidate);if("end"!==b.candidate){b.candidate=b.candidate.replace(/a=/g,"");b.sdpMLineIndex=parseInt(b.sdpMLineIndex,10);var p=new RTCIceCandidate(b);l.remoteDescriptionSet?(d.startEnqueuing(),h.peerConnectionFsm.addIceCandidate(p).catch(z.bind(g))):
l.remoteCandidates.push(p)}}catch(I){c.a.error("Error parsing candidate",a.candidate)}}),addStream:d.protectFunction(function(a){d.startEnqueuing();(a=h.peerConnectionFsm.addStream(a))?a.catch(z.bind(g)):(d.stopEnqueuing(),d.nextInQueue())}),removeStream:d.protectFunction(function(a){d.startEnqueuing();(a=h.peerConnectionFsm.removeStream(a))?a.catch(z.bind(g)):(d.stopEnqueuing(),d.nextInQueue())}),close:d.protectFunction(function(){d.startEnqueuing();var a=h.peerConnectionFsm.close();a?a.catch(z.bind(g)):
(d.stopEnqueuing(),d.nextInQueue())})},firstLocalDescriptionQueue:{createOffer:x.protectFunction(function(a,b){a=void 0===a?!1:a;b=void 0===b?!1:b;t||x.startEnqueuing();a||b||(h.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1});h.enqueuedCalls.negotiationQueue.createOffer(a)}),sendOffer:x.protectFunction(function(){t?y(!0,p):h.createOffer(!0,!0)}),processOffer:x.protectFunction(function(a){t||x.startEnqueuing();h.enqueuedCalls.negotiationQueue.processOffer(a)})}};h.protectedCalls=
{protectedAddStream:function(a){h.peerConnection.addStream(a);setTimeout(function(){d.stopEnqueuing();d.nextInQueue()},0);return Promise.resolve()},protectedRemoveStream:function(a){h.peerConnection.removeStream(a);setTimeout(function(){d.stopEnqueuing();d.nextInQueue()},0);return Promise.resolve()},protectedCreateOffer:function(a){a=void 0===a?!1:a;d.startEnqueuing();c.a.debug("Creating offer",h.mediaConstraints);var b=[];return h.peerConnection.createOffer(h.mediaConstraints).then(y.bind(null,a)).catch(function(a){b.push("in protectedCreateOffer-createOffer, error: "+
a)}).then(function(){setTimeout(function(){d.stopEnqueuing();d.nextInQueue()},0);return 0!==b.length?Promise.reject(b):Promise.resolve()})},protectedProcessOffer:function(a){c.a.info("Protected process Offer,",a,"localDesc",p);var b=(k=f.a.SDPInfo.processString(a.sdp))&&k.origin&&k.origin.sessionVersion;if(w>=b)return c.a.warning("message: processOffer discarding old sdp sessionVersion: "+b+", latestSessionVersion: "+w),l.callback({type:"answer",sdp:p.sdp,config:{maxVideoBW:l.maxVideoBW}}),Promise.resolve();
d.startEnqueuing();w=b;m.a.setMaxBW(k,l);k.medias.forEach(function(a){a.getSetup()!==e.a.ACTPASS&&a.setSetup(e.a.ACTPASS)});a.sdp=k.toString();h.remoteSdp=k;var u=[];return h.peerConnection.setRemoteDescription(a).then(function(){l.remoteDescriptionSet=!0}).then(function(){return h.peerConnection.createAnswer(h.mediaConstraints)}).catch(function(a){u.push("in: protectedProcessOffer-createAnswer, error: "+a)}).then(H.bind(g)).catch(function(a){u.push("in: protectedProcessOffer-setLocalDescForAnswer, error: "+
a)}).then(function(){setTimeout(function(){t=!0;x.stopEnqueuing();x.dequeueAll();d.stopEnqueuing();d.nextInQueue()},0);return 0!==u.length?Promise.reject(u):Promise.resolve()})},protectedProcessAnswer:function(a){var b=(k=f.a.SDPInfo.processString(a.sdp))&&k.origin&&k.origin.sessionVersion;if(w>=b)return c.a.warning("processAnswer discarding old sdp, sessionVersion: "+b+", latestSessionVersion: "+w),Promise.resolve();d.startEnqueuing();w=b;c.a.info("Set remote and local description");m.a.setMaxBW(k,
l);h.setStartVideoBW(k);h.setHardMinVideoBW(k);a.sdp=k.toString();C();c.a.debug("processAnswer - Remote Description",a.type,a.sdp);c.a.debug("processAnswer - Local Description",a.type,p.sdp);h.remoteSdp=k;u=a;var e=[];return h.peerConnection.setLocalDescription(p).then(function(){h.setSimulcastLayersBitrate();h.peerConnection.setRemoteDescription(new RTCSessionDescription(a))}).then(function(){l.remoteDescriptionSet=!0;for(c.a.info("Candidates to be added: ",l.remoteCandidates.length,l.remoteCandidates);0<
l.remoteCandidates.length;)h.peerConnectionFsm.addIceCandidate(l.remoteCandidates.shift()).catch(z.bind(g));for(c.a.info("Local candidates to send:",l.localCandidates.length);0<l.localCandidates.length;)l.callback({type:"candidate",candidate:l.localCandidates.shift()})}).catch(function(a){e.push("in: protectedProcessAnswer, error: "+a)}).then(function(){setTimeout(function(){t=!0;x.stopEnqueuing();x.dequeueAll();d.stopEnqueuing();d.nextInQueue()},0);return 0!==e.length?Promise.reject(e):Promise.resolve()})},
protectedNegotiateMaxBW:function(a,b){if(a.Sdp||a.maxAudioBW){d.startEnqueuing();var c=[];C();h.peerConnection.setLocalDescription(p).then(function(){h.setSimulcastLayersBitrate();k=f.a.SDPInfo.processString(u.sdp);m.a.setMaxBW(k,l);u.sdp=k.toString();h.remoteSdp=k;return h.peerConnection.setRemoteDescription(new RTCSessionDescription(u))}).then(function(){l.remoteDescriptionSet=!0;l.callback({type:"offer-noanswer",sdp:p.sdp})}).catch(function(a){b("error","updateSpec");c.push("in: protectedNegotiateMaxBW error: "+
a)}).then(function(){setTimeout(function(){d.stopEnqueuing();d.nextInQueue()},0);return 0!==c.length?Promise.reject(c):Promise.resolve()})}},protectedAddIceCandiate:function(a){var b=[];return h.peerConnection.addIceCandidate(a).catch(function(a){b.push("in: protectedAddIceCandidate, error: "+a)}).then(function(){setTimeout(function(){d.stopEnqueuing();d.nextInQueue()},0);return 0!==b.length?Promise.reject(b):Promise.resolve()})},protectedClose:function(){h.peerConnection.close();setTimeout(function(){d.stopEnqueuing();
d.nextInQueue()},0);return Promise.resolve()}};h.peerConnection.onicecandidate=function(a){(a=a.candidate)?(a={sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid,candidate:a.candidate},a.candidate.match(/a=/)||(a.candidate="a\x3d"+a.candidate)):(c.a.info("Gathered all candidates. Sending END candidate"),a={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});l.remoteDescriptionSet?l.callback({type:"candidate",candidate:a}):(l.localCandidates.push(a),c.a.info("Storing candidate: ",l.localCandidates.length,a))};
h.setStartVideoBW=function(a){c.a.error("startVideoBW not implemented for this browser");return a};h.setHardMinVideoBW=function(a){c.a.error("hardMinVideoBw not implemented for this browser");return a};h.enableSimulcast=function(a){c.a.error("Simulcast not implemented");return a};h.updateSimulcastLayersBitrate=function(a){h.simulcast&&(h.simulcast.spatialLayerBitrates=a,h.setSimulcastLayersBitrate())};h.setSimulcastLayersBitrate=function(){c.a.error("Simulcast not implemented")};h.setSimulcast=function(a){h.simulcast=
a};h.setVideo=function(a){h.video=a};h.setAudio=function(a){h.audio=a};h.updateSpec=function(a,b,d){d=void 0===d?function(){}:d;var p=l.p2p&&a.maxVideoBW,e=!l.p2p&&a.maxVideoBW;a.maxVideoBW&&(c.a.debug("Maxvideo Requested:",a.maxVideoBW,"limit:",l.limitMaxVideoBW),a.maxVideoBW>l.limitMaxVideoBW&&(a.maxVideoBW=l.limitMaxVideoBW),l.maxVideoBW=a.maxVideoBW,c.a.debug("Result",l.maxVideoBW));a.maxAudioBW&&(a.maxAudioBW>l.limitMaxAudioBW&&(a.maxAudioBW=l.limitMaxAudioBW),l.maxAudioBW=a.maxAudioBW);(p||
a.maxAudioBW)&&h.enqueuedCalls.negotiationQueue.negotiateMaxBW(a,d);if(e||a.minVideoBW||void 0!==a.slideShowMode||void 0!==a.muteStream||void 0!==a.qualityLayer||void 0!==a.slideShowBelowLayer||void 0!==a.video)c.a.debug("MaxVideoBW Changed to ",a.maxVideoBW),c.a.debug("MinVideo Changed to ",a.minVideoBW),c.a.debug("SlideShowMode Changed to ",a.slideShowMode),c.a.debug("muteStream changed to ",a.muteStream),c.a.debug("Video Constraints",a.video),c.a.debug("Will activate slideshow when below layer",
a.slideShowBelowLayer),l.callback({type:"updatestream",config:a},b)};h.createOffer=h.enqueuedCalls.firstLocalDescriptionQueue.createOffer;h.sendOffer=h.enqueuedCalls.firstLocalDescriptionQueue.sendOffer;h.addStream=h.enqueuedCalls.negotiationQueue.addStream;h.removeStream=h.enqueuedCalls.negotiationQueue.removeStream;h.close=h.enqueuedCalls.negotiationQueue.close;h.processSignalingMessage=function(a){"offer"===a.type?h.enqueuedCalls.firstLocalDescriptionQueue.processOffer(a):"answer"===a.type?h.enqueuedCalls.negotiationQueue.processAnswer(a):
"candidate"===a.type?h.enqueuedCalls.negotiationQueue.processNewCandidate(a):"error"===a.type&&(c.a.error("Received error signaling message, state:",a.previousType,x.isEnqueueing()),"offer"===a.previousType&&x.isEnqueueing()&&(x.stopEnqueuing(),x.nextInQueue()))};h.peerConnectionFsm=new b.a(h.protectedCalls);return h}},function(n,r){var k=n.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),
format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol",
"payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(g){return g.encoding?"rtpmap:%d %s/%s/%s":g.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(g){return null!=
g.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(g){return null!=g.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(g){return"extmap:%d"+(g.direction?"/%s":"%v")+
" %s"+(g.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(g){return null!=g.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",
reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:"foundation component transport priority ip port type raddr rport tcptype generation network-id network-cost".split(" "),
format:function(g){var f="candidate:%s %d %s %d %s %d typ %s"+(null!=g.raddr?" raddr %s rport %d":"%v%v");f+=null!=g.tcptype?" tcptype %s":"%v";null!=g.generation&&(f+=" generation %d");f+=null!=g["network-id"]?" network-id %d":"%v";return f+=null!=g["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",
reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(g){var f="ssrc:%d";null!=g.attribute&&(f+=" %s",null!=g.value&&(f+=":%s"));return f}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},
{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(g){return null!=g.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(g){return g.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",
reg:/^imageattr:(\d+|\*)[\s\t]+(send|recv)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*)(?:[\s\t]+(recv|send)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*))?/,names:["pt","dir1","attrs1","dir2","attrs2"],format:function(g){return"imageattr:%s %s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast",reg:/^simulcast:(send|recv) ([a-zA-Z0-9\-_~;,]+)(?:\s?(send|recv) ([a-zA-Z0-9\-_~;,]+))?$/,names:["dir1","list1","dir2","list2"],format:function(g){return"simulcast:%s %s"+(g.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,
names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(k).forEach(function(g){k[g].forEach(function(f){f.reg||(f.reg=/(.*)/);f.format||(f.format="%s")})})},function(n,r){var k=function(g,f,e,a,b,m,c,q,l,h){this.foundation=g;this.componentId=f;this.transport=e;this.priority=a;this.address=b;this.port=m;this.type=c;this.generation=q;this.relAddr=l;this.relPort=h};k.prototype.clone=function(){return new k(this.foundation,
this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.generation,this.relAddr,this.relPort)};k.prototype.plain=function(){var g={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type,generation:this.generation};this.relAddr&&(g.relAddr=this.relAddr);this.relPort&&(g.relPort=this.relPort);return g};k.prototype.getFoundation=function(){return this.foundation};k.prototype.getComponentId=
function(){return this.componentId};k.prototype.getTransport=function(){return this.transport};k.prototype.getPriority=function(){return this.priority};k.prototype.getAddress=function(){return this.address};k.prototype.getPort=function(){return this.port};k.prototype.getType=function(){return this.type};k.prototype.getGeneration=function(){return this.generation};k.prototype.getRelAddr=function(){return this.relAddr};k.prototype.getRelPort=function(){return this.relPort};n.exports=k},function(n,r){var k=
function(g,f,e,a,b,m){this.codec=g;this.type=f;this.rate=e;this.encoding=a;this.params=b||{};this.feedback=m||[]};k.prototype.clone=function(){var g=new k(this.codec,this.type,this.rate,this.encoding,this.params,this.feedback);this.rtx&&g.setRTX(this.rtx);return g};k.prototype.plain=function(){return{codec:this.codec,type:this.type,rate:this.rate,encoding:this.encoding,params:this.params,feedback:this.feedback}};k.prototype.setRTX=function(g){this.rtx=g};k.prototype.getType=function(){return this.type};
k.prototype.setType=function(g){this.type=g};k.prototype.getCodec=function(){return this.codec};k.prototype.getParams=function(){return this.params};k.prototype.setParam=function(g,f){this.params[g]=f};k.prototype.hasRTX=function(){return this.rtx};k.prototype.getRTX=function(){return this.rtx};k.prototype.getRate=function(){return this.rate};k.prototype.getEncoding=function(){return this.encoding};k.prototype.getFeedback=function(){return this.feedback};k.mapFromNames=function(g,f){var e=new Map,
a=96;g.forEach(function(b){b=b.toLowerCase();var m="pcmu"===b?0:"pcma"===b?8:a+=1;m=new k(b,m);f&&"ulpfec"!==b&&"flexfec-03"!==b&&"red"!==b&&(a+=1,m.setRTX(a));e.set(m.getCodec().toLowerCase(),m)});return e};n.exports=k},function(n,r,k){var g=k(2),f=function(e,a,b){this.setup=e;this.hash=a;this.fingerprint=b};f.prototype.clone=function(){return new f(this.setup,this.hash,this.fingerprint)};f.prototype.plain=function(){return{setup:g.toString(this.setup),hash:this.hash,fingerprint:this.fingerprint}};
f.prototype.getFingerprint=function(){return this.fingerprint};f.prototype.getHash=function(){return this.hash};f.prototype.getSetup=function(){return this.setup};f.prototype.setSetup=function(e){this.setup=e};n.exports=f},function(n,r){function k(e){e=new Uint8Array(e);for(var a=0;a<e.length;a+=1)e[a]=Math.floor(256*Math.random()+0);return e}function g(e){return Array.prototype.map.call(new Uint8Array(e),function(a){return("00"+a.toString(16)).slice(-2)}).join("")}var f=function(e,a,b){this.ufrag=
e;this.pwd=a;this.opts=b;this.endOfCandidates=this.lite=!1};f.prototype.clone=function(){var e=new f(this.ufrag,this.pwd,this.opts);e.setLite(this.lite);e.setEndOfCandidates(this.endOfCandidates);return e};f.prototype.plain=function(){var e={ufrag:this.ufrag,pwd:this.pwd};this.lite&&(e.lite=this.lite);this.endOfCandidates&&(e.endOfCandidates=this.endOfCandidates);return e};f.prototype.getUfrag=function(){return this.ufrag};f.prototype.getPwd=function(){return this.pwd};f.prototype.isLite=function(){return this.lite};
f.prototype.getOpts=function(){return this.opts};f.prototype.setLite=function(e){this.lite=e};f.prototype.isEndOfCandidates=function(){return this.endOfCandidates};f.prototype.setEndOfCandidates=function(e){this.endOfCandidates=e};f.generate=function(){var e=new f,a=k(8),b=k(24);e.ufrag=g(a);e.pwd=g(b);return e};n.exports=f},function(n,r,k){var g=k(16),f=k(4),e=k(3),a=function(a,e,c){this.id=a;this.type=c;this.port=e;this.direction=f.SENDRECV;this.extensions=new Map;this.codecs=new Map;this.rids=
new Map;this.simulcast_03=this.simulcast=null;this.bitrate=0;this.connection=this.dtls=this.ice=null;this.candidates=[]};a.prototype.clone=function(){var b=new a(this.id,this.port,this.type);b.setDirection(this.direction);b.setBitrate(this.bitrate);b.setConnection(this.connection);this.codecs.forEach(function(a){b.addCodec(a.clone())});this.extensions.forEach(function(a,c){b.addExtension(c,a)});this.rids.forEach(function(a,c){b.addRID(c,a.clone())});this.simulcast&&b.setSimulcast(this.simulcast.clone());
this.xGoogleFlag&&b.setXGoogleFlag(this.xGoogleFlag);this.ice&&b.setICE(this.ice.clone());this.dtls&&b.setDTLS(this.dtls.clone());this.candidates.forEach(function(a){b.addCandidate(a.clone())});this.setup&&b.setSetup(this.setup);return b};a.prototype.plain=function(){var a={id:this.id,port:this.port,type:this.type,connection:this.connection,direction:f.toString(this.direction),xGoogleFlag:this.xGoogleFlag,extensions:{},rids:[],codecs:[],candidates:[]};this.bitrate&&(a.bitrate=this.bitrate);this.codecs.forEach(function(b){a.codecs.push(b.plain())});
this.extensions.forEach(function(b){a.extensions.push(b.plain())});this.rids.forEach(function(b){a.rids.push(b.plain())});this.simulcast&&(a.simulcast=this.simulcast.plain());this.candidates.forEach(function(b){a.candidates.push(b.plain())});a.ice=this.ice&&this.ice.plain();a.dtls=this.dtls&&this.dtls.plain();return a};a.prototype.getType=function(){return this.type};a.prototype.getPort=function(){return this.port};a.prototype.getId=function(){return this.id};a.prototype.addExtension=function(a,e){this.extensions.set(a,
e)};a.prototype.addRID=function(a){this.rids.set(a.getId(),a)};a.prototype.addCodec=function(a){this.codecs.set(a.getType(),a)};a.prototype.getCodecForType=function(a){return this.codecs.get(a)};a.prototype.getCodec=function(a){var b;this.codecs.forEach(function(c){c.getCodec().toLowerCase()===a.toLowerCase()&&(b=c)});return b};a.prototype.hasCodec=function(a){return null!==this.getCodec(a)};a.prototype.getCodecs=function(){return this.codecs};a.prototype.getExtensions=function(){return this.extensions};
a.prototype.getRIDs=function(){return this.rids};a.prototype.getRID=function(a){return this.rids.get(a)};a.prototype.getBitrate=function(){return this.bitrate};a.prototype.setBitrate=function(a){this.bitrate=a};a.prototype.getDirection=function(){return this.direction};a.prototype.setDirection=function(a){this.direction=a};a.prototype.getDTLS=function(){return this.dtls};a.prototype.setDTLS=function(a){this.dtls=a};a.prototype.getICE=function(){return this.ice};a.prototype.setICE=function(a){this.ice=
a};a.prototype.addCandidate=function(a){this.candidates.push(a)};a.prototype.addCandidates=function(a){var b=this;a.forEach(function(a){b.addCandidate(a)})};a.prototype.getCandidates=function(){return this.candidates};a.prototype.setXGoogleFlag=function(a){this.xGoogleFlag=a};a.prototype.getXGoogleFlag=function(){return this.xGoogleFlag};a.prototype.getConnection=function(){return this.connection};a.prototype.setConnection=function(a){this.connection=a};a.prototype.answer=function(b){var m=new a(this.id,
this.port,this.type);m.setDirection(f.reverse(this.direction));b.codecs&&this.codecs.forEach(function(a){if(b.codecs.has(a.getCodec().toLowerCase())){var c=b.codecs.get(a.getCodec().toLowerCase()).clone();c.setType(a.getType());c.hasRTX()&&c.setRTX(a.getRTX());m.addCodec(c)}});this.extensions.forEach(function(a,c){b.extensions.has(c)&&m.addExtension(c,a)});if(b.simulcast&&this.simulcast){var c=new g,q=this.simulcast.getSimulcastStreams(e.SEND);q&&q.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});
c.addSimulcastAlternativeStreams(e.RECV,b)});(q=this.simulcast.getSimulcastStreams(e.RECV))&&q.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});c.addSimulcastAlternativeStreams(e.SEND,b)});this.rids.forEach(function(a){var b=a.clone();b.setDirection(e.reverse(a.getDirection()));m.addRID(b)});m.setSimulcast(c)}return m};a.prototype.getSimulcast=function(){return this.simulcast};a.prototype.setSimulcast=function(a){this.simulcast=a};a.prototype.getSimulcast03=function(){return this.simulcast_03};
a.prototype.setSimulcast03=function(a){this.simulcast_03=a};a.prototype.getSetup=function(){return this.setup};a.prototype.setSetup=function(a){this.setup=a};n.exports=a},function(n,r,k){var g=k(3),f=function(){this.send=[];this.recv=[];this.plainString=null};f.prototype.clone=function(){var e=new f;this.send.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});e.addSimulcastAlternativeStreams(b)});this.recv.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});
e.addSimulcastAlternativeStreams(b)});return e};f.prototype.plain=function(){var e={send:[],recv:[]};this.send.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.plain())});e.send.push(b)});this.recv.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.plain())});e.recv.push(b)});return e};f.prototype.addSimulcastAlternativeStreams=function(e,a){return e===g.SEND?this.send.push(a):this.recv.push(a)};f.prototype.addSimulcastStream=function(e,a){return e===g.SEND?this.send.push([a]):
this.recv.push([a])};f.prototype.getSimulcastStreams=function(e){return e===g.SEND?this.send:this.recv};f.prototype.setSimulcastPlainString=function(e){this.plainString=e};f.prototype.getSimulcastPlainString=function(){return this.plainString};n.exports=f},function(n,r){var k=function(g,f){var e=this;this.semantics=g;this.ssrcs=[];f.forEach(function(a){e.ssrcs.push(parseInt(a,10))})};k.prototype.clone=function(){return new k(this.semantics,this.ssrcs)};k.prototype.plain=function(){var g={semantics:this.semantics,
ssrcs:[]};g.ssrcs=this.ssrcs;return g};k.prototype.getSemantics=function(){return this.semantics};k.prototype.getSSRCs=function(){return this.ssrcs};n.exports=k},function(n,r){var k=function(g){this.ssrc=g};k.prototype.clone=function(){var g=new k(this.ssrc);g.setCName(this.cname);g.setStreamId(this.streamId);this.setTrackId(this.trackId)};k.prototype.plain=function(){var g={ssrc:this.ssrc};this.cname&&(g.cname=this.cname);this.label&&(g.label=this.label);this.mslabel&&(g.mslabel=this.mslabel);this.streamId&&
(g.streamId=this.streamId);this.trackId&&(g.trackid=this.trackId);return g};k.prototype.getCName=function(){return this.cname};k.prototype.setCName=function(g){this.cname=g};k.prototype.getStreamId=function(){return this.streamId};k.prototype.setStreamId=function(g){this.streamId=g};k.prototype.getTrackId=function(){return this.trackId};k.prototype.setTrackId=function(g){this.trackId=g};k.prototype.getMSLabel=function(){return this.mslabel};k.prototype.setMSLabel=function(g){this.mslabel=g};k.prototype.getLabel=
function(){return this.label};k.prototype.setLabel=function(g){this.label=g};k.prototype.getSSRC=function(){return this.ssrc};n.exports=k},function(n,r){var k=function(g){this.id=g;this.tracks=new Map};k.prototype.clone=function(){var g=new k(this.id);this.tracks.forEach(function(f){g.addTrack(f.clone())});return g};k.prototype.plain=function(){var g={id:this.id,tracks:[]};this.tracks.forEach(function(f){g.tracks.push(f.plain())});return g};k.prototype.getId=function(){return this.id};k.prototype.addTrack=
function(g){this.tracks.set(g.getId(),g)};k.prototype.getFirstTrack=function(g){var f;this.tracks.forEach(function(e){e.getMedia().toLowerCase()===g.toLowerCase()&&(f=e)});return f};k.prototype.getTracks=function(){return this.tracks};k.prototype.removeAllTracks=function(){this.tracks.clear()};k.prototype.getTrack=function(g){return this.tracks.get(g)};n.exports=k},function(n,r){var k=function(g,f){this.media=g;this.id=f;this.ssrcs=[];this.groups=[];this.encodings=[]};k.prototype.clone=function(){var g=
new k(this.media,this.id);this.mediaId&&g.setMediaId(this.mediaId);this.ssrcs.forEach(function(f){g.addSSRC(f)});this.groups.forEach(function(f){g.addSourceGroup(f.clone())});this.encodings.forEach(function(f){var e=[];f.forEach(function(a){e.push(a.cloned())});g.addAlternativeEncoding(e)});return g};k.prototype.plain=function(){var g={media:this.media,id:this.id,ssrcs:[],groups:[],encodings:[]};this.mediaId&&(g.mediaId=this.mediaId);this.ssrcs.forEach(function(f){g.ssrcs.push(f)});this.groups.forEach(function(f){g.groups.push(f.plain())});
this.encodings.forEach(function(f){var e=[];f.forEach(function(a){e.push(a.plain())});g.encodings.push(e)});return g};k.prototype.getMedia=function(){return this.media};k.prototype.setMediaId=function(g){this.mediaId=g};k.prototype.getMediaId=function(){return this.mediaId};k.prototype.getId=function(){return this.id};k.prototype.addSSRC=function(g){this.ssrcs.push(g)};k.prototype.getSSRCs=function(){return this.ssrcs};k.prototype.addSourceGroup=function(g){this.groups.push(g)};k.prototype.getSourceGroup=
function(g){var f;this.groups.forEach(function(e){e.getSemantics().toLowerCase()===g.toLowerCase()&&(f=e)});return f};k.prototype.getSourceGroups=function(){return this.groups};k.prototype.hasSourceGroup=function(g){var f=!1;this.groups.forEach(function(e){e.getSemantics().toLowerCase()===g.toLowerCase()&&(f=!0)});return f};k.prototype.getEncodings=function(){return this.encodings};k.prototype.addAlternaticeEncodings=function(g){this.encodings.push(g)};k.prototype.setEncodings=function(g){this.encodings=
g};n.exports=k},function(n,r,k){r.a={addSim:function(g){var f="a\x3dssrc-group:SIM";g.forEach(function(e){f+=" "+e});return f+"\r\n"},addGroup:function(g,f){return"a\x3dssrc-group:FID "+g+" "+f+"\r\n"},addSpatialLayer:function(g,f,e,a,b,m){return"a\x3dssrc:"+b+" cname:"+g+"\r\n"+("a\x3dssrc:"+b+" msid:"+f+"\r\n")+("a\x3dssrc:"+b+" mslabel:"+e+"\r\n")+("a\x3dssrc:"+b+" label:"+a+"\r\n")+("a\x3dssrc:"+m+" cname:"+g+"\r\n")+("a\x3dssrc:"+m+" msid:"+f+"\r\n")+("a\x3dssrc:"+m+" mslabel:"+e+"\r\n")+("a\x3dssrc:"+
m+" label:"+a+"\r\n")},setMaxBW:function(g,f){if(f.p2p){if(f.video&&f.maxVideoBW){var e=g.getMedia("video");e&&e.setBitrate(f.maxVideoBW)}f.audio&&f.maxAudioBW&&(g=g.getMedia("audio"))&&g.setBitrate(f.maxAudioBW)}},enableOpusNacks:function(g){var f=g.match(/a=rtpmap:(.*)opus.*\r\n/);null!==f&&(g=g.replace(f[0],f[0]+"a\x3drtcp-fb:"+f[1]+"nack\r\n"));return g},setParamForCodecs:function(g,f,e,a){g.medias.forEach(function(b){b.id===f&&b.codecs.forEach(function(b){b.setParam(e,a)})})}}},function(n,r,
k){var g=this,f=k(1),e=k(8),a=k(7),b=k(44),m=k(45),c=k(47),q=k(0);r.a=function(l,h){var d=Object(f.b)(h);d.stream=h.stream;d.url=h.url;d.recording=h.recording;d.room=void 0;d.showing=!1;d.local=!1;d.video=h.video;d.audio=h.audio;d.screen=h.screen;d.videoSize=h.videoSize;d.videoFrameRate=h.videoFrameRate;d.extensionId=h.extensionId;d.desktopStreamId=h.desktopStreamId;d.audioMuted=!1;d.videoMuted=!1;d.unsubscribing={callbackReceived:!1,pcEventReceived:!1};d.p2p=!1;d.ConnectionHelpers=void 0===l?e.a:
l;void 0!==d.url&&(h.label="ei_"+b.a.getRandomValue());var x=function(a){a.stream.id===d.getLabel()&&d.emit(Object(f.f)({type:"added",stream:a.stream}))},t=function(a){a.stream.id===d.getLabel()&&d.emit(Object(f.f)({type:"removed",stream:d}))},p=function(a){d.emit(Object(f.f)({type:"icestatechanged",msg:a}))};if(!(void 0===d.videoSize||d.videoSize instanceof Array&&4===d.videoSize.length))throw Error("Invalid Video Size");if(void 0===h.local||!0===h.local)d.local=!0;d.getID=function(){return d.local&&
!h.streamID?"local":h.streamID};d.getLabel=function(){return d.stream&&d.stream.id?d.stream.id:h.label};d.getAttributes=function(){return h.attributes};d.setAttributes=function(a){d.local?d.emit(Object(f.f)({type:"internal-set-attributes",stream:d,attrs:a})):q.a.error("Failed to set attributes data. This Stream object has not been published.")};d.updateLocalAttributes=function(a){h.attributes=a};d.hasAudio=function(){return!1!==h.audio&&void 0!==h.audio};d.hasVideo=function(){return!1!==h.video&&
void 0!==h.video};d.hasData=function(){return!1!==h.data&&void 0!==h.data};d.hasScreen=function(){return h.screen};d.hasMedia=function(){return h.audio||h.video||h.screen};d.isExternal=function(){return void 0!==d.url||void 0!==d.recording};d.addPC=function(b,c){c?(d.p2p=!0,void 0===d.pc&&(d.pc=Object(a.a)()),d.pc.add(c,b),b.on("ice-state-change",p)):(d.pc&&(d.pc.off("add-stream",x),d.pc.off("remove-stream",t),d.pc.off("ice-state-change",p)),d.pc=b,d.pc.on("add-stream",x),d.pc.on("remove-stream",
t),d.pc.on("ice-state-change",p))};d.sendData=function(a){d.local&&d.hasData()?d.emit(Object(f.f)({type:"internal-send-data",stream:d,msg:a})):q.a.error("Failed to send data. This Stream object has not been published.")};d.init=function(){try{if((h.audio||h.video||h.screen)&&void 0===h.url){q.a.info("Requested access to local media");var a=h.video;!0===a||!0===h.screen?(a=!0===a||null===a?{}:a,void 0!==d.videoSize&&(a.width={min:d.videoSize[0],max:d.videoSize[2]},a.height={min:d.videoSize[1],max:d.videoSize[3]}),
void 0!==d.videoFrameRate&&(a.frameRate={min:d.videoFrameRate[0],max:d.videoFrameRate[1]})):!0===h.screen&&void 0===a&&(a=!0);d.ConnectionHelpers.GetUserMedia({video:a,audio:h.audio,fake:h.fake,screen:h.screen,extensionId:d.extensionId,desktopStreamId:d.desktopStreamId},function(a){q.a.info("User has granted access to local media.");d.stream=a;d.dispatchEvent(Object(f.f)({type:"access-accepted"}));d.stream.getTracks().forEach(function(a){q.a.info("getTracks",a);a.onended=function(){d.stream.getTracks().forEach(function(a){a.onended=
null});var b=Object(f.f)({type:"stream-ended",stream:d,msg:a.kind});d.dispatchEvent(b)}})},function(a){q.a.error("Failed to get access to local media. Error was "+a.name+" with message "+a.message+".");a=Object(f.f)({type:"access-denied",msg:a});d.dispatchEvent(a)})}else{var b=Object(f.f)({type:"access-accepted"});d.dispatchEvent(b)}}catch(z){q.a.error("Failed to get access to local media. Error was "+z+"."),a=Object(f.f)({type:"access-denied",msg:z}),d.dispatchEvent(a)}};d.close=function(){d.local&&
(void 0!==d.room&&d.room.unpublish(d),d.hide(),void 0!==d.stream&&d.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}),d.stream=void 0);d.pc&&!d.p2p?(d.pc.off("add-stream",x),d.pc.off("remove-stream",t),d.pc.off("ice-state-change",p)):d.pc&&d.p2p&&d.pc.forEach(function(a){a.off("add-stream",x);a.off("remove-stream",t);a.off("ice-state-change",p)});d.removeAllListeners()};d.play=function(a,b){b=b||{};d.elementID=a;d.hasVideo()||d.hasScreen()?void 0!==a&&(a=Object(m.a)({id:d.getID(),stream:d,
elementID:a,options:b}),d.player=a,d.showing=!0):d.hasAudio()&&(a=Object(c.a)({id:d.getID(),stream:d,elementID:a,options:b}),d.player=a,d.showing=!0)};d.stop=function(){d.showing&&void 0!==d.player&&(d.player.destroy(),d.showing=!1)};d.show=d.play;d.hide=d.stop;var u=function(){if(void 0!==d.player&&void 0!==d.stream){var a=d.player.video,b=document.defaultView.getComputedStyle(a),c=parseInt(b.getPropertyValue("width"),10),h=parseInt(b.getPropertyValue("height"),10),p=parseInt(b.getPropertyValue("left"),
10),b=parseInt(b.getPropertyValue("top"),10);var l="object"===typeof d.elementID&&"function"===typeof d.elementID.appendChild?d.elementID:document.getElementById(d.elementID);var e=document.defaultView.getComputedStyle(l);l=parseInt(e.getPropertyValue("width"),10);var e=parseInt(e.getPropertyValue("height"),10),m=document.createElement("canvas");m.id="testing";m.width=l;m.height=e;m.setAttribute("style","display: none");m.getContext("2d").drawImage(a,p,b,c,h);return m}return null};d.getVideoFrameURL=
function(a){var b=u();return null!==b?a?b.toDataURL(a):b.toDataURL():null};d.getVideoFrame=function(){var a=u();return null!==a?a.getContext("2d").getImageData(0,0,a.width,a.height):null};d.checkOptions=function(a,b){if(!0===b){if(a.audio||a.screen)q.a.warning("Cannot update type of subscription"),a.audio=void 0,a.screen=void 0}else!1===d.local&&(!0===a.video&&!1===d.hasVideo()&&(q.a.warning("Trying to subscribe to video when there is no video, won't subscribe to video"),a.video=!1),!0===a.audio&&
!1===d.hasAudio()&&(q.a.warning("Trying to subscribe to audio when there is no audio, won't subscribe to audio"),a.audio=!1));!1!==d.local||d.hasVideo()||!0!==a.slideShowMode||(q.a.warning("Cannot enable slideShowMode if it is not a video subscription, please check your parameters"),a.slideShowMode=!1)};var v=function(a){a=void 0===a?function(){}:a;if(d.room&&d.room.p2p)q.a.warning("muteAudio/muteVideo are not implemented in p2p streams"),a("error");else{if(d.stream)for(var b=0;b<d.stream.getVideoTracks().length;b+=
1)d.stream.getVideoTracks()[b].enabled=!d.videoMuted;b={muteStream:{audio:d.audioMuted,video:d.videoMuted}};d.checkOptions(b,!0);d.pc&&d.pc.updateSpec(b,d.getID(),a)}};d.muteAudio=function(a,b){d.audioMuted=a;v(void 0===b?function(){}:b)};d.muteVideo=function(a,b){d.videoMuted=a;v(void 0===b?function(){}:b)};d._setStaticQualityLayer=function(a,b,c){c=void 0===c?function(){}:c;d.room&&d.room.p2p?(q.a.warning("setStaticQualityLayer is not implemented in p2p streams"),c("error")):(a={qualityLayer:{spatialLayer:a,
temporalLayer:b}},d.checkOptions(a,!0),d.pc.updateSpec(a,d.getID(),c))};d._setDynamicQualityLayer=function(a){if(d.room&&d.room.p2p)q.a.warning("setDynamicQualityLayer is not implemented in p2p streams"),a("error");else{var b={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};d.checkOptions(b,!0);d.pc.updateSpec(b,d.getID(),a)}};d._enableSlideShowBelowSpatialLayer=function(a,b,c){b=void 0===b?0:b;c=void 0===c?function(){}:c;d.room&&d.room.p2p?(q.a.warning("enableSlideShowBelowSpatialLayer is not implemented in p2p streams"),
c("error")):(a={slideShowBelowLayer:{enabled:a,spatialLayer:b}},d.checkOptions(a,!0),q.a.debug("Calling updateSpec with config",a),d.pc.updateSpec(a,d.getID(),c))};d._setMinSpatialLayer=d._enableSlideShowBelowSpatialLayer.bind(g,!0);var k=function(a,b,c){!0!==b&&(b=!1);a="string"===typeof a?[a]:a;a=a instanceof Array?a:[];0<a.length&&d.room.sendControlMessage(d,"control",{name:"controlhandlers",enable:c,publisherSide:b,handlers:a})};d.disableHandlers=function(a,b){k(a,b,!1)};d.enableHandlers=function(a,
b){k(a,b,!0)};d.updateSimulcastLayersBitrate=function(a){d.pc&&d.local&&d.pc.updateSimulcastLayersBitrate(a)};d.updateConfiguration=function(a,b){b=void 0===b?function(){}:b;if(void 0!==a)if(d.pc)if(d.checkOptions(a,!0),d.local)if(d.room.p2p)for(var c=0;c<d.pc.length;c+=1)d.pc[c].updateSpec(a,d.getID(),b);else d.pc.updateSpec(a,d.getID(),b);else d.pc.updateSpec(a,d.getID(),b);else b("This stream has no peerConnection attached, ignoring")};return d}},function(n,r,k){var g=k(5),f=k(46);r.a=function(e){var a=
Object(g.a)({}),b;a.elementID=e.elementID;a.id=e.id;a.div=document.createElement("div");a.div.setAttribute("id","bar_"+a.id);a.div.setAttribute("class","licode_bar");a.bar=document.createElement("div");a.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)");a.bar.setAttribute("id","subbar_"+a.id);a.bar.setAttribute("class","licode_subbar");a.link=document.createElement("a");a.link.setAttribute("href",
"http://www.lynckia.com/");a.link.setAttribute("class","licode_link");a.link.setAttribute("target","_blank");a.logo=document.createElement("img");a.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;");a.logo.setAttribute("class","licode_logo");a.logo.setAttribute("alt","Lynckia");a.logo.setAttribute("src",a.url+"/assets/star.svg");var m=function(c){var e=c;"block"!==c?e="none":clearTimeout(b);a.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: "+
e)};a.display=function(){m("block")};a.hide=function(){b=setTimeout(m,1E3)};document.getElementById(a.elementID).appendChild(a.div);a.div.appendChild(a.bar);a.bar.appendChild(a.link);a.link.appendChild(a.logo);e.stream.screen||void 0!==e.options&&void 0!==e.options.speaker&&!0!==e.options.speaker||(a.speaker=Object(f.a)({elementID:"subbar_"+a.id,id:a.id,stream:e.stream,media:e.media}));a.display();a.hide();return a}},function(n,r,k){Object.defineProperty(r,"__esModule",{value:!0});n=k(25);var g=k(1),
f=k(22),e=k(0);k(49);k(52);k={Room:n.a.bind(null,void 0,void 0,void 0),LicodeEvent:g.d,RoomEvent:g.e,StreamEvent:g.f,Stream:f.a.bind(null,void 0),Logger:e.a};r["default"]=k},function(n,r,k){var g=k(26),f=k(8),e=k(1),a=k(42),b=k(22),m=k(7),c=k(48),q=k(0);r.a=function(l,h,d,x){var t=Object(e.b)(x);t.remoteStreams=Object(m.a)();t.localStreams=Object(m.a)();t.roomID="";t.state=0;t.p2p=!1;t.minConnectionQualityLevel="";t.ConnectionHelpers=void 0===h?f.a:h;t.erizoConnectionManager=void 0===d?new g.a:new d.ErizoConnectionManager;
var p=Object(a.a)(l);t.socket=p;var u=t.remoteStreams,v=t.localStreams,k=function(a){a.removeAllListeners();a.pc&&!t.p2p&&a.pc.removeStream(a);q.a.debug("Removed stream");a.stream&&(a.hide(),a.stop(),a.close(),delete a.stream);a.pc&&(a.local&&t.p2p?a.pc.forEach(function(b,d){b.close();a.pc.remove(d)}):(t.erizoConnectionManager.maybeCloseConnection(a.pc),delete a.pc))},w=function(a,b){q.a.info("Stream subscribed");a.stream=b.stream;t.p2p||a.pc.addStream(a);a.state="subscribed";a=Object(e.f)({type:"stream-subscribed",
stream:a});t.dispatchEvent(a)},A=function(a){q.a.debug("maybeDispatchStreamUnsubscribed - unsubscribe id "+a.getID(),a.unsubscribing);a&&a.unsubscribing.callbackReceived&&(a.unsubscribing.pcEventReceived||a.failed)?(q.a.info("Dispatching Stream unsubscribed "+a.getID()),a.unsubscribing.callbackReceived=!1,a.unsubscribing.pcEventReceived=!1,k(a),delete a.failed,a.state="unsubscribed",a=Object(e.f)({type:"stream-unsubscribed",stream:a}),t.dispatchEvent(a)):q.a.debug("Not dispatching stream unsubscribed yet "+
a.getID())},z=function(a,b,d){0!==t.state&&a&&!a.failed&&(a.failed=!0,b=Object(e.f)({type:"stream-failed",msg:b||"Stream failed after connection",stream:a,origin:void 0===d?"unknown":d}),t.dispatchEvent(b),b=a.pc,a.local?t.unpublish(a):a.unsubscribing.callbackReceived?A(a):t.unsubscribe(a),b&&x.singlePC&&t.erizoConnectionManager.maybeCloseConnection(b,!0))},n=function(a,b){return{callback:function(d,c){p.sendSDP("streamMessageP2P",{streamId:a.getID(),streamIds:c,peerSocket:b,msg:d})},audio:a.hasAudio(),
video:a.hasVideo(),iceServers:t.iceServers,maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:x.maxAudioBW,limitMaxVideoBW:x.maxVideoBW,forceTurn:a.forceTurn,p2p:!0}},C=function(a,b){a.addPC(t.erizoConnectionManager.getOrBuildErizoConnection(n(a,b)));a.on("added",w.bind(null,a));a.on("icestatechanged",function(b){q.a.info(a.getID()+" - iceConnectionState: "+b.msg.state);"failed"===b.msg.state&&z(a,"ICE Connection Failed","ice-client")})},y=function(a,b){var d=t.erizoConnectionManager.getOrBuildErizoConnection(n(a,
b));a.addPC(d,b);a.on("icestatechanged",function(d){q.a.info(a.getID()+" - iceConnectionState: "+d.msg.state);"failed"===d.msg.state&&(a.pc.get(b).close(),a.pc.remove(b))});d.addStream(a)},H=function(a){t.remoteStreams.forEach(function(b){b.local||b.getLabel()!==a||(b.unsubscribing.pcEventReceived=!0,A(b))})},r=function(a,b,d,c,h){var l={callback:function(c,h){h=void 0===h?a.getID():h;q.a.info("Sending message",c,a.getID(),h);c&&c.type&&"updatestream"===c.type?p.sendSDP("streamMessage",{streamId:h,
erizoId:d,msg:c,browser:a.pc&&a.pc.browser},void 0,function(){}):p.sendSDP("connectionMessage",{connectionId:b,erizoId:d,msg:c,browser:a.pc&&a.pc.browser},void 0,function(){})},connectionId:b,nop2p:!0,audio:c.audio&&a.hasAudio(),video:c.video&&a.hasVideo(),maxAudioBW:c.maxAudioBW,maxVideoBW:c.maxVideoBW,limitMaxAudioBW:x.maxAudioBW,limitMaxVideoBW:x.maxVideoBW,label:a.getLabel(),iceServers:t.iceServers,forceTurn:a.forceTurn,p2p:!1,streamRemovedListener:H};h||(l.simulcast=c.simulcast,l.startVideoBW=
c.startVideoBW,l.hardMinVideoBW=c.hardMinVideoBW);return l},D=function(a,b,d,c){var h=r(a,b,d,c,!0);a.addPC(t.erizoConnectionManager.getOrBuildErizoConnection(h,d,x.singlePC));a.on("added",w.bind(null,a));a.on("icestatechanged",function(b){q.a.info(a.getID()+" - iceConnectionState: "+b.msg.state);"failed"===b.msg.state&&(z(a,"ICE Connection Failed","ice-client"),x.singlePC&&h.callback({type:"failed"}))})},F=function(a,b,d,c){var h=r(a,b,d,c);a.addPC(t.erizoConnectionManager.getOrBuildErizoConnection(h,
d,x.singlePC));a.on("icestatechanged",function(b){q.a.info(a.getID()+" - iceConnectionState: "+b.msg.state);"failed"===b.msg.state&&(z(a,"ICE Connection Failed","ice-client"),x.singlePC&&h.callback({type:"failed"}))});a.pc.addStream(a)},I=function(a){var b=a.streamIds,d=a.erizoId,c=a.connectionId,h=a.options,p;switch(a.type){case "multiple-initializing":b.forEach(function(a){p=u.get(a);D(p,c,d,h)})}},N=function(a){a=a.streamIds;var b;a.forEach(function(a){b=u.get(a)});a.forEach(function(a){b=u.get(a);
k(b);delete b.failed})},Q=function(a){var b=a.evt.level,d=Number.MAX_SAFE_INTEGER,c="";v.forEach(function(h){!h.failed&&h.pc&&(h.pc.connectionId===a.connectionId&&h.pc.setQualityLevel(b),h=h.pc.getQualityLevel(),h.index<d&&(d=h.index,c=h.message))});u.forEach(function(h){h.failed&&h.pc&&(h.pc.connectionId===a.connectionId&&h.pc.setQualityLevel(b),h=h.pc.getQualityLevel(),h.index<d&&(d=h.index,c=h.message))});c!==t.minConnectionQualityLevel&&(t.minConnectionQualityLevel=c,t.dispatchEvent(Object(e.e)({type:"quality-level",
message:c})))},O=function(a){var b=a.stream;a=a.msg;b.local?p.sendMessage("sendDataStream",{id:b.getID(),msg:a}):q.a.error("You can not send data through a remote stream")},P=function(a){var b=a.stream;a=a.attrs;b.local?(b.updateLocalAttributes(a),p.sendMessage("updateStreamAttributes",{id:b.getID(),attrs:a})):q.a.error("You can not update attributes in a remote stream")};l=function(a,b){b.args?a.apply(null,[].concat($jscomp.arrayFromIterable(b.args))):a()};var K=function(a,b,d){return{state:a,data:b.hasData(),
audio:b.hasAudio(),video:b.hasVideo(),label:b.getLabel(),screen:b.hasScreen(),attributes:b.getAttributes(),metadata:d.metadata,createOffer:d.createOffer,muteStream:d.muteStream}},M=function(a,b,d,c){c=void 0===c?function(){}:c;null===a?(q.a.error("Error when publishing the stream",d),c(void 0,d)):(q.a.info("Stream published"),b.getID=function(){return a},b.on("internal-send-data",O),b.on("internal-set-attributes",P),v.add(a,b),b.room=t,c(a))},R=function(a,b,d){d=void 0===d?function(){}:d;if(a.url){var c=
"url";var h=a.url}else c="recording",h=a.recording;q.a.info("Checking publish options for",a.getID());a.checkOptions(b);p.sendSDP("publish",K(c,a,b),h,function(b,c){M(b,a,c,d)})},S=function(a,b,d){d=void 0===d?function(){}:d;a.maxAudioBW=b.maxAudioBW;a.maxVideoBW=b.maxVideoBW;p.sendSDP("publish",K("p2p",a,b),void 0,function(b,c){M(b,a,c,d)})},T=function(a,b,d){d=void 0===d?function(){}:d;p.sendSDP("publish",K("data",a,b),void 0,function(b,c){M(b,a,c,d)})},U=function(a,b,d){d=void 0===d?function(){}:
d;q.a.info("Publishing to Erizo Normally, is createOffer",b.createOffer);var c=K("erizo",a,b);c.minVideoBW=b.minVideoBW;c.maxVideoBW=b.maxVideoBW;c.scheme=b.scheme;p.sendSDP("publish",c,void 0,function(c,h,p,l){null===c?(q.a.error("Error publishing stream",l),d(void 0,l)):(M(c,a,l,void 0),F(a,p,h,b),d(c))})},V=function(a,b){a=b&&a.hasVideo();var d=b&&b.width,c=b&&b.height;b=b&&b.frameRate;return d||c||b?{width:d,height:c,frameRate:b}:a},W=function(a,b,d){d=void 0===d?function(){}:d;b.maxVideoBW=b.maxVideoBW||
x.defaultVideoBW;b.maxVideoBW>x.maxVideoBW&&(b.maxVideoBW=x.maxVideoBW);b.audio=void 0===b.audio?!0:b.audio;b.video=void 0===b.video?!0:b.video;b.data=void 0===b.data?!0:b.data;a.checkOptions(b);var c={streamId:a.getID(),audio:b.audio&&a.hasAudio(),video:V(a,b.video),maxVideoBW:b.maxVideoBW,data:b.data&&a.hasData(),browser:t.ConnectionHelpers.getBrowser(),createOffer:b.createOffer,metadata:b.metadata,muteStream:b.muteStream,slideShowMode:b.slideShowMode};p.sendSDP("subscribe",c,void 0,function(c,
h,p,l){null===c?(q.a.error("Error subscribing to stream, streamId: "+a.getID()+", error:",l),a.state="unsubscribed",d(void 0,l)):(q.a.info("Subscriber added",h,p),D(a,p,h,b),a.pc.sendOffer(),d(!0))})},B=function(a,b,d){d=void 0===d?function(){}:d;p.sendSDP("subscribe",{streamId:a.getID(),data:b.data,metadata:b.metadata},void 0,function(b,c){null===b?(q.a.error("Error subscribing to stream, streamId: "+a.getID()+", error:",c),a.state="unsubscribed",d(void 0,c)):(q.a.info("Stream subscribed"),b=Object(e.f)({type:"stream-subscribed",
stream:a}),t.dispatchEvent(b),d(!0))})};t.connect=function(a){a=void 0===a?{}:a;var d=c.a.decodeBase64(x.token);0!==t.state&&q.a.warning("Room already connected, roomId: "+t.roomID);t.state=1;p.connect(JSON.parse(d),a,function(a){var d=[],c=a.streams||[],h=a.id;t.p2p=a.p2p;t.iceServers=a.iceServers;t.state=2;x.singlePC=a.singlePC;x.defaultVideoBW=a.defaultVideoBW;x.maxVideoBW=a.maxVideoBW;for(var p=Object.keys(c),l=0;l<p.length;l+=1){var m=c[p[l]];a=Object(b.a)(t.ConnectionHelpers,{streamID:m.id,
local:!1,audio:m.audio,video:m.video,data:m.data,label:m.label,screen:m.screen,attributes:m.attributes});a.room=t;a.state="unsubscribed";d.push(a);u.add(m.id,a)}t.roomID=h;q.a.info("Connected to room, roomId "+t.roomID);d=Object(e.e)({type:"room-connected",streams:d});t.dispatchEvent(d)},function(a){q.a.error("Error connecting to room, roomId: "+t.roomID+", Error:",a);a=Object(e.e)({type:"room-error",message:a});t.dispatchEvent(a)})};t.disconnect=function(){q.a.debug("Disconnection requested");var a=
Object(e.e)({type:"room-disconnected",message:"expected-disconnection"});t.dispatchEvent(a)};t.publish=function(a,b,d){b=void 0===b?{}:b;d=void 0===d?function(){}:d;b.maxVideoBW=b.maxVideoBW||x.defaultVideoBW;b.maxVideoBW>x.maxVideoBW&&(b.maxVideoBW=x.maxVideoBW);void 0===b.minVideoBW&&(b.minVideoBW=0);b.minVideoBW>x.defaultVideoBW&&(b.minVideoBW=x.defaultVideoBW);a.forceTurn=b.forceTurn;b.simulcast=b.simulcast||!1;b.muteStream={audio:a.audioMuted,video:a.videoMuted};a&&a.local&&!a.failed&&!v.has(a.getID())?
a.hasMedia()?a.isExternal()?R(a,b,d):t.p2p?S(a,b,d):U(a,b,d):a.hasData()&&T(a,b,d):(q.a.error("Trying to publish invalid stream, stream:",a),d(void 0,"Invalid Stream"))};t.startRecording=function(a,b){b=void 0===b?function(){}:b;void 0===a?(q.a.error("Trying to start recording on an invalid stream, stream:",a),b(void 0,"Invalid Stream")):(q.a.debug("Start Recording stream, streamId: "+a.getID()),p.sendMessage("startRecorder",{to:a.getID()},function(d,c){null===d?(q.a.error("Error on start recording, streamId: "+
a.getID()+", error:",c),b(void 0,c)):(q.a.info("Start recording",d),b(d))}))};t.stopRecording=function(a,b){b=void 0===b?function(){}:b;p.sendMessage("stopRecorder",{id:a},function(d,c){null===d?(q.a.error("Error on stop recording, recordingId: "+a+", error:",c),b(void 0,c)):(q.a.info("Stop recording",a),b(!0))})};t.unpublish=function(a,b){b=void 0===b?function(){}:b;if(a&&a.local){p.sendMessage("unpublish",a.getID(),function(d,c){null===d?(q.a.error("Error unpublishing stream, streamId: "+a.getID()+
", error:",c),b(void 0,c)):(delete a.failed,b(!0))});q.a.info("Stream unpublished, streamId: "+a.getID());a.room=void 0;if(a.hasMedia()&&!a.isExternal()){var d=v.has(a.getID())?v.get(a.getID()):a;k(d)}v.remove(a.getID());a.getID=function(){};a.off("internal-send-data",O);a.off("internal-set-attributes",P)}else q.a.error("Cannot unpublish, stream does not exist or is not local"),b(void 0,"Cannot unpublish, stream does not exist or is not local")};t.sendControlMessage=function(a,b,d){a&&a.getID()&&
(b={type:"control",action:d},p.sendSDP("streamMessage",{streamId:a.getID(),msg:b}))};t.subscribe=function(a,b,d){b=void 0===b?{}:b;d=void 0===d?function(){}:d;if(!a||a.local||a.failed)b="Error on subscribe",a.state="unsubscribed",a?a.local?(q.a.warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),b="Local copy of stream"):a.failed&&(q.a.warning("Cannot subscribe to failed stream, streamId: "+a.getID()+", unsubscribing:",a.unsubscribing," failed: ",
a.failed),b="Failed stream"):(q.a.warning("Cannot subscribe to invalid stream, streamId: "+a.getID()),b="Invalid or undefined stream"),d(void 0,b);else if("unsubscribed"!==a.state)q.a.warning("Cannot subscribe to a subscribed stream, streamId: "+a.getID()),d(void 0,"Stream already subscribed");else{a.state="subscribing";if(a.hasMedia())if(a.hasVideo()||a.hasScreen()||(b.video=!1),a.hasAudio()||(b.audio=!1),b.muteStream={audio:a.audioMuted,video:a.videoMuted},a.forceTurn=b.forceTurn,t.p2p){var c=u.get(a.getID());
c.maxAudioBW=b.maxAudioBW;c.maxVideoBW=b.maxVideoBW;p.sendSDP("subscribe",{streamId:a.getID(),metadata:b.metadata});d(!0)}else W(a,b,d);else if(a.hasData()&&!1!==b.data)B(a,b,d);else{q.a.warning("There is nothing to subscribe to in stream, streamId: "+a.getID());a.state="unsubscribed";d(void 0,"Nothing to subscribe to");return}q.a.info("Subscribing to: "+a.getID())}};t.unsubscribe=function(a,b){b=void 0===b?function(){}:b;void 0!==p&&(a&&!a.local?"subscribed"!==a.state?(q.a.warning("Cannot unsubscribe to a stream that is not subscribed, streamId: "+
a.getID()),b(void 0,"Stream not subscribed")):(a.state="unsubscribing",p.sendMessage("unsubscribe",a.getID(),function(d,c){null===d?(a.state="subscribed",b(void 0,c)):(b(!0),a.unsubscribing.callbackReceived=!0,A(a))},function(){a.state="subscribed";q.a.error("Error calling unsubscribe, streamId: "+a.getID())})):(a.state="unsubscribed",b(void 0,"Error unsubscribing, stream does not exist or is not local")))};t.autoSubscribe=function(a,b,d,c){p&&p.sendMessage("autoSubscribe",{selectors:a,negativeSelectors:b,
options:d},function(a){a&&c(a)})};t.getStreamStats=function(a,b){b=void 0===b?function(){}:b;if(!p)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";p.sendMessage("getStreamStats",a.getID(),function(a){a&&b(a)})};t.getStreamsByAttribute=function(a,b){var d=[];u.forEach(function(c){void 0!==c.getAttributes()&&c.getAttributes()[a]===b&&d.push(c)});return d};t.on("room-disconnected",function(){t.state=0;p.state=p.DISCONNECTED;u.forEach(function(a,b){k(a);u.remove(b);
a&&!a.failed&&(a=Object(e.f)({type:"stream-removed",stream:a}),t.dispatchEvent(a))});u=Object(m.a)();v.forEach(function(a,b){k(a);v.remove(b)});v=Object(m.a)();try{p.disconnect()}catch(X){q.a.debug("Socket already disconnected")}p=void 0});p.on("onAddStream",l.bind(null,function(a){if(!u.has(a.id)){var d=Object(b.a)(t.Connection,{streamID:a.id,local:v.has(a.id),audio:a.audio,video:a.video,data:a.data,label:a.label,screen:a.screen,attributes:a.attributes});d.room=t;d.state="unsubscribed";u.add(a.id,
d);a=Object(e.f)({type:"stream-added",stream:d});t.dispatchEvent(a)}}));p.on("stream_message_erizo",l.bind(null,function(a){"auto-streams-subscription"===a.context?I(a.mess):"auto-streams-unsubscription"===a.context?N(a.mess):q.a.debug("Failed applying a stream message from erizo",a)}));p.on("stream_message_p2p",l.bind(null,function(a){var b=v.get(a.streamId);b&&!b.failed?b.pc.get(a.peerSocket).processSignalingMessage(a.msg):(b=u.get(a.streamId),b.pc||C(b,a.peerSocket),b.pc.processSignalingMessage(a.msg))}));
p.on("connection_message_erizo",l.bind(null,function(a){var b=!1;"quality_level"===a.evt.type?Q(a):(v.forEach(function(d){b||d.failed||!d.pc||d.pc.connectionId!==a.connectionId||(d.pc.processSignalingMessage(a.evt),b=!0)}),b||(u.forEach(function(d){b||d.failed||!d.pc||d.pc.connectionId!==a.connectionId||(d.pc.processSignalingMessage(a.evt),b=!0)}),b||q.a.warning("Received signaling message to unknown connectionId",a.connectionId)))}));p.on("publish_me",l.bind(null,function(a){var b=v.get(a.streamId);
y(b,a.peerSocket)}));p.on("unpublish_me",l.bind(null,function(a){var b=v.get(a.streamId);b&&(a=a.peerSocket,void 0!==b.pc&&b.pc.has(a)&&(b.pc.get(a).close(),b.pc.remove(a)))}));p.on("onBandwidthAlert",l.bind(null,function(a){q.a.info("Bandwidth Alert on",a.streamID,"message",a.message,"BW:",a.bandwidth);if(a.streamID){var b=u.get(a.streamID);b&&!b.failed&&(a=Object(e.f)({type:"bandwidth-alert",stream:b,msg:a.message,bandwidth:a.bandwidth}),b.dispatchEvent(a))}}));p.on("onDataStream",l.bind(null,function(a){var b=
u.get(a.id);a=Object(e.f)({type:"stream-data",msg:a.msg,stream:b});b.dispatchEvent(a)}));p.on("onUpdateAttributeStream",l.bind(null,function(a){var b=u.get(a.id),d=Object(e.f)({type:"stream-attributes-update",attrs:a.attrs,stream:b});b.updateLocalAttributes(a.attrs);b.dispatchEvent(d)}));p.on("onRemoveStream",l.bind(null,function(a){var b=v.get(a.id);if(b)z(b,"Stream removed from server","server");else if(b=u.get(a.id))k(b),u.remove(a.id),a=Object(e.f)({type:"stream-removed",stream:b}),t.dispatchEvent(a)}));
p.on("disconnect",l.bind(null,function(){q.a.info("Socket disconnected, lost connection to ErizoController");if(0!==t.state){q.a.error("Unexpected disconnection from ErizoController");var a=Object(e.e)({type:"room-disconnected",message:"unexpected-disconnection"});t.dispatchEvent(a)}}));p.on("connection_failed",l.bind(null,function(a){if(a.streamId){var b="ICE Connection Failed on "+a.type+" "+a.streamId+" "+t.state;q.a.error(b);a="publish"===a.type?v.get(a.streamId):u.get(a.streamId);z(a,b,"ice-server")}}));
p.on("error",l.bind(null,function(a){q.a.error("Cannot connect to erizo Controller");a=Object(e.e)({type:"room-error",message:a});t.dispatchEvent(a)}));return t}},function(n,r,k){var g=k(27),f=k(39),e=k(40),a=k(0),b=k(1),m=k(7),c=k(8),q=b.c,l=103,h=["high-packet-losses","low-packet-losses","good"],d=function(d,h){var p=q.call(this)||this;a.a.debug("Building a new Connection");p.stack={};p.erizoId=h;p.streamsMap=Object(m.a)();l+=1;d.sessionId=l;p.sessionId=l;p.connectionId=d.connectionId;p.qualityLevel=
"good";d.streamRemovedListener||(d.streamRemovedListener=function(){});p.streamRemovedListener=d.streamRemovedListener;p.browser=c.a.getBrowser();if("fake"===p.browser)a.a.warning("Publish/subscribe video/audio streams not supported in erizofc yet"),p.stack=Object(e.a)(d);else if("mozilla"===p.browser)a.a.debug("Firefox Stack"),p.stack=Object(f.a)(d);else if("safari"===p.browser)a.a.debug("Safari using Chrome Stable Stack"),p.stack=Object(g.a)(d);else if("chrome-stable"===p.browser||"electron"===
p.browser)a.a.debug("Chrome Stable Stack"),p.stack=Object(g.a)(d);else throw a.a.error("No stack available for this browser"),Error("WebRTC stack not available");p.stack.updateSpec||(p.stack.updateSpec=function(b,d){d=void 0===d?function(){}:d;a.a.error("Update Configuration not implemented in this browser");d("unimplemented")});p.stack.setSignallingCallback||(p.stack.setSignallingCallback=function(){a.a.error("setSignallingCallback is not implemented in this stack")});p.stack.peerConnection&&(p.peerConnection=
p.stack.peerConnection,p.stack.peerConnection.onaddstream=function(a){p.emit(Object(b.a)({type:"add-stream",stream:a.stream}))},p.stack.peerConnection.onremovestream=function(a){p.emit(Object(b.a)({type:"remove-stream",stream:a.stream}));p.streamRemovedListener(a.stream.id)},p.stack.peerConnection.oniceconnectionstatechange=function(){p.emit(Object(b.a)({type:"ice-state-change",state:p.stack.peerConnection.iceConnectionState}))});return p};$jscomp.inherits(d,q);d.prototype.close=function(){a.a.debug("Closing ErizoConnection");
this.streamsMap.clear();this.stack.close()};d.prototype.createOffer=function(a,b){this.stack.createOffer(a,b)};d.prototype.sendOffer=function(){this.stack.sendOffer()};d.prototype.addStream=function(b){a.a.debug("message: Adding stream to Connection, streamId: "+b.getID());this.streamsMap.add(b.getID(),b);b.local&&this.stack.addStream(b.stream)};d.prototype.removeStream=function(b){var d=b.getID();this.streamsMap.has(d)?(this.streamsMap.remove(d),b.local?this.stack.removeStream(b.stream):0===this.streamsMap.size()&&
this.streamRemovedListener(b.getLabel())):a.a.debug("message: Cannot remove stream not in map, streamId: "+d)};d.prototype.processSignalingMessage=function(a){this.stack.processSignalingMessage(a)};d.prototype.sendSignalingMessage=function(a){this.stack.sendSignalingMessage(a)};d.prototype.setSimulcast=function(a){this.stack.setSimulcast(a)};d.prototype.setVideo=function(a){this.stack.setVideo(a)};d.prototype.setAudio=function(a){this.stack.setAudio(a)};d.prototype.updateSpec=function(a,b,d){this.stack.updateSpec(a,
b,d)};d.prototype.updateSimulcastLayersBitrate=function(a){this.stack.updateSimulcastLayersBitrate(a)};d.prototype.setQualityLevel=function(a){this.qualityLevel=h[a]};d.prototype.getQualityLevel=function(){return{message:this.qualityLevel,index:h.indexOf(this.qualityLevel)}};n=function(){this.ErizoConnectionsMap=new Map};n.prototype.getOrBuildErizoConnection=function(b,c,h){h=void 0===h?!1:h;a.a.debug("message: getOrBuildErizoConnection, erizoId: "+c);if(void 0===c)return new d(b);if(h)this.ErizoConnectionsMap.has(c)?
h=this.ErizoConnectionsMap.get(c):(h={},this.ErizoConnectionsMap.set(c,h)),h["single-pc"]||(h["single-pc"]=new d(b,c)),h=h["single-pc"];else if(h=new d(b,c),this.ErizoConnectionsMap.has(c))this.ErizoConnectionsMap.get(c)[h.sessionId]=h;else{var p={};p[h.sessionId]=h;this.ErizoConnectionsMap.set(c,p)}b.simulcast&&h.setSimulcast(b.simulcast);b.video&&h.setVideo(b.video);b.audio&&h.setVideo(b.audio);return h};n.prototype.maybeCloseConnection=function(b,d){d=void 0===d?!1:d;a.a.debug("Trying to remove connection "+
b.sessionId+"\n       with erizoId "+b.erizoId);if(0===b.streamsMap.size()||d)a.a.debug("No streams in connection "+b.sessionId+", erizoId: "+b.erizoId),void 0!==this.ErizoConnectionsMap.get(b.erizoId)&&this.ErizoConnectionsMap.get(b.erizoId)["single-pc"]&&!d?a.a.debug("Will not remove empty connection "+b.erizoId+" - it is singlePC"):(b.close(),void 0!==this.ErizoConnectionsMap.get(b.erizoId)&&(delete this.ErizoConnectionsMap.get(b.erizoId)["single-pc"],delete this.ErizoConnectionsMap.get(b.erizoId)[b.sessionId]))};
r.a=n},function(n,r,k){var g=k(9),f=k(21),e=k(0);r.a=function(a){e.a.info("Starting Chrome stable stack",a);var b=Object(g.a)(a);b.mediaConstraints={offerToReceiveVideo:!0,offerToReceiveAudio:!0};b.enableSimulcast=function(a){var c=a;if(!b.simulcast||null!==c.match(/a=ssrc-group:SIM/g))return c;a=c.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!a||0>=a.length)return c;var l=b.simulcast.numSpatialLayers||2;var h=parseInt(a[1],10),d=parseInt(a[2],10),e=c.match(new RegExp("a\x3dssrc:"+a[1]+" cname:(.*)\r?\n"))[1],
m=c.match(new RegExp("a\x3dssrc:"+a[1]+" msid:(.*)\r?\n"))[1],p=c.match(new RegExp("a\x3dssrc:"+a[1]+" mslabel:(.*)\r?\n"))[1],g=c.match(new RegExp("a\x3dssrc:"+a[1]+" label:(.*)\r?\n"))[1];c.match(new RegExp("a\x3dssrc:"+a[1]+".*\r?\n","g")).forEach(function(a){c=c.replace(a,"")});c.match(new RegExp("a\x3dssrc:"+a[2]+".*\r?\n","g")).forEach(function(a){c=c.replace(a,"")});for(var v=[h],k=[d],w=1;w<l;w+=1)v.push(h+1E3*w),k.push(d+1E3*w);l=f.a.addSim(v);for(w=0;w<v.length;w+=1)h=v[w],d=k[w],l+=f.a.addGroup(h,
d);for(w=0;w<v.length;w+=1)h=v[w],d=k[w],l+=f.a.addSpatialLayer(e,m,p,g,h,d);return c.replace(a[0],l+"a\x3dx-google-flag:conference\r\n")};var m=function(a){if("function"!==typeof a.getParameters||"function"!==typeof a.setParameters)e.a.warning("Cannot set simulcast layers bitrate: getParameters or setParameters is not available");else{var c=a.getParameters();Object.keys(b.simulcast.spatialLayerBitrates).forEach(function(a){void 0!==c.encodings[a]&&(e.a.debug("Setting bitrate for layer "+a+", bps: "+
b.simulcast.spatialLayerBitrates[a]),c.encodings[a].maxBitrate=b.simulcast.spatialLayerBitrates[a])});a.setParameters(c).then(function(a){e.a.debug("Success setting simulcast layer bitrates",a)}).catch(function(a){e.a.warning("Error setting simulcast layer bitrates",a)})}};b.setSimulcastLayersBitrate=function(){e.a.debug("Maybe set simulcast Layers bitrate",b.simulcast);b.simulcast&&b.simulcast.spatialLayerBitrates&&b.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&m(a)})};
b.setStartVideoBW=function(c){b.video&&a.startVideoBW&&(e.a.debug("startVideoBW requested: "+a.startVideoBW),f.a.setParamForCodecs(c,"video","x-google-start-bitrate",a.startVideoBW))};b.setHardMinVideoBW=function(c){b.video&&a.hardMinVideoBW&&(e.a.debug("hardMinVideoBW requested: "+a.hardMinVideoBW),f.a.setParamForCodecs(c,"video","x-google-min-bitrate",a.hardMinVideoBW))};return b}},function(n,r,k){r=k(29);var g=k(11),f=k(12),e=k(13),a=k(14),b=k(15),m=k(2),c=k(17),q=k(18),l=k(19),h=k(20);k=k(4);
n.exports={SDPInfo:r,CandidateInfo:g,CodecInfo:f,DTLSInfo:e,ICEInfo:a,MediaInfo:b,Setup:m,SourceGroupInfo:c,SourceInfo:q,StreamInfo:l,TrackInfo:h,Direction:k}},function(n,r,k){function g(a,b){var d=new Map;b.rtp.forEach(function(c){var h=c.payload,p=c.codec,l=c.rate;c=c.encoding;var e={},m=[];b.fmtp.forEach(function(a){a.payload===h&&a.config.split(";").forEach(function(a){a=a.split("\x3d");e[a[0].trim()]=(a[1]||"").trim()})});b.rtcpFb&&b.rtcpFb.forEach(function(a){a.payload===h&&m.push({type:a.type,
subtype:a.subtype})});"RTX"===p.toUpperCase()?d.set(parseInt(e.apt,10),h):a.addCodec(new q(p,h,l,c,e,m))});d.forEach(function(b,d){(d=a.getCodecForType(d))&&d.setRTX(b)})}function f(a,b){(b=b.rids)&&b.forEach(function(b){var d=new C(b.id,p.byValue(b.direction)),c=[],h=new Map;if(b.params){var l=m.parseParams(b.params);Object.keys(l).forEach(function(a){"pt"===a?c=l[a].split(","):h.set(a,l[a])});d.setFormats(c);d.setParams(h)}a.addRID(d)})}function e(a,b,d){var c=b.simulcast["dir"+a];a=b.simulcast["list"+
a];if(c){var h=p.byValue(c);m.parseSimulcastStreamList(a).forEach(function(a){var b=[];a.forEach(function(a){b.push(new G(a.scid,a.paused))});d.addSimulcastAlternativeStreams(h,b)})}}function a(a,b){var d=[];if(b.simulcast){var c=new z;e("1",b,c);e("2",b,c);c.getSimulcastStreams(p.SEND).forEach(function(b){var c=[];b.forEach(function(b){var d=new A(b.getId(),b.isPaused());if(b=a.getRID(d.getId()))b.getFormats().forEach(function(b){(b=a.getCodecForType(b))&&d.addCodec(b)}),d.setParams(b.getParams()),
c.push(d)});c.length&&d.push(c)});a.setSimulcast(c)}b.simulcast_03&&(c=new z,c.setSimulcastPlainString(b.simulcast_03.value),a.setSimulcast03(c));return d}function b(a,b,d){var c=new Map,h=d.type;if(d.ssrcs){var p,l,e;d.ssrcs.forEach(function(d){var m=d.id,f=d.attribute;d=d.value;e=c.get(m);e||(e=new v(m),c.set(e.getSSRC(),e));"cname"===f.toLowerCase()?e.setCName(d):"mslabel"===f.toLowerCase()?e.setMSLabel(d):"label"===f.toLowerCase()?e.setLabel(d):"msid"===f.toLowerCase()&&(f=d.split(" "),m=f[0],
f=f[1],e.setStreamId(m),e.setTrackId(f),l=b.getStream(m),l||(l=new J(m),b.addStream(l)),p=l.getTrack(f),p||(p=new w(h,f),p.setEncodings(a),l.addTrack(p)),p.addSSRC(e))})}if(d.msid){var m=d.msid.split(" "),f=m[0],g=m[1],m=b.getStream(f);m||(m=new J(f),b.addStream(m));var q=m.getTrack(g);q||(q=new w(h,g),q.setMediaId(d.mid),q.setEncodings(a),m.addTrack(q));c.forEach(function(a,b){a=c.get(b);a.getStreamId()||(a.setStreamId(f),a.setTrackId(g),q.addSSRC(a))})}d.ssrcGroups&&d.ssrcGroups.forEach(function(a){var d=
a.ssrcs.split(" ");a=new u(a.semantics,d);d=c.get(parseInt(d[0],10));b.getStream(d.getStreamId()).getTrack(d.getTrackId()).addSourceGroup(a)})}var m=k(30),c=k(11),q=k(12),l=k(13),h=k(14),d=k(15),x=k(2),t=k(4),p=k(3),u=k(17),v=k(18),J=k(19),w=k(20),A=k(33),z=k(16),G=k(34),C=k(35),y=function(a){this.version=a||1;this.name="sdp-semantic";this.streams=new Map;this.medias=[];this.candidates=[];this.dtls=this.ice=this.connection=null};y.prototype.clone=function(){var a=new y(this.version);a.name=this.name;
a.setConnection(this.connection);this.medias.forEach(function(b){a.addMedia(b.clone())});this.streams.forEach(function(b){a.addStream(b.clone())});this.candidates.forEach(function(b){a.addCandidate(b.clone())});a.setICE(this.ice.clone());a.setDTLS(this.dtls.clone());return a};y.prototype.plain=function(){var a={version:this.version,name:this.name,streams:[],medias:[],candidates:[],connection:this.connection};this.medias.forEach(function(b){a.medias.push(b.plain())});this.streams.forEach(function(b){a.streams.push(b.plain())});
this.candidates.forEach(function(b){a.candidates.push(b.plain())});a.ice=this.ice&&this.ice.plain();a.dtls=this.dtls&&this.dtls.plain();return a};y.prototype.setVersion=function(a){this.version=a};y.prototype.setOrigin=function(a){this.origin=a};y.prototype.setName=function(a){this.name=a};y.prototype.getConnection=function(){return this.connection};y.prototype.setConnection=function(a){this.connection=a};y.prototype.setTiming=function(a){this.timing=a};y.prototype.addMedia=function(a){this.medias.push(a)};
y.prototype.getMedia=function(a){var b;this.medias.forEach(function(d){d.getType().toLowerCase()===a.toLowerCase()&&(b=d)});return b};y.prototype.getMedias=function(a){if(!a)return this.medias;var b=[];this.medias.forEach(function(d){d.getType().toLowerCase()===a.toLowerCase()&&b.push(d)});return b};y.prototype.getMediaById=function(a){var b;this.medias.forEach(function(d){d.getId().toLowerCase()===a.toLowerCase()&&(b=d)});return b};y.prototype.getVersion=function(){return this.version};y.prototype.getDTLS=
function(){return this.dtls};y.prototype.setDTLS=function(a){this.dtls=a};y.prototype.getICE=function(){return this.ice};y.prototype.setICE=function(a){this.ice=a};y.prototype.addCandidate=function(a){this.candidates.push(a)};y.prototype.addCandidates=function(a){var b=this;a.forEach(function(a){b.addCandidate(a)})};y.prototype.getCandidates=function(){return this.candidates};y.prototype.getStream=function(a){return this.streams.get(a)};y.prototype.getStreams=function(){return this.streams};y.prototype.getFirstStream=
function(){return 0<this.streams.values().length?this.streams.values()[0]:null};y.prototype.addStream=function(a){this.streams.set(a.getId(),a)};y.prototype.removeStream=function(a){this.streams.delete(a.getId())};y.prototype.toJSON=function(){var a={version:0,media:[]};a.version=this.version||0;a.origin=this.origin||{username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,netType:"IN",ipVer:4,address:"127.0.0.1"};a.name=this.name||"semantic-sdp";a.connection=this.getConnection();
a.timing=this.timing||{start:0,stop:0};var b=this.getICE();b&&(b.isLite()&&(a.icelite="ice-lite"),a.iceOptions=b.getOpts(),a.iceUfrag=b.getUfrag(),a.icePwd=b.getPwd());a.msidSemantic=this.msidSemantic||{semantic:"WMS",token:"*"};a.groups=[];var d={type:"BUNDLE",mids:[]},c=this.getDTLS();c&&(a.fingerprint={type:c.getHash(),hash:c.getFingerprint()},a.setup=x.toString(c.getSetup()));this.medias.forEach(function(h){var l={type:h.getType(),port:h.getPort(),protocol:"UDP/TLS/RTP/SAVPF",fmtp:[],rtp:[],rtcpFb:[],
ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};l.direction=t.toString(h.getDirection());l.rtcpMux="rtcp-mux";l.connection=h.getConnection();l.xGoogleFlag=h.getXGoogleFlag();l.mid=h.getId();d.mids.push(h.getId());l.rtcp=h.rtcp;0<h.getBitrate()&&l.bandwidth.push({type:"AS",limit:h.getBitrate()});h.getCandidates().forEach(function(a){l.candidates.push({foundation:a.getFoundation(),component:a.getComponentId(),transport:a.getTransport(),priority:a.getPriority(),ip:a.getAddress(),port:a.getPort(),
type:a.getType(),relAddr:a.getRelAddr(),relPort:a.getRelPort(),generation:a.getGeneration()})});if(b=h.getICE())b.isLite()&&(l.icelite="ice-lite"),l.iceOptions=b.getOpts(),l.iceUfrag=b.getUfrag(),l.icePwd=b.getPwd(),b.isEndOfCandidates()&&(l.endOfCandidates=b.isEndOfCandidates());if(c=h.getDTLS())l.fingerprint={type:c.getHash(),hash:c.getFingerprint()},l.setup=x.toString(c.getSetup());h.setup&&(l.setup=x.toString(h.setup));h.getCodecs().forEach(function(a){l.rtp.push({payload:a.getType(),codec:a.getCodec(),
rate:a.getRate(),encoding:a.getEncoding()});var b=a.getParams();0<Object.keys(b).length&&l.fmtp.push({payload:a.getType(),config:Object.keys(b).map(function(a){return a+(b[a]?"\x3d"+b[a]:"")}).join(";")});a.getFeedback().forEach(function(b){l.rtcpFb.push({payload:a.getType(),type:b.type,subtype:b.subtype})});a.hasRTX()&&(l.rtp.push({payload:a.getRTX(),codec:"rtx",rate:a.getRate(),encoding:a.getEncoding()}),l.fmtp.push({payload:a.getRTX(),config:"apt\x3d"+a.getType()}))});var e=[];l.rtp.forEach(function(a){e.push(a.payload)});
l.payloads=e.join(" ");h.getExtensions().forEach(function(a,b){l.ext.push({value:b,uri:a})});h.getRIDs().forEach(function(a){var b={id:a.getId(),direction:p.toString(a.getDirection()),params:""};a.getFormats().length&&(b.params="pt\x3d"+a.getFormats().join(","));a.getParams().forEach(function(a,d){b.params+=""+(b.params.length?";":"")+d+"\x3d"+a});l.rids.push(b)});var m=h.getSimulcast();h=h.getSimulcast03();if(m){var f=1;l.simulcast={};var g=m.getSimulcastStreams(p.SEND),m=m.getSimulcastStreams(p.RECV);
if(g&&g.length){var u="";g.forEach(function(a){var b="";a.forEach(function(a){b+=(b.length?",":"")+(a.isPaused()?"~":"")+a.getId()});u+=(u.length?";":"")+b});l.simulcast["dir"+f]="send";l.simulcast["list"+f]=u;f+=1}if(m&&m.length){var q=[];m.forEach(function(a){var b="";a.forEach(function(a){b+=(b.length?",":"")+(a.isPaused()?"~":"")+a.getId()});q+=(q.length?";":"")+b});l.simulcast["dir"+f]="recv";l.simulcast["list"+f]=q;f+=1}}h&&(l.simulcast_03={value:h.getSimulcastPlainString()});a.media.push(l)});
d.mids.sort();a.media.sort(function(a,b){return a.mid<b.mid?-1:a.mid>b.mid?1:0});for(var h=$jscomp.makeIterator(this.streams.values()),l=h.next();!l.done;l=h.next())for(var l=l.value,e=$jscomp.makeIterator(l.getTracks().values()),m=e.next();!m.done;m=e.next())for(var m=m.value,f={},g=$jscomp.makeIterator(a.media),u=g.next();!u.done;f={md:f.md},u=g.next())if(f.md=u.value,m.getMediaId()){if(m.getMediaId()===f.md.mid){m.getSourceGroups().forEach(function(a){return function(b){a.md.ssrcGroups.push({semantics:b.getSemantics(),
ssrcs:b.getSSRCs().join(" ")})}}(f));m.getSSRCs().forEach(function(a){return function(b){a.md.ssrcs.push({id:b.ssrc,attribute:"cname",value:b.getCName()})}}(f));l.getId()&&m.getId()&&(f.md.msid=l.getId()+" "+m.getId());break}}else if(f.md.type.toLowerCase()===m.getMedia().toLowerCase()){m.getSourceGroups().forEach(function(a){return function(b){a.md.ssrcGroups.push({semantics:b.getSemantics(),ssrcs:b.getSSRCs().join(" ")})}}(f));m.getSSRCs().forEach(function(a){return function(b){a.md.ssrcs.push({id:b.ssrc,
attribute:"cname",value:b.getCName()});b.getStreamId()&&b.getTrackId()&&a.md.ssrcs.push({id:b.ssrc,attribute:"msid",value:b.getStreamId()+" "+b.getTrackId()});b.getMSLabel()&&a.md.ssrcs.push({id:b.ssrc,attribute:"mslabel",value:b.getMSLabel()});b.getLabel()&&a.md.ssrcs.push({id:b.ssrc,attribute:"label",value:b.getLabel()})}}(f));break}d.mids=d.mids.join(" ");a.groups.push(d);return a};y.prototype.toString=function(){var a=this.toJSON();return m.write(a)};y.processString=function(a){a=m.parse(a);return y.process(a)};
y.process=function(p){var e=new y;e.setVersion(p.version);e.setTiming(p.timing);e.setConnection(p.connection);e.setOrigin(p.origin);e.msidSemantic=p.msidSemantic;e.name=p.name;var m=p.iceUfrag,u=p.icePwd,q=p.iceOptions;(m||u||q)&&e.setICE(new h(m,u,q));var w=p.fingerprint;if(w){var v=w.type,k=w.hash,A=null;p.setup&&(A=x.byValue(p.setup));e.setDTLS(new l(A,v,k))}p.media.forEach(function(p){var v=new d(p.mid,p.port,p.type);v.setXGoogleFlag(p.xGoogleFlag);v.rtcp=p.rtcp;v.setConnection(p.connection);
p.bandwidth&&0<p.bandwidth.length&&p.bandwidth.forEach(function(a){"AS"===a.type&&v.setBitrate(a.limit)});m=p.iceUfrag;u=p.icePwd;q=p.iceOptions;if(m||u||q){var k=new h(m,u,q);p.endOfCandidates&&k.setEndOfCandidates("end-of-candidates");v.setICE(k)}if(w=p.fingerprint){var k=w.type,A=w.hash,z=x.ACTPASS;p.setup&&(z=x.byValue(p.setup));v.setDTLS(new l(z,k,A))}p.setup&&v.setSetup(x.byValue(p.setup));k=t.SENDRECV;p.direction&&(k=t.byValue(p.direction.toUpperCase()));v.setDirection(k);(k=p.candidates)&&
k.forEach(function(a){v.addCandidate(new c(a.foundation,a.component,a.transport,a.priority,a.ip,a.port,a.type,a.generation,a.relAddr,a.relPort))});g(v,p);(k=p.ext)&&k.forEach(function(a){v.addExtension(a.value,a.uri)});f(v,p);k=a(v,p);b(k,e,p);e.addMedia(v)});return e};n.exports=y},function(n,r,k){n=k(31);k=k(32);r.write=k;r.parse=n.parse;r.parseFmtpConfig=n.parseFmtpConfig;r.parseParams=n.parseParams;r.parsePayloads=n.parsePayloads;r.parseRemoteCandidates=n.parseRemoteCandidates;r.parseImageAttributes=
n.parseImageAttributes;r.parseSimulcastStreamList=n.parseSimulcastStreamList},function(n,r,k){var g=function(a){return String(Number(a))===a?Number(a):a},f=k(10),e=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(a){var b={},c=[],q=b;a.split(/(\r\n|\r|\n)/).filter(e).forEach(function(a){var b=a[0],d=a.slice(2);"m"===b&&(c.push({rtp:[],fmtp:[]}),q=c[c.length-1]);for(a=0;a<(f[b]||[]).length;a+=1){var l=f[b][a];if(l.reg.test(d)){b=l;a=q;l=d;d=b.name&&b.names;b.push&&!a[b.push]?a[b.push]=
[]:d&&!a[b.name]&&(a[b.name]={});var d=b.push?{}:d?a[b.name]:a,l=l.match(b.reg),e=d,p=b.names,m=b.name;if(m&&!p)e[m]=g(l[1]);else for(m=0;m<p.length;m+=1)null!=l[m+1]&&(e[p[m]]=g(l[m+1]));b.push&&a[b.push].push(d);break}}});b.media=c;return b};var a=function(a,e){e=e.split(/=(.+)/,2);2===e.length&&(a[e[0]]=g(e[1]));return a};r.parseParams=function(b){return b.split(/\;\s?/).reduce(a,{})};r.parseFmtpConfig=r.parseParams;r.parsePayloads=function(a){return a.split(" ").map(Number)};r.parseRemoteCandidates=
function(a){var b=[];a=a.split(" ").map(g);for(var c=0;c<a.length;c+=3)b.push({component:a[c],ip:a[c+1],port:a[c+2]});return b};r.parseImageAttributes=function(b){return b.split(" ").map(function(b){return b.substring(1,b.length-1).split(",").reduce(a,{})})};r.parseSimulcastStreamList=function(a){return a.split(";").map(function(a){return a.split(",").map(function(a){var b=!1;"~"!==a[0]?a=g(a):(a=g(a.substring(1,a.length)),b=!0);return{scid:a,paused:b}})})}},function(n,r,k){var g=k(10),f=/%[sdv%]/g,
e=function(a){var b=1,c=arguments,h=c.length;return a.replace(f,function(a){if(b>=h)return a;var d=c[b];b+=1;switch(a){case "%%":return"%";case "%s":return String(d);case "%d":return Number(d);case "%v":return""}})},a=function(a,b,l){var c=b.format instanceof Function?b.format(b.push?l:l[b.name]):b.format;a=[a+"\x3d"+c];if(b.names)for(c=0;c<b.names.length;c+=1){var d=b.names[c];b.name?a.push(l[b.name][d]):a.push(l[b.names[c]])}else a.push(l[b.name]);return e.apply(null,a)},b="vosiuepcbtrza".split(""),
m=["i","c","b","a"];n.exports=function(c,e){e=e||{};null==c.version&&(c.version=0);null==c.name&&(c.name=" ");c.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var l=e.innerOrder||m,h=[];(e.outerOrder||b).forEach(function(b){g[b].forEach(function(d){d.name in c&&null!=c[d.name]?h.push(a(b,d,c)):d.push in c&&null!=c[d.push]&&c[d.push].forEach(function(c){h.push(a(b,d,c))})})});c.media.forEach(function(b){h.push(a("m",g.m[0],b));l.forEach(function(d){g[d].forEach(function(c){c.name in
b&&null!=b[c.name]?h.push(a(d,c,b)):c.push in b&&null!=b[c.push]&&b[c.push].forEach(function(b){h.push(a(d,c,b))})})})});return h.join("\r\n")+"\r\n"}},function(n,r){var k=function(g,f){this.id=g;this.paused=f;this.codecs=new Map;this.params=new Map};k.prototype.clone=function(){var g=new k(this.id,this.paused);this.codecs.forEach(function(f){g.addCodec(f.cloned())});g.setParams(this.params);return g};k.prototype.plain=function(){var g=this,f={id:this.id,paused:this.paused,codecs:{},params:{}};this.codecs.keys().forEach(function(e){f.codecs[e]=
g.codecs.get(e).plain()});this.params.keys().forEach(function(e){f.params[e]=g.params.get(e).param});return f};k.prototype.getId=function(){return this.id};k.prototype.getCodecs=function(){return this.codecs};k.prototype.addCodec=function(g){this.codecs.set(g.getType(),g)};k.prototype.getParams=function(){return this.params};k.prototype.setParams=function(g){this.params=new Map(g)};k.prototype.isPaused=function(){return this.paused};n.exports=k},function(n,r){var k=function(g,f){this.paused=f;this.id=
g};k.prototype.clone=function(){return new k(this.id,this.paused)};k.prototype.plain=function(){return{id:this.id,paused:this.paused}};k.prototype.isPaused=function(){return this.paused};k.prototype.getId=function(){return this.id};n.exports=k},function(n,r,k){var g=k(3),f=function(e,a){this.id=e;this.direction=a;this.formats=[];this.params=new Map};f.prototype.clone=function(){var e=new f(this.id,this.direction);e.setFormats(this.formats);e.setParams(this.params);return e};f.prototype.plain=function(){var e=
{id:this.id,direction:g.toString(this.direction),formats:this.formats,params:{}};this.params.forEach(function(a,b){e.params[b]=a});return e};f.prototype.getId=function(){return this.id};f.prototype.getDirection=function(){return this.direction};f.prototype.setDirection=function(e){this.direction=e};f.prototype.getFormats=function(){return this.formats};f.prototype.setFormats=function(e){var a=this;this.formats=[];e.forEach(function(b){a.formats.push(parseInt(b,10))})};f.prototype.getParams=function(){return this.params};
f.prototype.setParams=function(e){this.params=new Map(e)};n.exports=f},function(n,r,k){n=k(37);n=k.n(n);var g=k(0);k=["initial","failed","stable"];k=n.a.factory({init:"initial",transitions:[{name:"create-offer",from:k,to:"stable"},{name:"add-ice-candidate",from:k,to:function(){return this.state}},{name:"process-answer",from:k,to:"stable"},{name:"process-offer",from:k,to:"stable"},{name:"negotiate-max-bw",from:k,to:"stable"},{name:"add-stream",from:k,to:function(){return this.state}},{name:"remove-stream",
from:k,to:function(){return this.state}},{name:"close",from:k,to:"closed"},{name:"error",from:"*",to:"failed"}],data:function(f){return{baseStackCalls:f,history:[]}},methods:{getHistory:function(){return this.history},onBeforeClose:function(f){g.a.info("FSM onBeforeClose from: "+f.from+", to: "+f.to);return this.baseStackCalls.protectedClose()},onBeforeAddIceCandidate:function(f,e){g.a.info("FSM onBeforeAddIceCandidate, from "+f.from+", to: "+f.to);return this.baseStackCalls.protectedAddIceCandidate(e)},
onBeforeAddStream:function(f,e){g.a.info("FSM onBeforeAddStream, from "+f.from+", to: "+f.to);return this.baseStackCalls.protectedAddStream(e)},onBeforeRemoveStream:function(f,e){g.a.info("FSM onBeforeRemoveStream, from "+f.from+", to: "+f.to);return this.baseStackCalls.protectedRemoveStream(e)},onBeforeCreateOffer:function(f,e){g.a.info("FSM onBeforeCreateOffer, from "+f.from+", to: "+f.to);return this.baseStackCalls.protectedCreateOffer(e)},onBeforeProcessOffer:function(f,e){g.a.info("FSM onBeforeProcessOffer, from "+
f.from+", to: "+f.to);return this.baseStackCalls.protectedProcessOffer(e)},onBeforeProcessAnswer:function(f,e){g.a.info("FSM onBeforeProcessAnswer from: "+f.from+", to: "+f.to);return this.baseStackCalls.protectedProcessAnswer(e)},onBeforeNegotiateMaxBW:function(f,e,a){g.a.info("FSM onBeforeNegotiateMaxBW from: "+f.from+", to: "+f.to);return this.baseStackCalls.protectedNegotiateMaxBW(e,a)},onStable:function(f){g.a.info("FSM reached STABLE, from "+f.from+", to: "+f.to)},onClosed:function(f){g.a.info("FSM reached close, from "+
f.from+", to: "+f.to)},onTransition:function(f){g.a.debug("FSM onTransition, transition: "+f.transition+", from "+f.from+", to: "+f.to);this.history.push({from:f.from,to:f.to,transition:f.transition});200<this.history.length&&this.history.shift()},onError:function(f,e){g.a.warning("FSM Error Transition Failed, message: "+e+", from: "+f.from+", to: "+f.to+", printing history:");this.history.forEach(function(a){g.a.warning(a)})},onInvalidTransition:function(f,e,a){"closed"===e?g.a.info("Trying to transition a closed FSM, transition: "+
f+", from: "+e+", to: "+a):g.a.warning("FSM Error Invalid transition: "+f+", from: "+e+", to: "+a)},onPendingTransition:function(f,e,a){g.a.warning("FSM Error Pending transition: "+f+", from: "+e+", to: "+a)}}});r.a=k},function(n,r,k){(function(g,f){n.exports=f()})(this,function(){return function(g){function f(a){if(e[a])return e[a].exports;var b=e[a]={i:a,l:!1,exports:{}};g[a].call(b.exports,b,b.exports,f);b.l=!0;return b.exports}var e={};f.m=g;f.c=e;f.i=function(a){return a};f.d=function(a,b,e){f.o(a,
b)||Object.defineProperty(a,b,{configurable:!1,enumerable:!0,get:e})};f.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};f.d(b,"a",b);return b};f.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};f.p="";return f(f.s=5)}([function(g,f,e){g.exports=function(a,b){var e,c;for(e=1;e<arguments.length;e++){var f=arguments[e];for(c in f)f.hasOwnProperty(c)&&(a[c]=f[c])}return a}},function(g,f,e){var a=e(0);g.exports={build:function(b,e){var c,m=e.plugins;
e=0;for(c=m.length;e<c;e++){var l=m[e];l.methods&&a(b,l.methods);l.properties&&Object.defineProperties(b,l.properties)}},hook:function(a,e,c){var b,l,h=a.config.plugins;a=[a.context];c&&(a=a.concat(c));c=0;for(b=h.length;c<b;c++){var d=h[c];(l=h[c][e])&&l.apply(d,a)}}}},function(g,f,e){function a(a){if(0===a.length)return a;var b=a.split(/[_-]/);if(1===b.length&&b[0][0].toLowerCase()===b[0][0])return a;var c=b[0].toLowerCase();for(a=1;a<b.length;a++)c=c+b[a].charAt(0).toUpperCase()+b[a].substring(1).toLowerCase();
return c}a.prepended=function(b,e){e=a(e);return b+e[0].toUpperCase()+e.substring(1)};g.exports=a},function(g,f,e){function a(a,b){this.options=a=a||{};this.defaults=b.defaults;this.states=[];this.transitions=[];this.map={};this.lifecycle=this.configureLifecycle();this.init=this.configureInitTransition(a.init);this.data=this.configureData(a.data);this.methods=this.configureMethods(a.methods);this.map[this.defaults.wildcard]={};this.configureTransitions(a.transitions||[]);this.plugins=this.configurePlugins(a.plugins,
b.plugin)}var b=e(0),m=e(2);b(a.prototype,{addState:function(a){this.map[a]||(this.states.push(a),this.addStateLifecycleNames(a),this.map[a]={})},addStateLifecycleNames:function(a){this.lifecycle.onEnter[a]=m.prepended("onEnter",a);this.lifecycle.onLeave[a]=m.prepended("onLeave",a);this.lifecycle.on[a]=m.prepended("on",a)},addTransition:function(a){0>this.transitions.indexOf(a)&&(this.transitions.push(a),this.addTransitionLifecycleNames(a))},addTransitionLifecycleNames:function(a){this.lifecycle.onBefore[a]=
m.prepended("onBefore",a);this.lifecycle.onAfter[a]=m.prepended("onAfter",a);this.lifecycle.on[a]=m.prepended("on",a)},mapTransition:function(a){var b=a.name,c=a.from,h=a.to;this.addState(c);"function"!==typeof h&&this.addState(h);this.addTransition(b);return this.map[c][b]=a},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(a){if("string"===
typeof a)return this.mapTransition(b({},this.defaults.init,{to:a,active:!0}));if("object"===typeof a)return this.mapTransition(b({},this.defaults.init,a,{active:!0}));this.addState(this.defaults.init.from);return this.defaults.init},configureData:function(a){return"function"===typeof a?a:"object"===typeof a?function(){return a}:function(){return{}}},configureMethods:function(a){return a||{}},configurePlugins:function(a,b){a=a||[];var c;b=0;for(c=a.length;b<c;b++){var h=a[b];"function"===typeof h&&
(a[b]=h=h());h.configure&&h.configure(this)}return a},configureTransitions:function(a){var b,c,h=this.defaults.wildcard;for(c=0;c<a.length;c++){var d=a[c];var e=Array.isArray(d.from)?d.from:[d.from||h];var m=d.to||h;for(b=0;b<e.length;b++)this.mapTransition({name:d.name,from:e[b],to:m})}},transitionFor:function(a,b){var c=this.defaults.wildcard;return this.map[a][b]||this.map[c][b]},transitionsFor:function(a){var b=this.defaults.wildcard;return Object.keys(this.map[a]).concat(Object.keys(this.map[b]))},
allStates:function(){return this.states},allTransitions:function(){return this.transitions}});g.exports=a},function(g,f,e){function a(a,b){this.context=a;this.config=b;this.state=b.init.from;this.observers=[a]}var b=e(0),m=e(6),c=e(1),q=[null,[]];b(a.prototype,{init:function(a){b(this.context,this.config.data.apply(this.context,a));c.hook(this,"init");if(this.config.init.active)return this.fire(this.config.init.name,[])},is:function(a){return Array.isArray(a)?0<=a.indexOf(this.state):this.state===
a},isPending:function(){return this.pending},can:function(a){return!this.isPending()&&!!this.seek(a)},cannot:function(a){return!this.can(a)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(a,b){var d=this.config.defaults.wildcard;a=(a=this.config.transitionFor(this.state,a))&&a.to;return"function"===typeof a?a.apply(this.context,b):a===d?this.state:
a},fire:function(a,b){return this.transit(a,this.state,this.seek(a,b),b)},transit:function(a,b,d,c){var h=this.config.lifecycle,p=this.config.options.observeUnchangedState||b!==d;if(!d)return this.context.onInvalidTransition(a,b,d);if(this.isPending())return this.context.onPendingTransition(a,b,d);this.config.addState(d);this.beginTransit();c.unshift({transition:a,from:b,to:d,fsm:this.context});return this.observeEvents([this.observersForEvent(h.onBefore.transition),this.observersForEvent(h.onBefore[a]),
p?this.observersForEvent(h.onLeave.state):q,p?this.observersForEvent(h.onLeave[b]):q,this.observersForEvent(h.on.transition),p?["doTransit",[this]]:q,p?this.observersForEvent(h.onEnter.state):q,p?this.observersForEvent(h.onEnter[d]):q,p?this.observersForEvent(h.on[d]):q,this.observersForEvent(h.onAfter.transition),this.observersForEvent(h.onAfter[a]),this.observersForEvent(h.on[a])],c)},beginTransit:function(){this.pending=!0},endTransit:function(a){this.pending=!1;return a},failTransit:function(a){this.pending=
!1;throw a;},doTransit:function(a){this.state=a.to},observe:function(a){if(2===a.length){var b={};b[a[0]]=a[1];this.observers.push(b)}else this.observers.push(a[0])},observersForEvent:function(a){for(var b=0,d=this.observers.length,c,e=[];b<d;b++)c=this.observers[b],c[a]&&e.push(c);return[a,e,!0]},observeEvents:function(a,b,d,e){if(0===a.length)return this.endTransit(void 0===e?!0:e);var h=a[0][0],p=a[0][1],l=a[0][2];(b[0].event=h)&&l&&h!==d&&c.hook(this,"lifecycle",b);if(0===p.length)return a.shift(),
this.observeEvents(a,b,h,e);d=p.shift();return(d=d[h].apply(d,b))&&"function"===typeof d.then?d.then(this.observeEvents.bind(this,a,b,h)).catch(this.failTransit.bind(this)):!1===d?this.endTransit(!1):this.observeEvents(a,b,h,d)},onInvalidTransition:function(a,b,d){throw new m("transition is invalid in current state",a,b,d,this.state);},onPendingTransition:function(a,b,d){throw new m("transition is invalid while previous transition is still in progress",a,b,d,this.state);}});g.exports=a},function(g,
f,e){function a(a){return b(this||{},a)}function b(b,d){d=new h(d,a);m(b,d);b._fsm();return b}function m(a,b){if("object"!==typeof a||Array.isArray(a))throw Error("StateMachine can only be applied to objects");l.build(a,b);Object.defineProperties(a,t);c(a,k);c(a,b.methods);b.allTransitions().forEach(function(b){a[q(b)]=function(){return this._fsm.fire(b,[].slice.call(arguments))}});a._fsm=function(){this._fsm=new d(this,b);this._fsm.init(arguments)}}var c=e(0),q=e(2),l=e(1),h=e(3),d=e(4),k={is:function(a){return this._fsm.is(a)},
can:function(a){return this._fsm.can(a)},cannot:function(a){return this._fsm.cannot(a)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(a,b,d){return this._fsm.onInvalidTransition(a,b,d)},onPendingTransition:function(a,b,d){return this._fsm.onPendingTransition(a,b,d)}},t={state:{configurable:!1,enumerable:!0,
get:function(){return this._fsm.state},set:function(a){throw Error("use transitions to change state");}}};a.version="3.0.1";a.factory=function(b,d){if("function"===typeof b){var c=b;b=d||{}}else c=function(){this._fsm.apply(this,arguments)},b=b||{};b=new h(b,a);m(c.prototype,b);c.prototype._fsm.config=b;return c};a.apply=b;a.defaults={wildcard:"*",init:{name:"init",from:"none"}};g.exports=a},function(g,f,e){g.exports=function(a,b,e,c,f){this.message=a;this.transition=b;this.from=e;this.to=c;this.current=
f}}])})},function(n,r,k){n=function(){this._enqueuing=!1;this._queuedArgs=[]};n.prototype.protectFunction=function(g){return this._protectedFunction.bind(this,g)};n.prototype.isEnqueueing=function(){return this._enqueuing};n.prototype.startEnqueuing=function(){this._enqueuing=!0};n.prototype.stopEnqueuing=function(){this._enqueuing=!1};n.prototype.nextInQueue=function(){if(0<this._queuedArgs.length){var g=this._queuedArgs.shift();g.protectedFunction.apply(null,[].concat($jscomp.arrayFromIterable(g.args)))}};
n.prototype.dequeueAll=function(){var g=this._queuedArgs;this._queuedArgs=[];g.forEach(function(f){f.protectedFunction.apply(null,[].concat($jscomp.arrayFromIterable(f.args)))})};n.prototype._protectedFunction=function(g,f){for(var e=[],a=1;a<arguments.length;++a)e[a-1]=arguments[a];this.isEnqueueing()?this._enqueue.apply(this,[].concat([g],$jscomp.arrayFromIterable(e))):g.apply(null,[].concat($jscomp.arrayFromIterable(e)))};n.prototype._enqueue=function(g,f){for(var e=[],a=1;a<arguments.length;++a)e[a-
1]=arguments[a];this._queuedArgs.push({protectedFunction:g,args:e})};r.a=n},function(n,r,k){var g=k(0),f=k(9);r.a=function(e){g.a.info("Starting Firefox stack");var a=Object(f.a)(e),b=[{rid:"low",scaleResolutionDownBy:3},{rid:"med",scaleResolutionDownBy:2},{rid:"high"}],m=function(c){var h=a.simulcast.numSpatialLayers||2,d=b.length,h=h<d?h:d,e=c.getParameters()||{};e.encodings=[];for(var l=d-1;l>=d-h;--l)e.encodings.push(b[l]);return c.setParameters(e)},c=function(){if(!a.simulcast)return[];var b=
[];a.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&b.push(m(a))});return b};a.enableSimulcast=function(a){return a};var q=a.createOffer;a.createOffer=function(a,b,d){b=void 0===b?!1:b;d=void 0===d?"":d;var h=[];!0!==a&&(h=c());Promise.all(h).then(function(){q(a,b,d)})};return a}},function(n,r,k){var g=k(0);r.a=function(f){var e={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){g.a.info("Close FcStack")},createOffer:function(){g.a.debug("FCSTACK: CreateOffer")},
addStream:function(a){g.a.debug("FCSTACK: addStream",a)},processSignalingMessage:function(a){g.a.debug("FCSTACK: processSignaling",a);void 0!==e.signalCallback&&e.signalCallback(a)},sendSignalingMessage:function(a){g.a.debug("FCSTACK: Sending signaling Message",a);f.callback(a)},setSignalingCallback:function(a){a=void 0===a?function(){}:a;g.a.debug("FCSTACK: Setting signalling callback");e.signalCallback=a}};return e}},function(n,r){n.exports=function(k){if(!k.webpackPolyfill){var g=Object.create(k);
g.children||(g.children=[]);Object.defineProperty(g,"loaded",{enumerable:!0,get:function(){return g.l}});Object.defineProperty(g,"id",{enumerable:!0,get:function(){return g.i}});Object.defineProperty(g,"exports",{enumerable:!0});g.webpackPolyfill=1}return g}},function(n,r,k){k.d(r,"a",function(){return b});n=k(43);var g=k.n(n),f=k(0),e=k(1),a=function(a,b){a=Object(e.d)({type:a});a.args=b.args;return a},b=function(b){var c=Object(e.b)(),m=function(){},l=[];$jscomp.initSymbol();c.CONNECTED=Symbol("connected");
$jscomp.initSymbol();c.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();c.DISCONNECTED=Symbol("disconnected");c.state=c.DISCONNECTED;c.IO=void 0===b?g.a:b;var h,d=function(b,d){for(var h=[],p=1;p<arguments.length;++p)h[p-1]=arguments[p];c.emit(a(b,{args:h}))},k=function(){c.state===c.CONNECTED&&l.forEach(function(a){c.sendMessage.apply(c,[].concat($jscomp.arrayFromIterable(a)))})};c.connect=function(a,b,e,l){e=void 0===e?m:e;l=void 0===l?m:l;h=c.IO.connect((a.secure?"wss://":"ws://")+a.host,
{reconnection:!0,reconnectionAttempts:3,secure:a.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1});var p=1E3,g=h.io.engine.transport.ws.onclose;h.io.engine.transport.ws.onclose=function(a){f.a.warning("WebSocket closed, code:",a.code);p=a.code;g(a)};c.socket=h;h.on("onAddStream",d.bind(c,"onAddStream"));h.on("stream_message_erizo",d.bind(c,"stream_message_erizo"));h.on("stream_message_p2p",d.bind(c,"stream_message_p2p"));h.on("connection_message_erizo",d.bind(c,"connection_message_erizo"));
h.on("publish_me",d.bind(c,"publish_me"));h.on("unpublish_me",d.bind(c,"unpublish_me"));h.on("onBandwidthAlert",d.bind(c,"onBandwidthAlert"));h.on("onDataStream",d.bind(c,"onDataStream"));h.on("onUpdateAttributeStream",d.bind(c,"onUpdateAttributeStream"));h.on("onRemoveStream",d.bind(c,"onRemoveStream"));h.on("onAutomaticStreamsSubscription",d.bind(c,"onAutomaticStreamsSubscription"));h.on("disconnect",function(a){f.a.debug("disconnect",c.id,a);1E3!==p?c.state=c.RECONNECTING:(d("disconnect",a),h.close())});
h.on("connection_failed",function(a){f.a.error("connection failed, id:",c.id);d("connection_failed",a)});h.on("error",function(a){f.a.warning("socket error, id:",c.id,", error:",a.message);d("error")});h.on("connect_error",function(a){f.a.warning("connect error, id:",c.id,", error:",a.message)});h.on("connect_timeout",function(a){f.a.warning("connect timeout, id:",c.id,", error:",a.message)});h.on("reconnecting",function(a){f.a.debug("reconnecting, id:",c.id,", attempet:",a)});h.on("reconnect",function(a){f.a.debug("reconnected, id:",
c.id,", attempet:",a);c.state=c.CONNECTED;h.emit("reconnected",c.id);k()});h.on("reconnect_attempt",function(a){f.a.debug("reconnect attempt, id:",c.id,", attempet:",a)});h.on("reconnect_error",function(a){f.a.debug("error reconnecting, id:",c.id,", error:",a.message)});h.on("reconnect_failed",function(){f.a.warning("reconnect failed, id:",c.id);c.state=c.DISCONNECTED;d("disconnect","reconnect failed")});b.token=a;c.sendMessage("token",b,function(a){c.state=c.CONNECTED;c.id=a.clientId;e(a)},l)};c.disconnect=
function(){c.state=c.DISCONNECTED;h.disconnect()};c.sendMessage=function(a,b,d,e){d=void 0===d?m:d;e=void 0===e?m:e;c.state===c.DISCONNECTED&&"token"!==a?f.a.error("Trying to send a message over a disconnected Socket"):c.state===c.RECONNECTING?l.push([a,b,d,e]):h.emit(a,b,function(a,b){"success"===a?d(b):"error"===a?e(b):d(a,b)})};c.sendSDP=function(a,b,d,e){e=void 0===e?m:e;c.state===c.DISCONNECTED?f.a.error("Trying to send a message over a disconnected Socket"):h.emit(a,b,d,function(a){for(var b=
[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];e.apply(null,[].concat($jscomp.arrayFromIterable(b)))})};return c}},function(n,r,k){!function(g,f){n.exports=f()}(this,function(){return function(g){function f(a){if(e[a])return e[a].exports;var b=e[a]={exports:{},id:a,loaded:!1};return g[a].call(b.exports,b,b.exports,f),b.loaded=!0,b.exports}var e={};return f.m=g,f.c=e,f.p="",f(0)}([function(g,f,e){function a(a,c){"object"===("undefined"==typeof a?"undefined":b(a))&&(c=a,a=void 0);c=c||{};var d;a=
m(a);var e=a.source,f=a.id,g=a.path,g=h[f]&&g in h[f].nsps;return c.forceNew||c["force new connection"]||!1===c.multiplex||g?(l("ignoring socket cache for %s",e),d=q(e,c)):(h[f]||(l("new io instance for %s",e),h[f]=q(e,c)),d=h[f]),a.query&&!c.query&&(c.query=a.query),d.socket(a.path,c)}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m=e(1),c=e(7),q=e(13),l=e(3)("socket.io-client");g.exports=f=a;var h=f.managers={};f.protocol=c.protocol;f.connect=a;f.Manager=e(13);f.Socket=e(39)},function(g,f,e){(function(a){var b=e(2),f=e(3)("socket.io-client:url");g.exports=function(c,e){var l=c;e=e||a.location;null==c&&(c=e.protocol+"//"+e.host);"string"==typeof c&&("/"===c.charAt(0)&&(c="/"===c.charAt(1)?e.protocol+c:e.host+
c),/^(https?|wss?):\/\//.test(c)||(f("protocol-less url %s",c),c="undefined"!=typeof e?e.protocol+"//"+c:"https://"+c),f("parse %s",c),l=b(c));l.port||(/^(http|ws)$/.test(l.protocol)?l.port="80":/^(http|ws)s$/.test(l.protocol)&&(l.port="443"));l.path=l.path||"/";c=-1!==l.host.indexOf(":")?"["+l.host+"]":l.host;return l.id=l.protocol+"://"+c+":"+l.port,l.href=l.protocol+"://"+c+(e&&e.port===l.port?"":":"+l.port),l}}).call(f,function(){return this}())},function(g,f){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
a="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");g.exports=function(b){var f=b,c=b.indexOf("["),g=b.indexOf("]");-1!=c&&-1!=g&&(b=b.substring(0,c)+b.substring(c,g).replace(/:/g,";")+b.substring(g,b.length));b=e.exec(b||"");for(var l={},h=14;h--;)l[a[h]]=b[h]||"";return-1!=c&&-1!=g&&(l.source=f,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=
!0),l}},function(g,f,e){(function(a){function b(){try{var b=f.storage.debug}catch(l){}return!b&&"undefined"!=typeof a&&"env"in a&&(b=a.env.DEBUG),b}f=g.exports=e(5);f.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};f.formatArgs=function(a){var b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+f.humanize(this.diff),b){b="color: "+this.color;a.splice(1,0,b,"color: inherit");var c=0,d=0;a[0].replace(/%[a-zA-Z%]/g,
function(a){"%%"!==a&&(c++,"%c"===a&&(d=c))});a.splice(d,0,b)}};f.save=function(a){try{null==a?f.storage.removeItem("debug"):f.storage.debug=a}catch(l){}};f.load=b;f.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&
window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var m=f;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var c=chrome.storage.local;else a:{try{c=window.localStorage;break a}catch(q){}c=void 0}m.storage=c;f.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");
f.formatters.j=function(a){try{return JSON.stringify(a)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}};f.enable(b())}).call(f,e(4))},function(g,f){function e(){throw Error("setTimeout has not been defined");}function a(){throw Error("clearTimeout has not been defined");}function b(a){if(d===setTimeout)return setTimeout(a,0);if((d===e||!d)&&setTimeout)return d=setTimeout,setTimeout(a,0);try{return d(a,0)}catch(w){try{return d.call(null,a,0)}catch(A){return d.call(this,a,0)}}}function m(b){if(k===
clearTimeout)return clearTimeout(b);if((k===a||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(b);try{return k(b)}catch(w){try{return k.call(null,b)}catch(A){return k.call(this,b)}}}function c(){u&&t&&(u=!1,t.length?p=t.concat(p):v=-1,p.length&&q())}function q(){if(!u){var a=b(c);u=!0;for(var d=p.length;d;){t=p;for(p=[];++v<d;)t&&t[v].run();v=-1;d=p.length}t=null;u=!1;m(a)}}function l(a,b){this.fun=a;this.array=b}function h(){}g=g.exports={};try{var d="function"==typeof setTimeout?setTimeout:
e}catch(J){d=e}try{var k="function"==typeof clearTimeout?clearTimeout:a}catch(J){k=a}!0;var t,p=[],u=!1,v=-1;g.nextTick=function(a){var d=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)d[c-1]=arguments[c];p.push(new l(a,d));1!==p.length||u||b(q)};l.prototype.run=function(){this.fun.apply(null,this.array)};g.title="browser";g.browser=!0;g.env={};g.argv=[];g.version="";g.versions={};g.on=h;g.addListener=h;g.once=h;g.off=h;g.removeListener=h;g.removeAllListeners=h;
g.emit=h;g.prependListener=h;g.prependOnceListener=h;g.listeners=function(a){return[]};g.binding=function(a){throw Error("process.binding is not supported");};g.cwd=function(){return"/"};g.chdir=function(a){throw Error("process.chdir is not supported");};g.umask=function(){return 0}},function(g,f,e){function a(a){var b,c=0;for(b in a)c=(c<<5)-c+a.charCodeAt(b),c|=0;return f.colors[Math.abs(c)%f.colors.length]}function b(b){function c(){if(c.enabled){var a=+new Date;c.diff=a-(m||a);c.prev=m;m=c.curr=
a;for(var b=Array(arguments.length),a=0;a<b.length;a++)b[a]=arguments[a];b[0]=f.coerce(b[0]);"string"!=typeof b[0]&&b.unshift("%O");var d=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,function(a,h){if("%%"===a)return a;d++;h=f.formatters[h];"function"==typeof h&&(a=h.call(c,b[d]),b.splice(d,1),d--);return a});f.formatArgs.call(c,b);(c.log||f.log||console.log.bind(console)).apply(c,b)}}return c.namespace=b,c.enabled=f.enabled(b),c.useColors=f.useColors(),c.color=a(b),"function"==typeof f.init&&f.init(c),c}f=
g.exports=b.debug=b["default"]=b;f.coerce=function(a){return a instanceof Error?a.stack||a.message:a};f.disable=function(){f.enable("")};f.enable=function(a){f.save(a);f.names=[];f.skips=[];for(var b=("string"==typeof a?a:"").split(/[\s,]+/),c=b.length,h=0;h<c;h++)b[h]&&(a=b[h].replace(/\*/g,".*?"),"-"===a[0]?f.skips.push(new RegExp("^"+a.substr(1)+"$")):f.names.push(new RegExp("^"+a+"$")))};f.enabled=function(a){var b;var c=0;for(b=f.skips.length;c<b;c++)if(f.skips[c].test(a))return!1;c=0;for(b=
f.names.length;c<b;c++)if(f.names[c].test(a))return!0;return!1};f.humanize=e(6);f.names=[];f.skips=[];f.formatters={};var m},function(g,f){function e(a){if(a=String(a),!(100<a.length))if(a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a)){var d=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return d*l;case "days":case "day":case "d":return d*k;case "hours":case "hour":case "hrs":case "hr":case "h":return d*
c;case "minutes":case "minute":case "mins":case "min":case "m":return d*m;case "seconds":case "second":case "secs":case "sec":case "s":return d*b;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return d}}}function a(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var b=1E3,m=60*b,c=60*m,k=24*c,l=365.25*k;g.exports=function(h,d){d=d||{};var f=typeof h;if("string"===f&&0<h.length)return e(h);if("number"===f&&!1===isNaN(h))return d["long"]?a(h,
k,"day")||a(h,c,"hour")||a(h,m,"minute")||a(h,b,"second")||h+" ms":h>=k?Math.round(h/k)+"d":h>=c?Math.round(h/c)+"h":h>=m?Math.round(h/m)+"m":h>=b?Math.round(h/b)+"s":h+"ms";throw Error("val is not a non-empty string or a valid number. val\x3d"+JSON.stringify(h));}},function(g,f,e){function a(){}function b(a){var b=""+a.type;return f.BINARY_EVENT!==a.type&&f.BINARY_ACK!==a.type||(b+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(b+=a.nsp+","),null!=a.id&&(b+=a.id),null!=a.data&&(b+=JSON.stringify(a.data)),
h("encoded %j as %s",a,b),b}function m(a,d){x.removeBlobs(a,function(a){var c=x.deconstructPacket(a);a=b(c.packet);c=c.buffers;c.unshift(a);d(c)})}function c(){this.reconstructor=null}function k(a){this.reconPack=a;this.buffers=[]}function l(){return{type:f.ERROR,data:"parser error"}}var h=e(3)("socket.io-parser");g=e(8);var d=e(9),x=e(11),t=e(12);f.protocol=4;f.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");f.CONNECT=0;f.DISCONNECT=1;f.EVENT=2;f.ACK=3;f.ERROR=4;f.BINARY_EVENT=
5;f.BINARY_ACK=6;f.Encoder=a;f.Decoder=c;a.prototype.encode=function(a,c){(a.type!==f.EVENT&&a.type!==f.ACK||!d(a.data)||(a.type=a.type===f.EVENT?f.BINARY_EVENT:f.BINARY_ACK),h("encoding packet %j",a),f.BINARY_EVENT===a.type||f.BINARY_ACK===a.type)?m(a,c):(a=b(a),c([a]))};g(c.prototype);c.prototype.add=function(a){if("string"==typeof a){var b,d=0,c={type:Number(a.charAt(0))};if(null==f.types[c.type])a=l();else{if(f.BINARY_EVENT===c.type||f.BINARY_ACK===c.type){for(b="";"-"!==a.charAt(++d)&&(b+=a.charAt(d),
d!=a.length););if(b!=Number(b)||"-"!==a.charAt(d))throw Error("Illegal attachments");c.attachments=Number(b)}if("/"===a.charAt(d+1))for(c.nsp="";++d;){b=a.charAt(d);if(","===b)break;if(c.nsp+=b,d===a.length)break}else c.nsp="/";b=a.charAt(d+1);if(""!==b&&Number(b)==b){for(c.id="";++d;){b=a.charAt(d);if(null==b||Number(b)!=b){--d;break}if(c.id+=a.charAt(d),d===a.length)break}c.id=Number(c.id)}if(a.charAt(++d)){b:{d=a.substr(d);try{c.data=JSON.parse(d)}catch(w){d=l();break b}d=c}c=d}a=(h("decoded %s as %j",
a,c),c)}f.BINARY_EVENT===a.type||f.BINARY_ACK===a.type?(this.reconstructor=new k(a),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",a)):this.emit("decoded",a)}else{if(!t(a)&&!a.base64)throw Error("Unknown type: "+a);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(a=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,this.emit("decoded",a))}};c.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};
k.prototype.takeBinaryData=function(a){return(this.buffers.push(a),this.buffers.length===this.reconPack.attachments)?(a=x.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),a):null};k.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},function(g,f,e){function a(b){if(b){for(var e in a.prototype)b[e]=a.prototype[e];return b}}g.exports=a;a.prototype.on=a.prototype.addEventListener=function(a,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+
a]=this._callbacks["$"+a]||[]).push(e),this};a.prototype.once=function(a,e){function b(){this.off(a,b);e.apply(this,arguments)}return b.fn=e,this.on(a,b),this};a.prototype.off=a.prototype.removeListener=a.prototype.removeAllListeners=a.prototype.removeEventListener=function(a,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var b=this._callbacks["$"+a];if(!b)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var f,m=0;m<b.length;m++)if(f=
b[m],f===e||f.fn===e){b.splice(m,1);break}return this};a.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks["$"+a];if(c)for(var c=c.slice(0),e=0,f=c.length;e<f;++e)c[e].apply(this,b);return this};a.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]};a.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(g,f,e){(function(a){function b(c){if(!c||"object"!=typeof c)return!1;
if(f(c)){for(var d=0,e=c.length;d<e;d++)if(b(c[d]))return!0;return!1}if("function"==typeof a.Buffer&&a.Buffer.isBuffer&&a.Buffer.isBuffer(c)||"function"==typeof a.ArrayBuffer&&c instanceof ArrayBuffer||k&&c instanceof Blob||l&&c instanceof File)return!0;if(c.toJSON&&"function"==typeof c.toJSON&&1===arguments.length)return b(c.toJSON(),!0);for(d in c)if(Object.prototype.hasOwnProperty.call(c,d)&&b(c[d]))return!0;return!1}var f=e(10),c=Object.prototype.toString,k="function"==typeof a.Blob||"[object BlobConstructor]"===
c.call(a.Blob),l="function"==typeof a.File||"[object FileConstructor]"===c.call(a.File);g.exports=b}).call(f,function(){return this}())},function(g,f){var e={}.toString;g.exports=Array.isArray||function(a){return"[object Array]"==e.call(a)}},function(g,f,e){(function(a){function b(a,d){if(!a)return a;if(g(a)){var e={_placeholder:!0,num:d.length};return d.push(a),e}if(c(a)){e=Array(a.length);for(var h=0;h<a.length;h++)e[h]=b(a[h],d);return e}if("object"==typeof a&&!(a instanceof Date)){e={};for(h in a)e[h]=
b(a[h],d);return e}return a}function m(a,b){if(!a)return a;if(a&&a._placeholder)return b[a.num];if(c(a))for(var d=0;d<a.length;d++)a[d]=m(a[d],b);else if("object"==typeof a)for(d in a)a[d]=m(a[d],b);return a}var c=e(10),g=e(12),l=Object.prototype.toString,h="function"==typeof a.Blob||"[object BlobConstructor]"===l.call(a.Blob),d="function"==typeof a.File||"[object FileConstructor]"===l.call(a.File);f.deconstructPacket=function(a){var d=[];return a.data=b(a.data,d),a.attachments=d.length,{packet:a,
buffers:d}};f.reconstructPacket=function(a,b){return a.data=m(a.data,b),a.attachments=void 0,a};f.removeBlobs=function(a,b){function e(a,p,l){if(!a)return a;if(h&&a instanceof Blob||d&&a instanceof File){f++;var u=new FileReader;u.onload=function(){l?l[p]=this.result:m=this.result;--f||b(m)};u.readAsArrayBuffer(a)}else if(c(a))for(u=0;u<a.length;u++)e(a[u],u,a);else if("object"==typeof a&&!g(a))for(u in a)e(a[u],u,a)}var f=0,m=a;e(m);f||b(m)}}).call(f,function(){return this}())},function(g,f){(function(e){g.exports=
function(a){return e.Buffer&&e.Buffer.isBuffer(a)||e.ArrayBuffer&&a instanceof ArrayBuffer}}).call(f,function(){return this}())},function(g,f,e){function a(d,c){if(!(this instanceof a))return new a(d,c);d&&"object"===("undefined"==typeof d?"undefined":b(d))&&(c=d,d=void 0);c=c||{};c.path=c.path||"/socket.io";this.nsps={};this.subs=[];this.opts=c;this.reconnection(!1!==c.reconnection);this.reconnectionAttempts(c.reconnectionAttempts||1/0);this.reconnectionDelay(c.reconnectionDelay||1E3);this.reconnectionDelayMax(c.reconnectionDelayMax||
5E3);this.randomizationFactor(c.randomizationFactor||.5);this.backoff=new t({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==c.timeout?2E4:c.timeout);this.readyState="closed";this.uri=d;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];d=c.parser||k;this.encoder=new d.Encoder;this.decoder=new d.Decoder;(this.autoConnect=!1!==c.autoConnect)&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m=e(14),c=e(39);f=e(8);var k=e(7),l=e(41),h=e(42),d=e(3)("socket.io-client:manager"),x=e(37),t=e(43),p=Object.prototype.hasOwnProperty;g.exports=a;a.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)p.call(this.nsps,
a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)};a.prototype.updateSocketIds=function(){for(var a in this.nsps)p.call(this.nsps,a)&&(this.nsps[a].id=this.generateId(a))};a.prototype.generateId=function(a){return("/"===a?"":a+"#")+this.engine.id};f(a.prototype);a.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection};a.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts};
a.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay};a.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor};a.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax};
a.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout};a.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};a.prototype.open=a.prototype.connect=function(a,b){if(d("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;d("opening %s",this.uri);var c=this.engine=m(this.uri,this.opts),e=this;this.readyState="opening";this.skipReconnect=!1;var h=l(c,"open",function(){e.onopen();
a&&a()});b=l(c,"error",function(b){if(d("connect_error"),e.cleanup(),e.readyState="closed",e.emitAll("connect_error",b),a){var c=Error("Connection error");c.data=b;a(c)}else e.maybeReconnectOnOpen()});if(!1!==this._timeout){var p=this._timeout;d("connect attempt will timeout after %d",p);var f=setTimeout(function(){d("connect attempt timed out after %d",p);h.destroy();c.close();c.emit("error","timeout");e.emitAll("connect_timeout",p)},p);this.subs.push({destroy:function(){clearTimeout(f)}})}return this.subs.push(h),
this.subs.push(b),this};a.prototype.onopen=function(){d("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(l(a,"data",h(this,"ondata")));this.subs.push(l(a,"ping",h(this,"onping")));this.subs.push(l(a,"pong",h(this,"onpong")));this.subs.push(l(a,"error",h(this,"onerror")));this.subs.push(l(a,"close",h(this,"onclose")));this.subs.push(l(this.decoder,"decoded",h(this,"ondecoded")))};a.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};
a.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};a.prototype.ondata=function(a){this.decoder.add(a)};a.prototype.ondecoded=function(a){this.emit("packet",a)};a.prototype.onerror=function(a){d("error",a);this.emitAll("error",a)};a.prototype.socket=function(a,b){function d(){~x(h.connecting,e)||h.connecting.push(e)}var e=this.nsps[a];if(!e){e=new c(this,a,b);this.nsps[a]=e;var h=this;e.on("connecting",d);e.on("connect",function(){e.id=h.generateId(a)});this.autoConnect&&d()}return e};
a.prototype.destroy=function(a){a=x(this.connecting,a);~a&&this.connecting.splice(a,1);this.connecting.length||this.close()};a.prototype.packet=function(a){d("writing packet %j",a);var b=this;a.query&&0===a.type&&(a.nsp+="?"+a.query);b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(d){for(var c=0;c<d.length;c++)b.engine.write(d[c],a.options);b.encoding=!1;b.processPacketQueue()}))};a.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=
this.packetBuffer.shift();this.packet(a)}};a.prototype.cleanup=function(){d("cleanup");for(var a=this.subs.length,b=0;b<a;b++)this.subs.shift().destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;this.decoder.destroy()};a.prototype.close=a.prototype.disconnect=function(){d("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"===this.readyState&&this.cleanup();this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};a.prototype.onclose=function(a){d("onclose");
this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};a.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();d("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||
(d("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(d("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(d("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}};a.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",
a)}},function(g,f,e){g.exports=e(15)},function(g,f,e){g.exports=e(16);g.exports.parser=e(23)},function(g,f,e){(function(a){function b(c,e){if(!(this instanceof b))return new b(c,e);e=e||{};c&&"object"==typeof c&&(e=c,c=null);c?(c=d(c),e.hostname=c.host,e.secure="https"===c.protocol||"wss"===c.protocol,e.port=c.port,c.query&&(e.query=c.query)):e.host&&(e.hostname=d(e.host).host);this.secure=null!=e.secure?e.secure:a.location&&"https:"===location.protocol;e.hostname&&!e.port&&(e.port=this.secure?"443":
"80");this.agent=e.agent||!1;this.hostname=e.hostname||(a.location?location.hostname:"localhost");this.port=e.port||(a.location&&location.port?location.port:this.secure?443:80);this.query=e.query||{};"string"==typeof this.query&&(this.query=t.decode(this.query));this.upgrade=!1!==e.upgrade;this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!e.forceJSONP;this.jsonp=!1!==e.jsonp;this.forceBase64=!!e.forceBase64;this.enablesXDR=!!e.enablesXDR;this.timestampParam=e.timestampParam||
"t";this.timestampRequests=e.timestampRequests;this.transports=e.transports||["polling","websocket"];this.transportOptions=e.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=e.policyPort||843;this.rememberUpgrade=e.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=e.onlyBinaryUpgrades;this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{});!0===this.perMessageDeflate&&(this.perMessageDeflate={});this.perMessageDeflate&&
null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024);this.pfx=e.pfx||null;this.key=e.key||null;this.passphrase=e.passphrase||null;this.cert=e.cert||null;this.ca=e.ca||null;this.ciphers=e.ciphers||null;this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized;this.forceNode=!!e.forceNode;c="object"==typeof a&&a;c.global===c&&(e.extraHeaders&&0<Object.keys(e.extraHeaders).length&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress));
this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=this.pingInterval=this.upgrades=this.id=null;this.open()}var f=e(17),c=e(8),k=e(3)("engine.io-client:socket"),l=e(37),h=e(23),d=e(2),x=e(38),t=e(31);g.exports=b;b.priorWebsocketSuccess=!1;c(b.prototype);b.protocol=h.protocol;b.Socket=b;b.Transport=e(22);b.transports=e(17);b.parser=e(23);b.prototype.createTransport=function(a){k('creating transport "%s"',a);var b=this.query,d={},c;for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);d.EIO=h.protocol;
d.transport=a;b=this.transportOptions[a]||{};this.id&&(d.sid=this.id);return new f[a]({query:d,socket:this,agent:b.agent||this.agent,hostname:b.hostname||this.hostname,port:b.port||this.port,secure:b.secure||this.secure,path:b.path||this.path,forceJSONP:b.forceJSONP||this.forceJSONP,jsonp:b.jsonp||this.jsonp,forceBase64:b.forceBase64||this.forceBase64,enablesXDR:b.enablesXDR||this.enablesXDR,timestampRequests:b.timestampRequests||this.timestampRequests,timestampParam:b.timestampParam||this.timestampParam,
policyPort:b.policyPort||this.policyPort,pfx:b.pfx||this.pfx,key:b.key||this.key,passphrase:b.passphrase||this.passphrase,cert:b.cert||this.cert,ca:b.ca||this.ca,ciphers:b.ciphers||this.ciphers,rejectUnauthorized:b.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:b.perMessageDeflate||this.perMessageDeflate,extraHeaders:b.extraHeaders||this.extraHeaders,forceNode:b.forceNode||this.forceNode,localAddress:b.localAddress||this.localAddress,requestTimeout:b.requestTimeout||this.requestTimeout,
protocols:b.protocols||void 0})};b.prototype.open=function(){if(this.rememberUpgrade&&b.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var a="websocket";else{if(0===this.transports.length){var d=this;return void setTimeout(function(){d.emit("error","No transports available")},0)}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(v){return this.transports.shift(),void this.open()}a.open();this.setTransport(a)};b.prototype.setTransport=function(a){k("setting transport %s",
a.name);var b=this;this.transport&&(k("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})};b.prototype.probe=function(a){function d(){if(q.onlyBinaryUpgrades){var d=!this.supportsBinary&&q.transport.supportsBinary;l=l||d}l||(k('probe transport "%s" opened',a),g.send([{type:"ping",
data:"probe"}]),g.once("packet",function(d){if(!l)if("pong"===d.type&&"probe"===d.data){if(k('probe transport "%s" pong',a),q.upgrading=!0,q.emit("upgrading",g),g)b.priorWebsocketSuccess="websocket"===g.name,k('pausing current transport "%s"',q.transport.name),q.transport.pause(function(){l||"closed"!==q.readyState&&(k("changing transport and sending upgrade packet"),m(),q.setTransport(g),g.send([{type:"upgrade"}]),q.emit("upgrade",g),g=null,q.upgrading=!1,q.flush())})}else k('probe transport "%s" failed',
a),d=Error("probe error"),d.transport=g.name,q.emit("upgradeError",d)}))}function c(){l||(l=!0,m(),g.close(),g=null)}function e(b){var d=Error("probe error: "+b);d.transport=g.name;c();k('probe transport "%s" failed because of error: %s',a,b);q.emit("upgradeError",d)}function h(){e("transport closed")}function f(){e("socket closed")}function p(a){g&&a.name!==g.name&&(k('"%s" works - aborting "%s"',a.name,g.name),c())}function m(){g.removeListener("open",d);g.removeListener("error",e);g.removeListener("close",
h);q.removeListener("close",f);q.removeListener("upgrading",p)}k('probing transport "%s"',a);var g=this.createTransport(a,{probe:1}),l=!1,q=this;b.priorWebsocketSuccess=!1;g.once("open",d);g.once("error",e);g.once("close",h);this.once("close",f);this.once("upgrading",p);g.open()};b.prototype.onOpen=function(){if(k("socket open"),this.readyState="open",b.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){k("starting upgrade probes");
for(var a=0,d=this.upgrades.length;a<d;a++)this.probe(this.upgrades[a])}};b.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(k('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(x(a.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var b=Error("server error");b.code=a.data;this.onError(b);break;case "message":this.emit("data",
a.data),this.emit("message",a.data)}else k('packet received with socket readyState "%s"',this.readyState)};b.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};b.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);
var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!==b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};b.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){k("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};b.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})};b.prototype.onDrain=function(){this.writeBuffer.splice(0,
this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};b.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(k("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};b.prototype.write=b.prototype.send=function(a,b,d){return this.sendPacket("message",a,b,d),this};b.prototype.sendPacket=
function(a,b,d,c){if("function"==typeof b&&(c=b,b=void 0),"function"==typeof d&&(c=d,d=null),"closing"!==this.readyState&&"closed"!==this.readyState)d=d||{},d.compress=!1!==d.compress,a={type:a,data:b,options:d},this.emit("packetCreate",a),this.writeBuffer.push(a),c&&this.once("flush",c),this.flush()};b.prototype.close=function(){function a(){c.onClose("forced close");k("socket closing - telling transport to close");c.transport.close()}function b(){c.removeListener("upgrade",b);c.removeListener("upgradeError",
b);a()}function d(){c.once("upgrade",b);c.once("upgradeError",b)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var c=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?d():a()}):this.upgrading?d():a()}return this};b.prototype.onError=function(a){k("socket error %j",a);b.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};b.prototype.onClose=function(a,b){if("opening"===this.readyState||"open"===this.readyState||
"closing"===this.readyState)k('socket close with reason: "%s"',a),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b),this.writeBuffer=[],this.prevBufferLen=0};b.prototype.filterUpgrades=function(a){for(var b=[],d=0,c=a.length;d<c;d++)~l(this.transports,a[d])&&b.push(a[d]);return b}}).call(f,function(){return this}())},
function(g,f,e){(function(a){var b=e(18),g=e(20),c=e(34),k=e(35);f.polling=function(e){var h,d=!1,f=!1,m=!1!==e.jsonp;a.location&&(f="https:"===location.protocol,(d=location.port)||(d=f?443:80),d=e.hostname!==location.hostname||d!==e.port,f=e.secure!==f);if(e.xdomain=d,e.xscheme=f,h=new b(e),"open"in h&&!e.forceJSONP)return new g(e);if(!m)throw Error("JSONP disabled");return new c(e)};f.websocket=k}).call(f,function(){return this}())},function(g,f,e){(function(a){var b=e(19);g.exports=function(e){var c=
e.xdomain,f=e.xscheme;e=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!c||b))return new XMLHttpRequest}catch(l){}try{if("undefined"!=typeof XDomainRequest&&!f&&e)return new XDomainRequest}catch(l){}if(!c)try{return new (a[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(l){}}}).call(f,function(){return this}())},function(g,f){try{g.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){g.exports=!1}},function(g,f,e){(function(a){function b(){}
function f(b){if(h.call(this,b),this.requestTimeout=b.requestTimeout,this.extraHeaders=b.extraHeaders,a.location){var d="https:"===location.protocol,c=location.port;c||(c=d?443:80);this.xd=b.hostname!==a.location.hostname||c!==b.port;this.xs=b.secure!==d}}function c(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!==a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=
a.enablesXDR;this.requestTimeout=a.requestTimeout;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.extraHeaders=a.extraHeaders;this.create()}function k(){for(var a in c.requests)c.requests.hasOwnProperty(a)&&c.requests[a].abort()}var l=e(18),h=e(21),d=e(8),x=e(32),t=e(3)("engine.io-client:polling-xhr");g.exports=f;g.exports.Request=c;x(f,h);f.prototype.supportsBinary=!0;f.prototype.request=
function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.requestTimeout=this.requestTimeout,a.extraHeaders=this.extraHeaders,new c(a)};f.prototype.doWrite=function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!=typeof a&&void 0!==
a});var d=this;a.on("success",b);a.on("error",function(a){d.onError("xhr post error",a)});this.sendXhr=a};f.prototype.doPoll=function(){t("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};d(c.prototype);c.prototype.create=function(){var b={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;
b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;var d=this.xhr=new l(b),e=this;try{t("xhr open %s: %s",this.method,this.uri);d.open(this.method,this.uri,this.async);try{if(this.extraHeaders){d.setDisableHeaderCheck&&d.setDisableHeaderCheck(!0);for(var h in this.extraHeaders)this.extraHeaders.hasOwnProperty(h)&&d.setRequestHeader(h,this.extraHeaders[h])}}catch(w){}if("POST"===this.method)try{this.isBinary?d.setRequestHeader("Content-type","application/octet-stream"):d.setRequestHeader("Content-type",
"text/plain;charset\x3dUTF-8")}catch(w){}try{d.setRequestHeader("Accept","*/*")}catch(w){}"withCredentials"in d&&(d.withCredentials=!0);this.requestTimeout&&(d.timeout=this.requestTimeout);this.hasXDR()?(d.onload=function(){e.onLoad()},d.onerror=function(){e.onError(d.responseText)}):d.onreadystatechange=function(){if(2===d.readyState){try{var a=d.getResponseHeader("Content-Type")}catch(A){}"application/octet-stream"===a&&(d.responseType="arraybuffer")}4===d.readyState&&(200===d.status||1223===d.status?
e.onLoad():setTimeout(function(){e.onError(d.status)},0))};t("xhr data %s",this.data);d.send(this.data)}catch(w){return void setTimeout(function(){e.onError(w)},0)}a.document&&(this.index=c.requestsCount++,c.requests[this.index]=this)};c.prototype.onSuccess=function(){this.emit("success");this.cleanup()};c.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};c.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};c.prototype.cleanup=function(d){if("undefined"!=typeof this.xhr&&
null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=b:this.xhr.onreadystatechange=b,d)try{this.xhr.abort()}catch(u){}a.document&&delete c.requests[this.index];this.xhr=null}};c.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type")}catch(v){}var b="application/octet-stream"===a?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(v){this.onError(v)}null!=b&&this.onData(b)};c.prototype.hasXDR=function(){return"undefined"!=typeof a.XDomainRequest&&
!this.xs&&this.enablesXDR};c.prototype.abort=function(){this.cleanup()};c.requestsCount=0;c.requests={};a.document&&(a.attachEvent?a.attachEvent("onunload",k):a.addEventListener&&a.addEventListener("beforeunload",k,!1))}).call(f,function(){return this}())},function(g,f,e){function a(a){var d=a&&a.forceBase64;h&&!d||(this.supportsBinary=!1);b.call(this,a)}var b=e(22),m=e(31),c=e(23);f=e(32);var k=e(33),l=e(3)("engine.io-client:polling");g.exports=a;var h=null!=(new (e(18))({xdomain:!1})).responseType;
f(a,b);a.prototype.name="polling";a.prototype.doOpen=function(){this.poll()};a.prototype.pause=function(a){function b(){l("paused");d.readyState="paused";a()}var d=this;if(this.readyState="pausing",this.polling||!this.writable){var c=0;this.polling&&(l("we are currently polling - waiting to pause"),c++,this.once("pollComplete",function(){l("pre-pause polling complete");--c||b()}));this.writable||(l("we are currently writing - waiting to pause"),c++,this.once("drain",function(){l("pre-pause writing complete");
--c||b()}))}else b()};a.prototype.poll=function(){l("polling");this.polling=!0;this.doPoll();this.emit("poll")};a.prototype.onData=function(a){var b=this;l("polling got data %s",a);c.decodePayload(a,this.socket.binaryType,function(a,d,c){return"opening"===b.readyState&&b.onOpen(),"close"===a.type?(b.onClose(),!1):void b.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))};
a.prototype.doClose=function(){function a(){l("writing close packet");b.write([{type:"close"}])}var b=this;"open"===this.readyState?(l("transport open - closing"),a()):(l("transport not open - deferring close"),this.once("open",a))};a.prototype.write=function(a){var b=this;this.writable=!1;var d=function(){b.writable=!0;b.emit("drain")};c.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,d)})};a.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";!1!==this.timestampRequests&&
(a[this.timestampParam]=k());this.supportsBinary||a.sid||(a.b64=1);a=m.encode(a);this.port&&("https"===b&&443!==Number(this.port)||"http"===b&&80!==Number(this.port))&&(c=":"+this.port);a.length&&(a="?"+a);var e=-1!==this.hostname.indexOf(":");return b+"://"+(e?"["+this.hostname+"]":this.hostname)+c+this.path+a}},function(g,f,e){function a(a){this.path=a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=
a.timestampRequests;this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.forceNode=a.forceNode;this.extraHeaders=a.extraHeaders;this.localAddress=a.localAddress}var b=e(23);f=e(8);g.exports=a;f(a.prototype);a.prototype.onError=function(a,b){a=Error(a);return a.type="TransportError",a.description=b,this.emit("error",
a),this};a.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this};a.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};a.prototype.send=function(a){if("open"!==this.readyState)throw Error("Transport not open");this.write(a)};a.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};a.prototype.onData=function(a){a=b.decodePacket(a,
this.socket.binaryType);this.onPacket(a)};a.prototype.onPacket=function(a){this.emit("packet",a)};a.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(g,f,e){(function(a){function b(a,b,d){if(!b)return f.encodeBase64Packet(a,d);var c=new FileReader;return c.onload=function(){a.data=c.result;f.encodePacket(a,b,!0,d)},c.readAsArrayBuffer(a.data)}function g(a,b,c){var e=Array(a.length);c=d(a.length,c);for(var h=function(a,d,c){b(d,function(b,d){e[a]=d;c(b,e)})},f=0;f<
a.length;f++)h(f,a[f],c)}var c,k=e(24),l=e(9),h=e(25),d=e(26),x=e(27);a&&a.ArrayBuffer&&(c=e(29));var t="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),p="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),u=t||p;f.protocol=3;var v=f.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},n=k(v),w={type:"error",data:"parser error"},A=e(30);f.encodePacket=function(d,c,e,h){"function"==typeof c&&(h=c,c=!1);"function"==typeof e&&(h=e,e=null);var g=void 0===
d.data?void 0:d.data.buffer||d.data;if(a.ArrayBuffer&&g instanceof ArrayBuffer){if(c){e=d.data;c=new Uint8Array(e);e=new Uint8Array(1+e.byteLength);e[0]=v[d.type];for(d=0;d<c.length;d++)e[d+1]=c[d];d=h(e.buffer)}else d=f.encodeBase64Packet(d,h);return d}if(A&&g instanceof a.Blob)return c?u?d=b(d,c,h):(c=new Uint8Array(1),c[0]=v[d.type],d=new A([c.buffer,d.data]),d=h(d)):d=f.encodeBase64Packet(d,h),d;if(g&&g.base64)return h("b"+f.packets[d.type]+d.data.data);c=v[d.type];return void 0!==d.data&&(c+=
e?x.encode(String(d.data),{strict:!1}):String(d.data)),h(""+c)};f.encodeBase64Packet=function(b,d){var c="b"+f.packets[b.type];if(A&&b.data instanceof a.Blob){var e=new FileReader;return e.onload=function(){var a=e.result.split(",")[1];d(c+a)},e.readAsDataURL(b.data)}try{var h=String.fromCharCode.apply(null,new Uint8Array(b.data))}catch(D){b=new Uint8Array(b.data);h=Array(b.length);for(var g=0;g<b.length;g++)h[g]=b[g];h=String.fromCharCode.apply(null,h)}return c+=a.btoa(h),d(c)};f.decodePacket=function(a,
b,d){if(void 0===a)return w;if("string"==typeof a){if("b"===a.charAt(0))return f.decodeBase64Packet(a.substr(1),b);if(b=d){b=a;try{b=x.decode(b,{strict:!1})}catch(y){b=!1}b=(a=b,!1===a)}if(b)return w;d=a.charAt(0);return Number(d)==d&&n[d]?1<a.length?{type:n[d],data:a.substring(1)}:{type:n[d]}:w}d=(new Uint8Array(a))[0];a=h(a,1);return A&&"blob"===b&&(a=new A([a])),{type:n[d],data:a}};f.decodeBase64Packet=function(a,b){var d=n[a.charAt(0)];if(!c)return{type:d,data:{base64:!0,data:a.substr(1)}};a=
c.decode(a.substr(1));return"blob"===b&&A&&(a=new A([a])),{type:d,data:a}};f.encodePayload=function(a,b,d){function c(a,d){f.encodePacket(a,!!e&&b,!1,function(a){d(null,a.length+":"+a)})}"function"==typeof b&&(d=b,b=null);var e=l(a);return b&&e?A&&!u?f.encodePayloadAsBlob(a,d):f.encodePayloadAsArrayBuffer(a,d):a.length?void g(a,c,function(a,b){return d(b.join(""))}):d("0:")};f.decodePayload=function(a,b,d){if("string"!=typeof a)return f.decodePayloadAsBinary(a,b,d);"function"==typeof b&&(d=b,b=null);
var c;if(""===a)return d(w,0,1);for(var e,h,g="",l=0,m=a.length;l<m;l++){var p=a.charAt(l);if(":"===p){if(""===g||g!=(e=Number(g))||(h=a.substr(l+1,e),g!=h.length))return d(w,0,1);if(h.length){if(c=f.decodePacket(h,b,!1),w.type===c.type&&w.data===c.data)return d(w,0,1);if(!1===d(c,l+e,m))return}l+=e;g=""}else g+=p}return""!==g?d(w,0,1):void 0};f.encodePayloadAsArrayBuffer=function(a,b){function d(a,b){f.encodePacket(a,!0,!0,function(a){return b(null,a)})}return a.length?void g(a,d,function(a,d){a=
d.reduce(function(a,b){var d;return d="string"==typeof b?b.length:b.byteLength,a+d.toString().length+d+2},0);var c=new Uint8Array(a),e=0;return d.forEach(function(a){var b="string"==typeof a,d=a;if(b){for(var d=new Uint8Array(a.length),h=0;h<a.length;h++)d[h]=a.charCodeAt(h);d=d.buffer}b?c[e++]=0:c[e++]=1;a=d.byteLength.toString();for(h=0;h<a.length;h++)c[e++]=parseInt(a[h]);c[e++]=255;d=new Uint8Array(d);for(h=0;h<d.length;h++)c[e++]=d[h]}),b(c.buffer)}):b(new ArrayBuffer(0))};f.encodePayloadAsBlob=
function(a,b){g(a,function(a,b){f.encodePacket(a,!0,!0,function(a){var d=new Uint8Array(1);if(d[0]=1,"string"==typeof a){for(var c=new Uint8Array(a.length),e=0;e<a.length;e++)c[e]=a.charCodeAt(e);a=c.buffer;d[0]=0}for(var c=(a instanceof ArrayBuffer?a.byteLength:a.size).toString(),h=new Uint8Array(c.length+1),e=0;e<c.length;e++)h[e]=parseInt(c[e]);if(h[c.length]=255,A)a=new A([d.buffer,h.buffer,a]),b(null,a)})},function(a,d){return b(new A(d))})};f.decodePayloadAsBinary=function(a,b,d){"function"==
typeof b&&(d=b,b=null);for(var c=[];0<a.byteLength;){for(var e=new Uint8Array(a),g=0===e[0],l="",m=1;255!==e[m];m++){if(310<l.length)return d(w,0,1);l+=e[m]}a=h(a,2+l.length);l=parseInt(l);e=h(a,0,l);if(g)try{e=String.fromCharCode.apply(null,new Uint8Array(e))}catch(N){for(g=new Uint8Array(e),e="",m=0;m<g.length;m++)e+=String.fromCharCode(g[m])}c.push(e);a=h(a,l)}var p=c.length;c.forEach(function(a,c){d(f.decodePacket(a,b,!0),c,p)})}}).call(f,function(){return this}())},function(g,f){g.exports=Object.keys||
function(e){var a=[],b=Object.prototype.hasOwnProperty,f;for(f in e)b.call(e,f)&&a.push(f);return a}},function(g,f){g.exports=function(e,a,b){var f=e.byteLength;if(a=a||0,b=b||f,e.slice)return e.slice(a,b);if(0>a&&(a+=f),0>b&&(b+=f),b>f&&(b=f),a>=f||a>=b||0===f)return new ArrayBuffer(0);e=new Uint8Array(e);for(var f=new Uint8Array(b-a),c=0;a<b;a++,c++)f[c]=e[a];return f.buffer}},function(g,f){function e(){}g.exports=function(a,b,f){function c(a,e){if(0>=c.count)throw Error("after called too many times");
--c.count;a?(g=!0,b(a),b=f):0!==c.count||g||b(null,e)}var g=!1;return f=f||e,c.count=a,0===a?b():c}},function(g,f,e){var a;(function(b,g){!function(c){function g(a){for(var b,d,c=[],e=0,h=a.length;e<h;)b=a.charCodeAt(e++),55296<=b&&56319>=b&&e<h?(d=a.charCodeAt(e++),56320==(64512&d)?c.push(((1023&b)<<10)+(1023&d)+65536):(c.push(b),e--)):c.push(b);return c}function l(a,b){if(55296<=a&&57343>=a){if(b)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}
function h(){if(p>=k)throw Error("Invalid byte index");var a=255&m[p];if(p++,128==(192&a))return 63&a;throw Error("Invalid continuation byte");}function d(a){var b,d,c,e,f;if(p>k)throw Error("Invalid byte index");if(p==k)return!1;if(b=255&m[p],p++,0==(128&b))return b;if(192==(224&b)){if(d=h(),f=(31&b)<<6|d,128<=f)return f;throw Error("Invalid continuation byte");}if(224==(240&b)){if(d=h(),c=h(),f=(15&b)<<12|d<<6|c,2048<=f)return l(f,a)?f:65533;throw Error("Invalid continuation byte");}if(240==(248&
b)&&(d=h(),c=h(),e=h(),f=(7&b)<<18|d<<12|c<<6|e,65536<=f&&1114111>=f))return f;throw Error("Invalid UTF-8 detected");}c="object"==typeof f&&f;"object"==typeof b&&b&&b.exports==c&&b;var m,k,p,u=String.fromCharCode,v={version:"2.1.2",encode:function(a,b){b=b||{};b=!1!==b.strict;a=g(a);for(var d=a.length,c=-1,e="";++c<d;){var h=a[c];var f=b;if(0==(4294967168&h))f=u(h);else{var m="";f=(0==(4294965248&h)?m=u(h>>6&31|192):0==(4294901760&h)?(l(h,f)||(h=65533),m=u(h>>12&15|224),m+=u(h>>6&63|128)):0==(4292870144&
h)&&(m=u(h>>18&7|240),m+=u(h>>12&63|128),m+=u(h>>6&63|128)),m+u(63&h|128))}e+=f}return e},decode:function(a,b){b=b||{};b=!1!==b.strict;m=g(a);k=m.length;p=0;var c;for(a=[];!1!==(c=d(b));)a.push(c);c=a.length;for(var e=-1,h="";++e<c;)b=a[e],65535<b&&(b-=65536,h+=u(b>>>10&1023|55296),b=56320|1023&b),h+=u(b);return h}};a=function(){return v}.call(f,e,f,b);!(void 0!==a&&(b.exports=a))}(this)}).call(f,e(28)(g),function(){return this}())},function(g,f){g.exports=function(e){return e.webpackPolyfill||(e.deprecate=
function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(g,f){!function(){for(var e=new Uint8Array(256),a=0;64>a;a++)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;f.encode=function(a){var b=new Uint8Array(a),c=b.length,e="";for(a=0;a<c;a+=3)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[b[a]>>2],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&b[a])<<4|b[a+1]>>4],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&
b[a+1])<<2|b[a+2]>>6],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&b[a+2]];return 2===c%3?e=e.substring(0,e.length-1)+"\x3d":1===c%3&&(e=e.substring(0,e.length-2)+"\x3d\x3d"),e};f.decode=function(a){var b=.75*a.length;var c=a.length,f=0;"\x3d"===a[a.length-1]&&(b--,"\x3d"===a[a.length-2]&&b--);var g=new ArrayBuffer(b),h=new Uint8Array(g);for(b=0;b<c;b+=4){var d=e[a.charCodeAt(b)];var k=e[a.charCodeAt(b+1)];var t=e[a.charCodeAt(b+2)];var p=e[a.charCodeAt(b+3)];h[f++]=d<<
2|k>>4;h[f++]=(15&k)<<4|t>>2;h[f++]=(3&t)<<6|63&p}return g}}()},function(g,f){(function(e){function a(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.buffer instanceof ArrayBuffer){var c=d.buffer;if(d.byteLength!==c.byteLength){var e=new Uint8Array(d.byteLength);e.set(new Uint8Array(c,d.byteOffset,d.byteLength));c=e.buffer}a[b]=c}}}function b(b,e){e=e||{};var d=new c;a(b);for(var h=0;h<b.length;h++)d.append(b[h]);return e.type?d.getBlob(e.type):d.getBlob()}function f(b,c){return a(b),new Blob(b,c||
{})}var c=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder;try{var k=2===(new Blob(["hi"])).size}catch(d){k=!1}var l;if(l=k)try{l=2===(new Blob([new Uint8Array([1,2])])).size}catch(d){l=!1}var h=c&&c.prototype.append&&c.prototype.getBlob;g.exports=k?l?e.Blob:f:h?b:void 0}).call(f,function(){return this}())},function(g,f){f.encode=function(e){var a="",b;for(b in e)e.hasOwnProperty(b)&&(a.length&&(a+="\x26"),a+=encodeURIComponent(b)+"\x3d"+encodeURIComponent(e[b]));return a};f.decode=
function(e){var a={};e=e.split("\x26");for(var b=0,f=e.length;b<f;b++){var c=e[b].split("\x3d");a[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}return a}},function(g,f){g.exports=function(e,a){var b=function(){};b.prototype=a.prototype;e.prototype=new b;e.prototype.constructor=e}},function(g,f){function e(a){var b="";do b=m[a%c]+b,a=Math.floor(a/c);while(0<a);return b}function a(){var a=e(+new Date);return a!==b?(l=0,b=a):a+"."+e(l++)}for(var b,m="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),
c=64,k={},l=0,h=0;h<c;h++)k[m[h]]=h;a.encode=e;a.decode=function(a){var b=0;for(h=0;h<a.length;h++)b=b*c+k[a.charAt(h)];return b};g.exports=a},function(g,f,e){(function(a){function b(){}function f(d){c.call(this,d);this.query=this.query||{};l||(a.___eio||(a.___eio=[]),l=a.___eio);this.index=l.length;var e=this;l.push(function(a){e.onData(a)});this.query.j=this.index;a.document&&a.addEventListener&&a.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=b)},!1)}var c=e(21),k=e(32);
g.exports=f;var l,h=/\n/g,d=/\\n/g;k(f,c);f.prototype.supportsBinary=!1;f.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null);c.prototype.doClose.call(this)};f.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",
b)};var d=document.getElementsByTagName("script")[0];d?d.parentNode.insertBefore(b,d):(document.head||document.body).appendChild(b);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};f.prototype.doWrite=function(a,b){function c(){e();b()}function e(){if(g.iframe)try{g.form.removeChild(g.iframe)}catch(G){g.onError("jsonp polling iframe removal error",
G)}try{f=document.createElement('\x3ciframe src\x3d"javascript:0" name\x3d"'+g.iframeId+'"\x3e')}catch(G){f=document.createElement("iframe"),f.name=g.iframeId,f.src="javascript:0"}f.id=g.iframeId;g.form.appendChild(f);g.iframe=f}var f,g=this;if(!this.form){var l=document.createElement("form"),m=document.createElement("textarea"),k=this.iframeId="eio_iframe_"+this.index;l.className="socketio";l.style.position="absolute";l.style.top="-1000px";l.style.left="-1000px";l.target=k;l.method="POST";l.setAttribute("accept-charset",
"utf-8");m.name="d";l.appendChild(m);document.body.appendChild(l);this.form=l;this.area=m}this.form.action=this.uri();e();a=a.replace(d,"\\\n");this.area.value=a.replace(h,"\\n");try{this.form.submit()}catch(G){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===g.iframe.readyState&&c()}:this.iframe.onload=c}}).call(f,function(){return this}())},function(g,f,e){(function(a){function b(a){a&&a.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=a.perMessageDeflate;
this.usingBrowserWebSocket=n&&!a.forceNode;this.protocols=a.protocols;this.usingBrowserWebSocket||(p=t);f.call(this,a)}var f=e(22),c=e(23),k=e(31),l=e(32),h=e(33),d=e(3)("engine.io-client:websocket"),n=a.WebSocket||a.MozWebSocket;if("undefined"==typeof window)try{var t=e(36)}catch(u){}var p=n;p||"undefined"!=typeof window||(p=t);g.exports=b;l(b,f);b.prototype.name="websocket";b.prototype.supportsBinary=!0;b.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=this.protocols,d={agent:this.agent,
perMessageDeflate:this.perMessageDeflate};d.pfx=this.pfx;d.key=this.key;d.passphrase=this.passphrase;d.cert=this.cert;d.ca=this.ca;d.ciphers=this.ciphers;d.rejectUnauthorized=this.rejectUnauthorized;this.extraHeaders&&(d.headers=this.extraHeaders);this.localAddress&&(d.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?b?new p(a,b):new p(a):new p(a,b,d)}catch(w){return this.emit("error",w)}void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?
(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer";this.addEventListeners()}};b.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};b.prototype.write=function(b){function e(){h.emit("flush");setTimeout(function(){h.writable=!0;h.emit("drain")},0)}var h=this;this.writable=!1;for(var f=
b.length,g=0,l=f;g<l;g++)!function(b){c.encodePacket(b,h.supportsBinary,function(c){if(!h.usingBrowserWebSocket){var g={};(b.options&&(g.compress=b.options.compress),h.perMessageDeflate)&&("string"==typeof c?a.Buffer.byteLength(c):c.length)<h.perMessageDeflate.threshold&&(g.compress=!1)}try{h.usingBrowserWebSocket?h.ws.send(c):h.ws.send(c,g)}catch(H){d("websocket closed before onclose event")}--f||e()})}(b[g])};b.prototype.onClose=function(){f.prototype.onClose.call(this)};b.prototype.doClose=function(){"undefined"!=
typeof this.ws&&this.ws.close()};b.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",d="";this.port&&("wss"===b&&443!==Number(this.port)||"ws"===b&&80!==Number(this.port))&&(d=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=h());this.supportsBinary||(a.b64=1);a=k.encode(a);a.length&&(a="?"+a);var c=-1!==this.hostname.indexOf(":");return b+"://"+(c?"["+this.hostname+"]":this.hostname)+d+this.path+a};b.prototype.check=function(){return!(!p||"__initialize"in p&&this.name===
b.prototype.name)}}).call(f,function(){return this}())},function(g,f){},function(g,f){var e=[].indexOf;g.exports=function(a,b){if(e)return a.indexOf(b);for(var f=0;f<a.length;++f)if(a[f]===b)return f;return-1}},function(g,f){(function(e){var a=/^[\],:{}\s]*$/,b=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,f=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,c=/(?:^|:|,)(?:\s*\[)+/g,k=/^\s+/,l=/\s+$/;g.exports=function(h){return"string"==typeof h&&h?(h=h.replace(k,"").replace(l,""),e.JSON&&
JSON.parse?JSON.parse(h):a.test(h.replace(b,"@").replace(f,"]").replace(c,""))?(new Function("return "+h))():void 0):null}}).call(f,function(){return this}())},function(g,f,e){function a(a,b,d){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;d&&d.query&&(this.query=d.query);this.io.autoConnect&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"==typeof Symbol&&
"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m=e(7);f=e(8);var c=e(40),k=e(41),l=e(42),h=e(3)("socket.io-client:socket"),d=e(31);g.exports=a;var n={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,
ping:1,pong:1},t=f.prototype.emit;f(a.prototype);a.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[k(a,"open",l(this,"onopen")),k(a,"packet",l(this,"onpacket")),k(a,"close",l(this,"onclose"))]}};a.prototype.open=a.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)};a.prototype.send=function(){var a=c(arguments);return a.unshift("message"),this.emit.apply(this,a),this};
a.prototype.emit=function(a){if(n.hasOwnProperty(a))return t.apply(this,arguments),this;var b=c(arguments),d={type:m.EVENT,data:b};return d.options={},d.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof b[b.length-1]&&(h("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++),this.connected?this.packet(d):this.sendBuffer.push(d),delete this.flags,this};a.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};a.prototype.onopen=function(){if(h("transport is open - connecting"),
"/"!==this.nsp)if(this.query){var a="object"===b(this.query)?d.encode(this.query):this.query;h("sending connect packet with query %s",a);this.packet({type:m.CONNECT,query:a})}else this.packet({type:m.CONNECT})};a.prototype.onclose=function(a){h("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};a.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case m.CONNECT:this.onconnect();break;case m.EVENT:this.onevent(a);break;case m.BINARY_EVENT:this.onevent(a);
break;case m.ACK:this.onack(a);break;case m.BINARY_ACK:this.onack(a);break;case m.DISCONNECT:this.ondisconnect();break;case m.ERROR:this.emit("error",a.data)}};a.prototype.onevent=function(a){var b=a.data||[];h("emitting event %j",b);null!=a.id&&(h("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?t.apply(this,b):this.receiveBuffer.push(b)};a.prototype.ack=function(a){var b=this,d=!1;return function(){if(!d){d=!0;var e=c(arguments);h("sending ack %j",e);b.packet({type:m.ACK,
id:a,data:e})}}};a.prototype.onack=function(a){var b=this.acks[a.id];"function"==typeof b?(h("calling ack %s with %j",a.id,a.data),b.apply(this,a.data),delete this.acks[a.id]):h("bad ack %s",a.id)};a.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};a.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)t.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);
this.sendBuffer=[]};a.prototype.ondisconnect=function(){h("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};a.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};a.prototype.close=a.prototype.disconnect=function(){return this.connected&&(h("performing disconnect (%s)",this.nsp),this.packet({type:m.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),
this};a.prototype.compress=function(a){return this.flags=this.flags||{},this.flags.compress=a,this}},function(g,f){g.exports=function(e,a){for(var b=[],f=(a=a||0)||0;f<e.length;f++)b[f-a]=e[f];return b}},function(g,f){g.exports=function(e,a,b){return e.on(a,b),{destroy:function(){e.removeListener(a,b)}}}},function(g,f){var e=[].slice;g.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw Error("bind() requires a function");var f=e.call(arguments,2);return function(){return b.apply(a,
f.concat(e.call(arguments)))}}},function(g,f){function e(a){a=a||{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}g.exports=e;e.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter)var b=Math.random(),e=Math.floor(b*this.jitter*a),a=0==(1&Math.floor(10*b))?a-e:a+e;return 0|Math.min(a,this.max)};e.prototype.reset=function(){this.attempts=0};e.prototype.setMin=function(a){this.ms=
a};e.prototype.setMax=function(a){this.max=a};e.prototype.setJitter=function(a){this.jitter=a}}])})},function(n,r,k){n=function(){return{getRandomValue:function(){var g=new Uint16Array(1);window.crypto.getRandomValues(g);return g[0]}}}();r.a=n},function(n,r,k){var g=k(5),f=k(23);r.a=function(e){var a=Object(g.a)({});a.id=e.id;a.stream=e.stream.stream;a.elementID=e.elementID;var b=function(){a.bar.display()},m=function(){a.bar.hide()},c=function(b,c,e,d){(d?1/b*c>e:1/b*c<e)?(a.video.style.width=c+
"px",a.video.style.height=1/b*c+"px",a.video.style.top=-(1/b*c/2-e/2)+"px",a.video.style.left="0px"):(a.video.style.height=e+"px",a.video.style.width=b*e+"px",a.video.style.left=-(b*e/2-c/2)+"px",a.video.style.top="0px")};a.destroy=function(){a.video.pause();delete a.resizer;a.parentNode.removeChild(a.div)};a.resize=function(){var b=a.container.offsetWidth,f=a.container.offsetHeight;e.stream.screen||!1===e.options.crop?c(16/9,b,f,!1):b===a.containerWidth&&f===a.containerHeight||c(4/3,b,f,!0);a.containerWidth=
b;a.containerHeight=f};a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;");!1!==e.options.loader&&(a.loader=document.createElement("img"),a.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),a.loader.setAttribute("id","back_"+a.id),
a.loader.setAttribute("class","licode_loader"),a.loader.setAttribute("src",a.url+"/assets/loader.gif"));a.video=document.createElement("video");a.video.setAttribute("id","stream"+a.id);a.video.setAttribute("class","licode_stream");a.video.setAttribute("style","width: 100%; height: 100%; position: absolute");a.video.setAttribute("autoplay","autoplay");a.video.setAttribute("playsinline","playsinline");e.stream.local&&(a.video.volume=0);a.container=void 0!==a.elementID?"object"===typeof a.elementID&&
"function"===typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID):document.body;a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.loader&&a.div.appendChild(a.loader);a.div.appendChild(a.video);a.containerWidth=0;a.containerHeight=0;!1!==e.options.resizer&&(a.resizer=L.ResizeSensor(a.container,a.resize),a.resize());!1!==e.options.bar?(a.bar=Object(f.a)({elementID:"player_"+a.id,id:a.id,stream:e.stream,media:a.video,options:e.options}),a.div.onmouseover=b,a.div.onmouseout=
m):a.media=a.video;a.video.srcObject=a.stream;return a}},function(n,r,k){var g=k(5);r.a=function(f){var e=Object(g.a)({}),a=50;e.elementID=f.elementID;e.media=f.media;e.id=f.id;e.stream=f.stream;e.div=document.createElement("div");e.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;");e.icon=document.createElement("img");e.icon.setAttribute("id","volume_"+e.id);e.icon.setAttribute("src",e.url+"/assets/sound48.png");e.icon.setAttribute("style",
"width: 80%; height: 100%; position: absolute;");e.div.appendChild(e.icon);e.icon.onclick=function(){e.media.muted?(e.media.muted=!1,e.icon.setAttribute("src",e.url+"/assets/sound48.png"),e.stream.local?e.stream.stream.getAudioTracks()[0].enabled=!0:(e.picker.value=a,e.media.volume=e.picker.value/100)):(e.media.muted=!0,e.icon.setAttribute("src",e.url+"/assets/mute48.png"),e.stream.local?e.stream.stream.getAudioTracks()[0].enabled=!1:(a=e.picker.value,e.picker.value=0,e.media.volume=0))};if(!e.stream.local){e.picker=
document.createElement("input");e.picker.setAttribute("id","picker_"+e.id);e.picker.type="range";e.picker.min=0;e.picker.max=100;e.picker.step=10;e.picker.value=a;e.picker.setAttribute("orient","vertical");e.div.appendChild(e.picker);e.media.volume=e.picker.value/100;e.media.muted=!1;e.picker.oninput=function(){0<e.picker.value?(e.media.muted=!1,e.icon.setAttribute("src",e.url+"/assets/sound48.png")):(e.media.muted=!0,e.icon.setAttribute("src",e.url+"/assets/mute48.png"));e.media.volume=e.picker.value/
100};var b=function(a){e.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: "+e.div.offsetHeight+"px; display: "+a)};e.div.onmouseover=function(){b("block")};e.div.onmouseout=function(){b("none")};b("none")}document.getElementById(e.elementID).appendChild(e.div);
return e}},function(n,r,k){var g=k(5),f=k(23);r.a=function(e){var a=Object(g.a)({});a.id=e.id;a.stream=e.stream.stream;a.elementID=e.elementID;a.audio=document.createElement("audio");a.audio.setAttribute("id","stream"+a.id);a.audio.setAttribute("class","licode_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");a.audio.setAttribute("autoplay","autoplay");e.stream.local&&(a.audio.volume=0);if(void 0!==a.elementID){a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)};
var b=function(){a.bar.display()};var m=function(){a.bar.hide()};a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;");a.container="object"===typeof a.elementID&&"function"===typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID);a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.div.appendChild(a.audio);
!1!==e.options.bar?(a.bar=Object(f.a)({elementID:"player_"+a.id,id:a.id,stream:e.stream,media:a.audio,options:e.options}),a.div.onmouseover=b,a.div.onmouseout=m):a.media=a.audio}else a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body;a.audio.srcObject=a.stream;return a}},function(n,r,k){n=function(){for(var g,f,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),a=[],b=0;b<e.length;b+=1)a[e[b]]=
b;var m=function(){if(!g||f>=g.length)return-1;var a=g.charCodeAt(f)&255;f+=1;return a},c=function(){if(!g)return-1;for(;;){if(f>=g.length)return-1;var b=g.charAt(f);f+=1;if(a[b])return a[b];if("A"===b)return 0}},k=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var b;g=a;f=0;a="";var d=Array(3);var c=0;for(b=!1;!b&&-1!==(d[0]=m());)d[1]=m(),d[2]=m(),a+=e[d[0]>>2],-1!==d[1]?(a+=e[d[0]<<4&48|d[1]>>4],-1!==d[2]?(a+=e[d[1]<<2&60|d[2]>>6],a+=
e[d[2]&63]):(a+=e[d[1]<<2&60],a+="\x3d",b=!0)):(a+=e[d[0]<<4&48],a+="\x3d",a+="\x3d",b=!0),c+=4,76<=c&&(a+="\n",c=0);return a},decodeBase64:function(a){var b;g=a;f=0;a="";var d=Array(4);for(b=!1;!b&&-1!==(d[0]=c())&&-1!==(d[1]=c());)d[2]=c(),d[3]=c(),a+=k(d[0]<<2&255|d[1]>>4),-1!==d[2]?(a+=k(d[1]<<4&255|d[2]>>2),-1!==d[3]?a+=k(d[2]<<6&255|d[3]):b=!0):b=!0;return a}}}();r.a=n},function(n,r,k){(function(g){n.exports=g.adapter=k(51)}).call(r,k(50))},function(n,r){r=function(){return this}();try{r=r||
Function("return this")()||(0,eval)("this")}catch(k){"object"===typeof window&&(r=window)}n.exports=r},function(n,r,k){n.exports=function(){return function(){function g(f,e,a){function b(c,l){if(!e[c]){if(!f[c]){if(m)return m(c,!0);l=Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l;}l=e[c]={exports:{}};f[c][0].call(l.exports,function(a){return b(f[c][1][a]||a)},l,l.exports,g,f,e,a)}return e[c].exports}for(var m=!1,c=0;c<a.length;c++)b(a[c]);return b}return g}()({1:[function(g,
f,e){g=g("./adapter_factory.js");g=(0,g.adapterFactory)({window:window});f.exports=g},{"./adapter_factory.js":2}],2:[function(g,f,e){function a(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}Object.defineProperty(e,"__esModule",{value:!0});e.adapterFactory=function(){var a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,
shimFirefox:!0,shimEdge:!0,shimSafari:!0},f=b.log,g=b.detectBrowser(a),q={browserDetails:g,commonShim:h,extractVersion:b.extractVersion,disableLog:b.disableLog,disableWarnings:b.disableWarnings};switch(g.browser){case "chrome":if(!m||!m.shimPeerConnection||!e.shimChrome){f("Chrome shim is not included in this adapter release.");break}f("adapter.js shimming chrome.");q.browserShim=m;m.shimGetUserMedia(a);m.shimMediaStream(a);m.shimPeerConnection(a);m.shimOnTrack(a);m.shimAddTrackRemoveTrack(a);m.shimGetSendersWithDtmf(a);
m.shimGetStats(a);m.shimSenderReceiverGetStats(a);m.fixNegotiationNeeded(a);h.shimRTCIceCandidate(a);h.shimConnectionState(a);h.shimMaxMessageSize(a);h.shimSendThrowTypeError(a);h.removeAllowExtmapMixed(a);break;case "firefox":if(!k||!k.shimPeerConnection||!e.shimFirefox){f("Firefox shim is not included in this adapter release.");break}f("adapter.js shimming firefox.");q.browserShim=k;k.shimGetUserMedia(a);k.shimPeerConnection(a);k.shimOnTrack(a);k.shimRemoveStream(a);k.shimSenderGetStats(a);k.shimReceiverGetStats(a);
k.shimRTCDataChannel(a);h.shimRTCIceCandidate(a);h.shimConnectionState(a);h.shimMaxMessageSize(a);h.shimSendThrowTypeError(a);break;case "edge":if(!c||!c.shimPeerConnection||!e.shimEdge){f("MS edge shim is not included in this adapter release.");break}f("adapter.js shimming edge.");q.browserShim=c;c.shimGetUserMedia(a);c.shimGetDisplayMedia(a);c.shimPeerConnection(a);c.shimReplaceTrack(a);h.shimMaxMessageSize(a);h.shimSendThrowTypeError(a);break;case "safari":if(!l||!e.shimSafari){f("Safari shim is not included in this adapter release.");
break}f("adapter.js shimming safari.");q.browserShim=l;l.shimRTCIceServerUrls(a);l.shimCreateOfferLegacy(a);l.shimCallbacksAPI(a);l.shimLocalStreamsAPI(a);l.shimRemoteStreamsAPI(a);l.shimTrackEventTransceiver(a);l.shimGetUserMedia(a);h.shimRTCIceCandidate(a);h.shimMaxMessageSize(a);h.shimSendThrowTypeError(a);h.removeAllowExtmapMixed(a);break;default:f("Unsupported browser!")}return q};f=g("./utils");var b=a(f);f=g("./chrome/chrome_shim");var m=a(f);f=g("./edge/edge_shim");var c=a(f);f=g("./firefox/firefox_shim");
var k=a(f);f=g("./safari/safari_shim");var l=a(f);g=g("./common_shim");var h=a(g)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(g,f,e){function a(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}function b(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};
var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){if(!d)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var c=b.apply(this,arguments);this._shimmedLocalStreams[d.id]?-1===this._shimmedLocalStreams[d.id].indexOf(c)&&this._shimmedLocalStreams[d.id].push(c):this._shimmedLocalStreams[d.id]=[d,c];return c};var c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=
this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var d=this.getSenders();c.apply(this,arguments);var e=this.getSenders().filter(function(a){return-1===d.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(e)};var e=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||
{};delete this._shimmedLocalStreams[a.id];return e.apply(this,arguments)};var h=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(d){var c=b._shimmedLocalStreams[d].indexOf(a);-1!==c&&b._shimmedLocalStreams[d].splice(c,1);1===b._shimmedLocalStreams[d].length&&delete b._shimmedLocalStreams[d]});return h.apply(this,arguments)}}Object.defineProperty(e,
"__esModule",{value:!0});e.shimGetDisplayMedia=e.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=g("./getusermedia");Object.defineProperty(e,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});
var k=g("./getdisplaymedia");Object.defineProperty(e,"shimGetDisplayMedia",{enumerable:!0,get:function(){return k.shimGetDisplayMedia}});e.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};e.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":m(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)l.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});
else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var d=this;this._ontrackpoly||(this._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(c){var e=void 0,
e=a.RTCPeerConnection.prototype.getReceivers?d.getReceivers().find(function(a){return a.track&&a.track.id===c.track.id}):{track:c.track},h=new Event("track");h.track=c.track;h.receiver=e;h.transceiver={receiver:e};h.streams=[b.stream];d.dispatchEvent(h)});b.stream.getTracks().forEach(function(c){var e=void 0,e=a.RTCPeerConnection.prototype.getReceivers?d.getReceivers().find(function(a){return a.track&&a.track.id===c.id}):{track:c},h=new Event("track");h.track=c;h.receiver=e;h.transceiver={receiver:e};
h.streams=[b.stream];d.dispatchEvent(h)})},this.addEventListener("addstream",this._ontrackpoly));return b.apply(this,arguments)}}};e.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?"undefined":m(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=
function(){this._senders=this._senders||[];return this._senders.slice()};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var e=c.apply(this,arguments);e||(e=b(this,a),this._senders.push(e));return e};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){e.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var h=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=
function(a){var d=this;this._senders=this._senders||[];h.apply(this,[a]);a.getTracks().forEach(function(a){d._senders.push(b(d,a))})};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[];f.apply(this,[a]);a.getTracks().forEach(function(a){var d=b._senders.find(function(b){return b.track===a});d&&b._senders.splice(b._senders.indexOf(d),1)})}}else if("object"===("undefined"===typeof a?"undefined":m(a))&&a.RTCPeerConnection&&
"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var g=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=g.apply(this,[]);b.forEach(function(b){return b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);
return this._dtmf}})}};e.shimGetStats=function(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=this,d=Array.prototype.slice.call(arguments),c=d[0],e=d[1],d=d[2];if(0<arguments.length&&"function"===typeof c)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!==typeof c))return b.apply(this,[]);var h=function(a){var b={};a.result().forEach(function(a){var d={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",
remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){d[b]=a.stat(b)});b[d.id]=d});return b},f=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?b.apply(this,[function(a){e(f(h(a)))},c]):(new Promise(function(d,c){b.apply(a,[function(a){d(f(h(a)))},c])})).then(e,d)}}};e.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":m(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in
a.RTCRtpSender.prototype)){var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,d=b.apply(this,[]);d.forEach(function(b){return b._pc=a});return d});var c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=c.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return l.filterStats(b,a.track,!0)})}}if(!("getStats"in
a.RTCRtpReceiver.prototype)){var e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=e.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});l.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return l.filterStats(b,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var h=
a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],d=void 0,c=void 0,e=void 0;this.getSenders().forEach(function(a){a.track===b&&(d?e=!0:d=a)});this.getReceivers().forEach(function(a){a.track===b&&(c?e=!0:c=a);return a.track===b});return e||d&&c?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):d?d.getStats():c?
c.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return h.apply(this,arguments)}}}};e.shimAddTrackRemoveTrackWithNative=b;e.shimAddTrackRemoveTrack=function(c){function d(a,b){var d=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];d=d.replace(new RegExp(a._streams[b.id].id,"g"),b.id)});return new RTCSessionDescription({type:b.type,sdp:d})}function e(a,b){var d=b.sdp;Object.keys(a._reverseStreams||
[]).forEach(function(b){b=a._reverseStreams[b];d=d.replace(new RegExp(b.id,"g"),a._streams[b.id].id)});return new RTCSessionDescription({type:b.type,sdp:d})}if(c.RTCPeerConnection){var f=l.detectBrowser(c);if(c.RTCPeerConnection.prototype.addTrack&&65<=f.version)return b(c);var h=c.RTCPeerConnection.prototype.getLocalStreams;c.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=h.apply(this);this._reverseStreams=this._reverseStreams||{};return b.map(function(b){return a._reverseStreams[b.id]})};
var g=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var d=new c.MediaStream(a.getTracks());this._streams[a.id]=d;this._reverseStreams[d.id]=a;a=d}g.apply(this,[a])};var m=c.RTCPeerConnection.prototype.removeStream;
c.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};m.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};c.RTCPeerConnection.prototype.addTrack=function(a,b){var d=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,
1);if(1!==e.length||!e[0].getTracks().find(function(b){return b===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(e=this._streams[b.id])?(e.addTrack(a),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):
(e=new c.MediaStream([a]),this._streams[b.id]=e,this._reverseStreams[e.id]=b,this.addStream(e));return this.getSenders().find(function(b){return b.track===a})};["createOffer","createAnswer"].forEach(function(b){var e=c.RTCPeerConnection.prototype[b],f=a({},b,function(){var a=this,b=arguments;return arguments.length&&"function"===typeof arguments[0]?e.apply(this,[function(c){c=d(a,c);b[0].apply(null,[c])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):e.apply(this,arguments).then(function(b){return d(a,
b)})});c.RTCPeerConnection.prototype[b]=f[b]});var k=c.RTCPeerConnection.prototype.setLocalDescription;c.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type)return k.apply(this,arguments);arguments[0]=e(this,arguments[0]);return k.apply(this,arguments)};var w=Object.getOwnPropertyDescriptor(c.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(c.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=w.get.apply(this);
return""===a.type?a:d(this,a)}});c.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};
var d=void 0;Object.keys(this._streams).forEach(function(c){b._streams[c].getTracks().find(function(b){return a.track===b})&&(d=b._streams[c])});d&&(1===d.getTracks().length?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};e.shimPeerConnection=function(b){var d=l.detectBrowser(b);!b.RTCPeerConnection&&b.webkitRTCPeerConnection&&(b.RTCPeerConnection=b.webkitRTCPeerConnection);if(b.RTCPeerConnection){53>d.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(d){var c=b.RTCPeerConnection.prototype[d],e=a({},d,function(){arguments[0]=new ("addIceCandidate"===d?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)});b.RTCPeerConnection.prototype[d]=e[d]});var c=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>d.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():c.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};e.fixNegotiationNeeded=function(a){l.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};var l=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(g("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(g,f,e){Object.defineProperty(e,"__esModule",
{value:!0});e.shimGetDisplayMedia=function(a,b){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||("function"!==typeof b?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):a.navigator.mediaDevices.getDisplayMedia=function(e){return b(e).then(function(b){var c=e.video&&e.video.width,f=e.video&&e.video.height;e.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b,maxFrameRate:e.video&&e.video.frameRate||3}};c&&
(e.video.mandatory.maxWidth=c);f&&(e.video.mandatory.maxHeight=f);return a.navigator.mediaDevices.getUserMedia(e)})})}},{}],5:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==
Symbol.prototype?"symbol":typeof a};e.shimGetUserMedia=function(c){var e=c&&c.navigator;if(e.mediaDevices){var f=b.detectBrowser(c),h=function(b){if("object"!==("undefined"===typeof b?"undefined":a(b))||b.mandatory||b.optional)return b;var d={};Object.keys(b).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var e="object"===a(b[c])?b[c]:{ideal:b[c]};void 0!==e.exact&&"number"===typeof e.exact&&(e.min=e.max=e.exact);var f=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):
"deviceId"===b?"sourceId":b};if(void 0!==e.ideal){d.optional=d.optional||[];var h={};"number"===typeof e.ideal?(h[f("min",c)]=e.ideal,d.optional.push(h),h={},h[f("max",c)]=e.ideal):h[f("",c)]=e.ideal;d.optional.push(h)}void 0!==e.exact&&"number"!==typeof e.exact?(d.mandatory=d.mandatory||{},d.mandatory[f("",c)]=e.exact):["min","max"].forEach(function(a){void 0!==e[a]&&(d.mandatory=d.mandatory||{},d.mandatory[f(a,c)]=e[a])})}});b.advanced&&(d.optional=(d.optional||[]).concat(b.advanced));return d},
d=function(b,d){if(61<=f.version)return d(b);if((b=JSON.parse(JSON.stringify(b)))&&"object"===a(b.audio)){var c=function(a,b,d){b in a&&!(d in a)&&(a[d]=a[b],delete a[b])};b=JSON.parse(JSON.stringify(b));c(b.audio,"autoGainControl","googAutoGainControl");c(b.audio,"noiseSuppression","googNoiseSuppression");b.audio=h(b.audio)}if(b&&"object"===a(b.video)){var g=b.video.facingMode,g=g&&("object"===("undefined"===typeof g?"undefined":a(g))?g:{ideal:g}),c=66>f.version;if(!(!g||"user"!==g.exact&&"environment"!==
g.exact&&"user"!==g.ideal&&"environment"!==g.ideal||e.mediaDevices.getSupportedConstraints&&e.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete b.video.facingMode;var l=void 0;if("environment"===g.exact||"environment"===g.ideal)l=["back","rear"];else if("user"===g.exact||"user"===g.ideal)l=["front"];if(l)return e.mediaDevices.enumerateDevices().then(function(a){a=a.filter(function(a){return"videoinput"===a.kind});var c=a.find(function(a){return l.some(function(b){return a.label.toLowerCase().includes(b)})});
!c&&a.length&&l.includes("back")&&(c=a[a.length-1]);c&&(b.video.deviceId=g.exact?{exact:c.deviceId}:{ideal:c.deviceId});b.video=h(b.video);m("chrome: "+JSON.stringify(b));return d(b)})}b.video=h(b.video)}m("chrome: "+JSON.stringify(b));return d(b)},g=function(a){return 64<=f.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",
MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};e.getUserMedia=function(a,b,c){d(a,function(a){e.webkitGetUserMedia(a,b,function(a){c&&c(g(a))})})}.bind(e);if(e.mediaDevices.getUserMedia){var k=e.mediaDevices.getUserMedia.bind(e.mediaDevices);
e.mediaDevices.getUserMedia=function(a){return d(a,function(a){return k(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(g(a))})})}}}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(g("../utils.js")),m=b.log},{"../utils.js":15}],
6:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.shimRTCIceCandidate=function(c){if(c.RTCIceCandidate&&!(c.RTCIceCandidate&&"foundation"in
c.RTCIceCandidate.prototype)){var e=c.RTCIceCandidate;c.RTCIceCandidate=function(c){"object"===("undefined"===typeof c?"undefined":a(c))&&c.candidate&&0===c.candidate.indexOf("a\x3d")&&(c=JSON.parse(JSON.stringify(c)),c.candidate=c.candidate.substr(2));if(c.candidate&&c.candidate.length){var f=new e(c);c=b.default.parseCandidate(c.candidate);var d=Object.assign(f,c);d.toJSON=function(){return{candidate:d.candidate,sdpMid:d.sdpMid,sdpMLineIndex:d.sdpMLineIndex,usernameFragment:d.usernameFragment}};
return d}return new e(c)};c.RTCIceCandidate.prototype=e.prototype;m.wrapPeerConnectionEvent(c,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new c.RTCIceCandidate(a.candidate),writable:"false"});return a})}};e.shimMaxMessageSize=function(a){if(a.RTCPeerConnection){var c=m.detectBrowser(a);"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var e=
function(a){if(!a||!a.sdp)return!1;a=b.default.splitSections(a.sdp);a.shift();return a.some(function(a){return(a=b.default.parseMLine(a))&&"application"===a.kind&&-1!==a.protocol.indexOf("SCTP")})},f=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},d=function(a){var b=65536;"firefox"===c.browser&&(b=57>c.version?-1===a?16384:2147483637:60>c.version?57===c.version?65535:65536:2147483637);return b},g=function(a,d){var e=
65536;"firefox"===c.browser&&57===c.version&&(e=65535);a=b.default.matchPrefix(a.sdp,"a\x3dmax-message-size:");0<a.length?e=parseInt(a[0].substr(19),10):"firefox"===c.browser&&-1!==d&&(e=2147483637);return e},k=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;"chrome"===c.browser&&76<=c.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?
null:this._sctp},enumerable:!0,configurable:!0});if(e(arguments[0])){var a=f(arguments[0]),b=d(a),a=g(arguments[0],a),h=void 0,h=0===b&&0===a?Number.POSITIVE_INFINITY:0===b||0===a?Math.max(b,a):Math.min(b,a),b={};Object.defineProperty(b,"maxMessageSize",{get:function(){return h}});this._sctp=b}return k.apply(this,arguments)}}};e.shimSendThrowTypeError=function(a){function b(a,b){var d=a.send;a.send=function(){var c=arguments[0],c=c.length||c.size||c.byteLength;if("open"===a.readyState&&b.sctp&&c>
b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return d.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var c=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=c.apply(this,arguments);b(a,this);return a};m.wrapPeerConnectionEvent(a,"datachannel",function(a){b(a.channel,a.target);return a})}};e.shimConnectionState=function(a){if(a.RTCPeerConnection&&
!("connectionState"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(b,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),
delete this._onconnectionstatechange);a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var c=b[a];b[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var d=new Event("connectionstatechange",a);b.dispatchEvent(d)}return a},this.addEventListener("iceconnectionstatechange",
this._connectionstatechangepoly));return c.apply(this,arguments)}})}};e.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var b=m.detectBrowser(a);if(!("chrome"===b.browser&&71<=b.version)){var c=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na\x3dextmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a\x3dextmap-allow-mixed"!==a.trim()}).join("\n"));return c.apply(this,arguments)}}}};
var b=(f=g("sdp"))&&f.__esModule?f:{default:f},m=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(g("./utils"))},{"./utils":15,sdp:17}],7:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=e.shimGetUserMedia=void 0;var a=g("./getusermedia");Object.defineProperty(e,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}});var b=g("./getdisplaymedia");
Object.defineProperty(e,"shimGetDisplayMedia",{enumerable:!0,get:function(){return b.shimGetDisplayMedia}});e.shimPeerConnection=function(a){var b=m.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=function(a){return a}),15025>b.version)){var d=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){d.set.call(this,
a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var e=(0,k.default)(a,b.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=
(0,c.filterIceServers)(a.iceServers,b.version),m.log("ICE servers after filtering:",a.iceServers));return new e(a)};a.RTCPeerConnection.prototype=e.prototype};e.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};var m=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(g("../utils")),c=g("./filtericeservers"),
k=(g=g("rtcpeerconnection-shim"))&&g.__esModule?g:{default:g}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});e.filterIceServers=function(b,e){var c=!1;b=JSON.parse(JSON.stringify(b));return b.filter(function(b){if(b&&(b.urls||b.url)){var e=b.urls||b.url;b.url&&!b.urls&&a.deprecated("RTCIceServer.url","RTCIceServer.urls");var f="string"===typeof e;f&&(e=[e]);e=e.filter(function(a){return 0===
a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport\x3dudp"))&&!c?c=!0:a&&!c});delete b.url;b.urls=f?e[0]:e;return!!e.length}})};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(g("../utils"))},{"../utils":15}],9:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=function(a){"getDisplayMedia"in a.navigator&&a.navigator.mediaDevices&&
!(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)&&(a.navigator.mediaDevices.getDisplayMedia=a.navigator.getDisplayMedia.bind(a.navigator))}},{}],10:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetUserMedia=function(a){a=a&&a.navigator;var b=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},e=a.mediaDevices.getUserMedia.bind(a.mediaDevices);
a.mediaDevices.getUserMedia=function(a){return e(a).catch(function(a){return Promise.reject(b(a))})}}},{}],11:[function(g,f,e){function a(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=e.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m=g("./getusermedia");Object.defineProperty(e,"shimGetUserMedia",{enumerable:!0,get:function(){return m.shimGetUserMedia}});var c=g("./getdisplaymedia");Object.defineProperty(e,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}});e.shimOnTrack=function(a){"object"===("undefined"===typeof a?"undefined":
b(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};e.shimPeerConnection=function(c){var e=k.detectBrowser(c);if("object"===("undefined"===typeof c?"undefined":b(c))&&(c.RTCPeerConnection||c.mozRTCPeerConnection)){!c.RTCPeerConnection&&c.mozRTCPeerConnection&&(c.RTCPeerConnection=c.mozRTCPeerConnection);53>e.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(b){var d=c.RTCPeerConnection.prototype[b],e=a({},b,function(){arguments[0]=new ("addIceCandidate"===b?c.RTCIceCandidate:c.RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)});c.RTCPeerConnection.prototype[b]=e[b]});if(68>e.version){var d=c.RTCPeerConnection.prototype.addIceCandidate;c.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():d.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var f={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},g=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(){var a=Array.prototype.slice.call(arguments),b=a[1],d=a[2];return g.apply(this,[a[0]||null]).then(function(a){if(53>e.version&&!b)try{a.forEach(function(a){a.type=f[a.type]||a.type})}catch(w){if("TypeError"!==
w.name)throw w;a.forEach(function(b,d){a.set(d,Object.assign({},b,{type:f[b.type]||b.type}))})}return a}).then(b,d)}}};e.shimSenderGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)){var c=a.RTCPeerConnection.prototype.getSenders;c&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var d=a.RTCPeerConnection.prototype.addTrack;
d&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=d.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};e.shimReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)){var c=a.RTCPeerConnection.prototype.getReceivers;c&&(a.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});k.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};e.shimRemoveStream=function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;k.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(d){d.track&&
a.getTracks().includes(d.track)&&b.removeTrack(d)})})};e.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(g("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=function(a,b){a.navigator.mediaDevices&&
"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||(a.navigator.mediaDevices.getDisplayMedia=function(e){if(!e||!e.video)return e=new DOMException("getDisplayMedia without video constraints is undefined"),e.name="NotFoundError",e.code=8,Promise.reject(e);!0===e.video?e.video={mediaSource:b}:e.video.mediaSource=b;return a.navigator.mediaDevices.getUserMedia(e)})}},{}],13:[function(g,f,e){Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.shimGetUserMedia=function(e){var c=b.detectBrowser(e),f=e&&e.navigator;e=e&&e.MediaStreamTrack;f.getUserMedia=function(a,d,c){b.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");
f.mediaDevices.getUserMedia(a).then(d,c)};if(!(55<c.version&&"autoGainControl"in f.mediaDevices.getSupportedConstraints())){var g=function(a,b,d){b in a&&!(d in a)&&(a[d]=a[b],delete a[b])},h=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&"object"===a(b.audio)&&(b=JSON.parse(JSON.stringify(b)),g(b.audio,"autoGainControl","mozAutoGainControl"),g(b.audio,"noiseSuppression","mozNoiseSuppression"));return h(b)};
if(e&&e.prototype.getSettings){var d=e.prototype.getSettings;e.prototype.getSettings=function(){var a=d.apply(this,arguments);g(a,"mozAutoGainControl","autoGainControl");g(a,"mozNoiseSuppression","noiseSuppression");return a}}if(e&&e.prototype.applyConstraints){var k=e.prototype.applyConstraints;e.prototype.applyConstraints=function(b){"audio"===this.kind&&"object"===("undefined"===typeof b?"undefined":a(b))&&(b=JSON.parse(JSON.stringify(b)),g(b,"autoGainControl","mozAutoGainControl"),g(b,"noiseSuppression",
"mozNoiseSuppression"));return k.apply(this,[b])}}}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b.default=a;return b}(g("../utils"))},{"../utils":15}],14:[function(g,f,e){function a(a){return a&&void 0!==a.video?Object.assign({},a,{video:k.compactObject(a.video)}):a}Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&
"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.shimLocalStreamsAPI=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection){"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=
[]);return this._localStreams});if(!("addStream"in a.RTCPeerConnection.prototype)){var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||this._localStreams.push(a);a.getAudioTracks().forEach(function(d){return c.call(b,d,a)});a.getVideoTracks().forEach(function(d){return c.call(b,d,a)})};a.RTCPeerConnection.prototype.addTrack=function(a){var b=arguments[1];b&&(this._localStreams?
this._localStreams.includes(b)||this._localStreams.push(b):this._localStreams=[b]);return c.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);var d=this._localStreams.indexOf(a);if(-1!==d){this._localStreams.splice(d,1);var c=a.getTracks();this.getSenders().forEach(function(a){c.includes(a.track)&&b.removeTrack(a)})}})}};e.shimRemoteStreamsAPI=function(a){if("object"===
("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",
this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){b._remoteStreams||(b._remoteStreams=[]);if(!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var d=new Event("addstream");d.stream=a;b.dispatchEvent(d)}})})}});var c=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",
this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var d=new Event("addstream");d.stream=b;a.dispatchEvent(d)}})});return c.apply(a,arguments)}}};e.shimCallbacksAPI=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var c=a.createOffer,e=a.createAnswer,f=a.setLocalDescription,d=a.setRemoteDescription,g=a.addIceCandidate;
a.createOffer=function(a,b){var d=c.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return d;d.then(a,b);return Promise.resolve()};a.createAnswer=function(a,b){var d=e.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return d;d.then(a,b);return Promise.resolve()};var k=function(a,b,d){a=f.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};a.setLocalDescription=k;k=function(a,b,c){a=d.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};
a.setRemoteDescription=k;k=function(a,b,d){a=g.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};a.addIceCandidate=k}};e.shimGetUserMedia=function(b){var c=b&&b.navigator;if(c.mediaDevices&&c.mediaDevices.getUserMedia){b=c.mediaDevices;var e=b.getUserMedia.bind(b);c.mediaDevices.getUserMedia=function(b){return e(a(b))}}!c.getUserMedia&&c.mediaDevices&&c.mediaDevices.getUserMedia&&(c.getUserMedia=function(a,b,e){c.mediaDevices.getUserMedia(a).then(b,e)}.bind(c))};e.shimConstraints=
a;e.shimRTCIceServerUrls=function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,c){if(a&&a.iceServers){for(var d=[],e=0;e<a.iceServers.length;e++){var f=a.iceServers[e];!f.hasOwnProperty("urls")&&f.hasOwnProperty("url")?(k.deprecated("RTCIceServer.url","RTCIceServer.urls"),f=JSON.parse(JSON.stringify(f)),f.urls=f.url,delete f.url,d.push(f)):d.push(a.iceServers[e])}a.iceServers=d}return new b(a,c)};a.RTCPeerConnection.prototype=b.prototype;"generateCertificate"in a.RTCPeerConnection&&
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})};e.shimTrackEventTransceiver=function(a){"object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};e.shimCreateOfferLegacy=function(a){var b=a.RTCPeerConnection.prototype.createOffer;
a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var c=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):!0!==a.offerToReceiveAudio||c||this.addTransceiver("audio");
"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);c=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):!0!==a.offerToReceiveVideo||c||this.addTransceiver("video")}return b.apply(this,arguments)}};var k=function(a){if(a&&
a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(g("../utils"))},{"../utils":15}],15:[function(g,f,e){function a(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}function b(a,b,c){return(a=a.match(b))&&a.length>=c&&parseInt(a[c],10)}function k(b){return"[object Object]"!==Object.prototype.toString.call(b)?b:Object.keys(b).reduce(function(d,c){var e="[object Object]"===
Object.prototype.toString.call(b[c]),f=e?k(b[c]):b[c],e=e&&!Object.keys(f).length;return void 0===f||e?d:Object.assign(d,a({},c,f))},{})}function c(a,b,e){b&&!e.has(b.id)&&(e.set(b.id,b),Object.keys(b).forEach(function(d){d.endsWith("Id")?c(a,a.get(b[d]),e):d.endsWith("Ids")&&b[d].forEach(function(b){c(a,a.get(b),e)})}))}Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?
function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.extractVersion=b;e.wrapPeerConnectionEvent=function(a,b,c){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var d=a.addEventListener;a.addEventListener=function(a,e){if(a!==b)return d.apply(this,arguments);var f=function(a){(a=c(a))&&e(a)};this._eventMap=this._eventMap||{};this._eventMap[e]=
f;return d.apply(this,[a,f])};var e=a.removeEventListener;a.removeEventListener=function(a,d){if(a!==b||!this._eventMap||!this._eventMap[d])return e.apply(this,arguments);var c=this._eventMap[d];delete this._eventMap[d];return e.apply(this,[a,c])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}};e.disableLog=
function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean."):(l=a)?"adapter.js logging disabled":"adapter.js logging enabled"};e.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean.");h=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};e.log=function(){"object"!==("undefined"===typeof window?"undefined":n(window))||
l||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};e.deprecated=function(a,b){h&&console.warn(a+" is deprecated, please use "+b+" instead.")};e.detectBrowser=function(a){var c=a.navigator,d={browser:null,version:null};if("undefined"===typeof a||!a.navigator)return d.browser="Not a browser.",d;c.mozGetUserMedia?(d.browser="firefox",d.version=b(c.userAgent,/Firefox\/(\d+)\./,1)):c.webkitGetUserMedia||!1===a.isSecureContext&&a.webkitRTCPeerConnection&&
!a.RTCIceGatherer?(d.browser="chrome",d.version=b(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):c.mediaDevices&&c.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.browser="edge",d.version=b(c.userAgent,/Edge\/(\d+).(\d+)$/,2)):a.RTCPeerConnection&&c.userAgent.match(/AppleWebKit\/(\d+)\./)?(d.browser="safari",d.version=b(c.userAgent,/AppleWebKit\/(\d+)\./,1),d.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype):d.browser="Not a supported browser.";return d};e.compactObject=
k;e.walkStats=c;e.filterStats=function(a,b,e){var d=e?"outbound-rtp":"inbound-rtp",f=new Map;if(null===b)return f;var g=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&g.push(a)});g.forEach(function(b){a.forEach(function(e){e.type===d&&e.trackId===b.id&&c(a,e,f)})});return f};var l=!0,h=!0},{}],16:[function(g,f,e){function a(a,b,c,e,f){b=h.writeRtpDescription(a.kind,b);b+=h.writeIceParameters(a.iceGatherer.getLocalParameters());b+=h.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),
"offer"===c?"actpass":f||"active");b+="a\x3dmid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?b+"a\x3dsendrecv\r\n":a.rtpSender?b+"a\x3dsendonly\r\n":a.rtpReceiver?b+"a\x3drecvonly\r\n":b+"a\x3dinactive\r\n";a.rtpSender&&(c=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=c,e="msid:"+(e?e.id:"-")+" "+c+"\r\n",b=b+("a\x3d"+e)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" "+e),a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,
b+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+h.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+h.localCName+"\r\n");return b}function b(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");
var e="string"===typeof d;e&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport\x3dudp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport\x3dudp"):c=!0});delete a.url;a.urls=e?d[0]:d;return!!d.length}})}function k(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},e=function(a,b,c,e){a=
d(a.parameters.apt,c);b=d(b.parameters.apt,e);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(d){for(var f=0;f<b.codecs.length;f++){var g=b.codecs[f];if(d.name.toLowerCase()===g.name.toLowerCase()&&d.clockRate===g.clockRate&&("rtx"!==d.name.toLowerCase()||!d.parameters||!g.parameters.apt||e(d,g,a.codecs,b.codecs))){g=JSON.parse(JSON.stringify(g));g.numChannels=Math.min(d.numChannels,g.numChannels);c.codecs.push(g);g.rtcpFeedback=g.rtcpFeedback.filter(function(a){for(var b=
0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var e=b.headerExtensions[d];if(a.uri===e.uri){c.headerExtensions.push(e);break}}});return c}function c(a,b,c){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer",
"have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)}function n(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});c||a.addRemoteCandidate(b);return!c}function l(a,b){b=Error(b);b.name=a;b.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var h=
g("sdp");f.exports=function(d,e){function f(a,b){b.addTrack(a);b.dispatchEvent(new d.MediaStreamTrackEvent("addtrack",{track:a}))}function g(a,b){b.removeTrack(a);b.dispatchEvent(new d.MediaStreamTrackEvent("removetrack",{track:a}))}function m(a,b,c,e){var f=new Event("track");f.track=b;f.receiver=c;f.transceiver={receiver:c};f.streams=e;d.setTimeout(function(){a._dispatchEvent("track",f)})}var q=function(a){var c=this,f=document.createDocumentFragment();["addEventListener","removeEventListener",
"dispatchEvent"].forEach(function(a){c[a]=f[a].bind(f)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";a=JSON.parse(JSON.stringify(a||{}));this.usingBundle="max-bundle"===a.bundlePolicy;if("negotiate"===a.rtcpMuxPolicy)throw l("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");
a.rtcpMuxPolicy||(a.rtcpMuxPolicy="require");switch(a.iceTransportPolicy){case "all":case "relay":break;default:a.iceTransportPolicy="all"}switch(a.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:a.bundlePolicy="balanced"}a.iceServers=b(a.iceServers||[],e);this._iceGatherers=[];if(a.iceCandidatePoolSize)for(var g=a.iceCandidatePoolSize;0<g;g--)this._iceGatherers.push(new d.RTCIceGatherer({iceServers:a.iceServers,gatherPolicy:a.iceTransportPolicy}));else a.iceCandidatePoolSize=
0;this._config=a;this.transceivers=[];this._sdpSessionId=h.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(q.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(q.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});q.prototype.onicecandidate=null;q.prototype.onaddstream=null;q.prototype.ontrack=null;q.prototype.onremovestream=null;
q.prototype.onsignalingstatechange=null;q.prototype.oniceconnectionstatechange=null;q.prototype.onconnectionstatechange=null;q.prototype.onicegatheringstatechange=null;q.prototype.onnegotiationneeded=null;q.prototype.ondatachannel=null;q.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};q.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",
a)};q.prototype.getConfiguration=function(){return this._config};q.prototype.getLocalStreams=function(){return this.localStreams};q.prototype.getRemoteStreams=function(){return this.remoteStreams};q.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,
associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);return a};q.prototype.addTrack=function(a,b){if(this._isClosed)throw l("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===
a}))throw l("InvalidAccessError","Track already exists.");for(var c,e=0;e<this.transceivers.length;e++)this.transceivers[e].track||this.transceivers[e].kind!==a.kind||(c=this.transceivers[e]);c||(c=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(b)&&this.localStreams.push(b);c.track=a;c.stream=b;c.rtpSender=new d.RTCRtpSender(a,c.dtlsTransport);return c.rtpSender};q.prototype.addStream=function(a){var b=this;if(15025<=e)a.getTracks().forEach(function(c){b.addTrack(c,
a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};q.prototype.removeTrack=function(a){if(this._isClosed)throw l("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof d.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===
a});if(!b)throw l("InvalidAccessError","Sender was not created by this connection.");var c=b.stream;b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(c)&&-1<this.localStreams.indexOf(c)&&this.localStreams.splice(this.localStreams.indexOf(c),1);this._maybeFireNegotiationNeeded()};q.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&
b.removeTrack(c)})};q.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};q.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};q.prototype._createIceGatherer=function(a,b){var c=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var e=new d.RTCIceGatherer({iceServers:this._config.iceServers,
gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(e,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var d=!b.candidate||0===Object.keys(b.candidate).length;e.state=d?"completed":"gathering";null!==c.transceivers[a].bufferedCandidateEvents&&c.transceivers[a].bufferedCandidateEvents.push(b)};e.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return e};q.prototype._gather=function(a,
b){var c=this,e=this.transceivers[b].iceGatherer;if(!e.onlocalcandidate){var f=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null;e.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);e.onlocalcandidate=function(d){if(!(c.usingBundle&&0<b)){var f=new Event("icecandidate");f.candidate={sdpMid:a,sdpMLineIndex:b};var g=d.candidate;if(d=!g||0===Object.keys(g).length){if("new"===e.state||"gathering"===e.state)e.state="completed"}else"new"===
e.state&&(e.state="gathering"),g.component=1,g.ufrag=e.getLocalParameters().usernameFragment,g=h.writeCandidate(g),f.candidate=Object.assign(f.candidate,h.parseCandidate(g)),f.candidate.candidate=g,f.candidate.toJSON=function(){return{candidate:f.candidate.candidate,sdpMid:f.candidate.sdpMid,sdpMLineIndex:f.candidate.sdpMLineIndex,usernameFragment:f.candidate.usernameFragment}};g=h.getMediaSections(c._localDescription.sdp);g[f.candidate.sdpMLineIndex]=d?g[f.candidate.sdpMLineIndex]+"a\x3dend-of-candidates\r\n":
g[f.candidate.sdpMLineIndex]+("a\x3d"+f.candidate.candidate+"\r\n");c._localDescription.sdp=h.getDescription(c._localDescription.sdp)+g.join("");g=c.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==c.iceGatheringState&&(c.iceGatheringState="gathering",c._emitGatheringStateChange());d||c._dispatchEvent("icecandidate",f);g&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}};
d.setTimeout(function(){f.forEach(function(a){e.onlocalcandidate(a)})},0)}};q.prototype._createIceAndDtlsTransports=function(){var a=this,b=new d.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var c=new d.RTCDtlsTransport(b);c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};q.prototype._disposeIceAndDtlsTransports=
function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};q.prototype._transceive=function(a,b,c){var d=k(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(d.encodings=a.sendEncodingParameters,d.rtcp=
{cname:h.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(d.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(d));c&&a.rtpReceiver&&0<d.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>e&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),d.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],d.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(d.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&
(d.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(d))};q.prototype.setLocalDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(l("TypeError",'Unsupported type "'+a.type+'"'));if(!c("setLocalDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(l("InvalidStateError","Can not set local "+a.type+" in state "+b.signalingState));if("offer"===a.type){var d=h.splitSections(a.sdp);var e=d.shift();d.forEach(function(a,c){a=
h.parseRtpParameters(a);b.transceivers[c].localCapabilities=a});b.transceivers.forEach(function(a,c){b._gather(a.mid,c)})}else if("answer"===a.type){d=h.splitSections(b._remoteDescription.sdp);e=d.shift();var f=0<h.matchPrefix(e,"a\x3dice-lite").length;d.forEach(function(a,c){var d=b.transceivers[c],g=d.iceGatherer,m=d.iceTransport,l=d.dtlsTransport,n=d.localCapabilities,p=d.remoteCapabilities;if(!(h.isRejected(a)&&0===h.matchPrefix(a,"a\x3dbundle-only").length||d.rejected)){var q=h.getIceParameters(a,
e);a=h.getDtlsParameters(a,e);f&&(a.role="server");b.usingBundle&&0!==c||(b._gather(d.mid,c),"new"===m.state&&m.start(g,q,f?"controlling":"controlled"),"new"===l.state&&l.start(a));c=k(n,p);b._transceive(d,0<c.codecs.length,!1)}})}b._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-local-offer"):b._updateSignalingState("stable");return Promise.resolve()};q.prototype.setRemoteDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(l("TypeError",
'Unsupported type "'+a.type+'"'));if(!c("setRemoteDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(l("InvalidStateError","Can not set remote "+a.type+" in state "+b.signalingState));var p={};b.remoteStreams.forEach(function(a){p[a.id]=a});var q=[],r=h.splitSections(a.sdp),w=r.shift(),t=0<h.matchPrefix(w,"a\x3dice-lite").length,u=0<h.matchPrefix(w,"a\x3dgroup:BUNDLE ").length;b.usingBundle=u;var v=h.matchPrefix(w,"a\x3dice-options:")[0];b.canTrickleIceCandidates=v?0<=v.substr(14).split(" ").indexOf("trickle"):
!1;r.forEach(function(c,m){var l=h.splitLines(c),r=h.getKind(c),A=h.isRejected(c)&&0===h.matchPrefix(c,"a\x3dbundle-only").length,y=l[0].substr(2).split(" ")[2],l=h.getDirection(c,w),z=h.parseMsid(c),v=h.getMid(c)||h.generateIdentifier();if(A||"application"===r&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))b.transceivers[m]={mid:v,kind:r,protocol:y,rejected:!0};else{!A&&b.transceivers[m]&&b.transceivers[m].rejected&&(b.transceivers[m]=b._createTransceiver(r,!0));var x=h.parseRtpParameters(c);if(!A){var C=
h.getIceParameters(c,w);var G=h.getDtlsParameters(c,w);G.role="client"}var y=h.parseRtpEncodingParameters(c),H=h.parseRtcpParameters(c),I=0<h.matchPrefix(c,"a\x3dend-of-candidates",w).length,F=h.matchPrefix(c,"a\x3dcandidate:").map(function(a){return h.parseCandidate(a)}).filter(function(a){return 1===a.component});("offer"===a.type||"answer"===a.type)&&!A&&u&&0<m&&b.transceivers[m]&&(b._disposeIceAndDtlsTransports(m),b.transceivers[m].iceGatherer=b.transceivers[0].iceGatherer,b.transceivers[m].iceTransport=
b.transceivers[0].iceTransport,b.transceivers[m].dtlsTransport=b.transceivers[0].dtlsTransport,b.transceivers[m].rtpSender&&b.transceivers[m].rtpSender.setTransport(b.transceivers[0].dtlsTransport),b.transceivers[m].rtpReceiver&&b.transceivers[m].rtpReceiver.setTransport(b.transceivers[0].dtlsTransport));if("offer"!==a.type||A)"answer"!==a.type||A||(B=b.transceivers[m],D=B.iceGatherer,r=B.iceTransport,v=B.dtlsTransport,E=B.rtpReceiver,A=B.sendEncodingParameters,c=B.localCapabilities,b.transceivers[m].recvEncodingParameters=
y,b.transceivers[m].remoteCapabilities=x,b.transceivers[m].rtcpParameters=H,F.length&&"new"===r.state&&(!t&&!I||u&&0!==m?F.forEach(function(a){n(B.iceTransport,a)}):r.setRemoteCandidates(F)),u&&0!==m||("new"===r.state&&r.start(D,C,"controlling"),"new"===v.state&&v.start(G)),!k(B.localCapabilities,B.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&B.sendEncodingParameters[0].rtx&&delete B.sendEncodingParameters[0].rtx,b._transceive(B,"sendrecv"===l||"recvonly"===
l,"sendrecv"===l||"sendonly"===l),!E||"sendrecv"!==l&&"sendonly"!==l?delete B.rtpReceiver:(l=E.track,z?(p[z.stream]||(p[z.stream]=new d.MediaStream),f(l,p[z.stream]),q.push([l,E,p[z.stream]])):(p.default||(p.default=new d.MediaStream),f(l,p.default),q.push([l,E,p.default]))));else{var B=b.transceivers[m]||b._createTransceiver(r);B.mid=v;B.iceGatherer||(B.iceGatherer=b._createIceGatherer(m,u));F.length&&"new"===B.iceTransport.state&&(!I||u&&0!==m?F.forEach(function(a){n(B.iceTransport,a)}):B.iceTransport.setRemoteCandidates(F));
c=d.RTCRtpReceiver.getCapabilities(r);15019>e&&(c.codecs=c.codecs.filter(function(a){return"rtx"!==a.name}));A=B.sendEncodingParameters||[{ssrc:1001*(2*m+2)}];C=!1;if("sendrecv"===l||"sendonly"===l){C=!B.rtpReceiver;var E=B.rtpReceiver||new d.RTCRtpReceiver(B.dtlsTransport,r);if(C){l=E.track;if(!z||"-"!==z.stream)if(z){p[z.stream]||(p[z.stream]=new d.MediaStream,Object.defineProperty(p[z.stream],"id",{get:function(){return z.stream}}));Object.defineProperty(l,"id",{get:function(){return z.track}});
var D=p[z.stream]}else p.default||(p.default=new d.MediaStream),D=p.default;D&&(f(l,D),B.associatedRemoteMediaStreams.push(D));q.push([l,E,D])}}else B.rtpReceiver&&B.rtpReceiver.track&&(B.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===B.rtpReceiver.track.id});b&&g(b,a)}),B.associatedRemoteMediaStreams=[]);B.localCapabilities=c;B.remoteCapabilities=x;B.rtpReceiver=E;B.rtcpParameters=H;B.sendEncodingParameters=A;B.recvEncodingParameters=y;b._transceive(b.transceivers[m],
!1,C)}}});void 0===b._dtlsRole&&(b._dtlsRole="offer"===a.type?"active":"passive");b._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-remote-offer"):b._updateSignalingState("stable");Object.keys(p).forEach(function(a){var c=p[a];if(c.getTracks().length){if(-1===b.remoteStreams.indexOf(c)){b.remoteStreams.push(c);var e=new Event("addstream");e.stream=c;d.setTimeout(function(){b._dispatchEvent("addstream",e)})}q.forEach(function(a){c.id===a[2].id&&m(b,a[0],a[1],
[c])})}});q.forEach(function(a){a[2]||m(b,a[0],a[1],[])});d.setTimeout(function(){b&&b.transceivers&&b.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};q.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();
a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};q.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};q.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,d.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=
!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};q.prototype._updateIceConnectionState=function(){var a={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&
(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};q.prototype._updateConnectionState=function(){var a={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":
0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};q.prototype.createOffer=function(b){var c=this;if(c._isClosed)return Promise.reject(l("InvalidStateError","Can not call createOffer after close"));var f=c.transceivers.filter(function(a){return"audio"===a.kind}).length,g=c.transceivers.filter(function(a){return"video"===a.kind}).length;if(b){if(b.mandatory||b.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==b.offerToReceiveAudio&&(f=!0===b.offerToReceiveAudio?1:!1===b.offerToReceiveAudio?0:b.offerToReceiveAudio);void 0!==b.offerToReceiveVideo&&(g=!0===b.offerToReceiveVideo?1:!1===b.offerToReceiveVideo?0:b.offerToReceiveVideo)}for(c.transceivers.forEach(function(a){"audio"===a.kind?(f--,0>f&&(a.wantReceive=!1)):"video"===a.kind&&(g--,0>g&&(a.wantReceive=!1))});0<f||0<g;)0<f&&(c._createTransceiver("audio"),f--),0<g&&(c._createTransceiver("video"),g--);var k=h.writeSessionBoilerplate(c._sdpSessionId,
c._sdpSessionVersion++);c.transceivers.forEach(function(a,b){var f=a.track,g=a.kind,k=a.mid||h.generateIdentifier();a.mid=k;a.iceGatherer||(a.iceGatherer=c._createIceGatherer(b,c.usingBundle));k=d.RTCRtpSender.getCapabilities(g);15019>e&&(k.codecs=k.codecs.filter(function(a){return"rtx"!==a.name}));k.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===
a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});k.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&(b.id=a.id)})});b=a.sendEncodingParameters||[{ssrc:1001*(2*b+1)}];f&&15019<=e&&"video"===g&&!b[0].rtx&&(b[0].rtx={ssrc:b[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new d.RTCRtpReceiver(a.dtlsTransport,g));a.localCapabilities=k;a.sendEncodingParameters=b});"max-compat"!==
c._config.bundlePolicy&&(k+="a\x3dgroup:BUNDLE "+c.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");k+="a\x3dice-options:trickle\r\n";c.transceivers.forEach(function(b,d){k+=a(b,b.localCapabilities,"offer",b.stream,c._dtlsRole);k+="a\x3drtcp-rsize\r\n";!b.iceGatherer||"new"===c.iceGatheringState||0!==d&&c.usingBundle||(b.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;k+="a\x3d"+h.writeCandidate(a)+"\r\n"}),"completed"===b.iceGatherer.state&&(k+="a\x3dend-of-candidates\r\n"))});
b=new d.RTCSessionDescription({type:"offer",sdp:k});return Promise.resolve(b)};q.prototype.createAnswer=function(){var b=this;if(b._isClosed)return Promise.reject(l("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==b.signalingState&&"have-local-pranswer"!==b.signalingState)return Promise.reject(l("InvalidStateError","Can not call createAnswer in signalingState "+b.signalingState));var c=h.writeSessionBoilerplate(b._sdpSessionId,b._sdpSessionVersion++);b.usingBundle&&
(c+="a\x3dgroup:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var c=c+"a\x3dice-options:trickle\r\n",f=h.getMediaSections(b._remoteDescription.sdp).length;b.transceivers.forEach(function(d,g){if(!(g+1>f))if(d.rejected)"application"===d.kind?c="DTLS/SCTP"===d.protocol?c+"m\x3dapplication 0 DTLS/SCTP 5000\r\n":c+("m\x3dapplication 0 "+d.protocol+" webrtc-datachannel\r\n"):"audio"===d.kind?c+="m\x3daudio 0 UDP/TLS/RTP/SAVPF 0\r\na\x3drtpmap:0 PCMU/8000\r\n":"video"===d.kind&&
(c+="m\x3dvideo 0 UDP/TLS/RTP/SAVPF 120\r\na\x3drtpmap:120 VP8/90000\r\n"),c+="c\x3dIN IP4 0.0.0.0\r\na\x3dinactive\r\na\x3dmid:"+d.mid+"\r\n";else{if(d.stream){var h;"audio"===d.kind?h=d.stream.getAudioTracks()[0]:"video"===d.kind&&(h=d.stream.getVideoTracks()[0]);h&&15019<=e&&"video"===d.kind&&!d.sendEncodingParameters[0].rtx&&(d.sendEncodingParameters[0].rtx={ssrc:d.sendEncodingParameters[0].ssrc+1})}g=k(d.localCapabilities,d.remoteCapabilities);!g.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&
d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx;c+=a(d,g,"answer",d.stream,b._dtlsRole);d.rtcpParameters&&d.rtcpParameters.reducedSize&&(c+="a\x3drtcp-rsize\r\n")}});var g=new d.RTCSessionDescription({type:"answer",sdp:c});return Promise.resolve(g)};q.prototype.addIceCandidate=function(a){var b=this,c;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(d,e){if(b._remoteDescription)if(a&&""!==a.candidate){var f=
a.sdpMLineIndex;if(a.sdpMid)for(var g=0;g<b.transceivers.length;g++)if(b.transceivers[g].mid===a.sdpMid){f=g;break}var k=b.transceivers[f];if(k){if(k.rejected)return d();g=0<Object.keys(a.candidate).length?h.parseCandidate(a.candidate):{};if("tcp"===g.protocol&&(0===g.port||9===g.port)||g.component&&1!==g.component)return d();if((0===f||0<f&&k.iceTransport!==b.transceivers[0].iceTransport)&&!n(k.iceTransport,g))return e(l("OperationError","Can not add ICE candidate"));e=a.candidate.trim();0===e.indexOf("a\x3d")&&
(e=e.substr(2));c=h.getMediaSections(b._remoteDescription.sdp);c[f]+="a\x3d"+(g.type?e:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=h.getDescription(b._remoteDescription.sdp)+c.join("")}else return e(l("OperationError","Can not add ICE candidate"))}else for(f=0;f<b.transceivers.length&&(b.transceivers[f].rejected||(b.transceivers[f].iceTransport.addRemoteCandidate({}),c=h.getMediaSections(b._remoteDescription.sdp),c[f]+="a\x3dend-of-candidates\r\n",b._remoteDescription.sdp=h.getDescription(b._remoteDescription.sdp)+
c.join(""),!b.usingBundle));f++);else return e(l("InvalidStateError","Can not add ICE candidate without a remote description"));d()})};q.prototype.getStats=function(a){if(a&&a instanceof d.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw l("InvalidAccessError","Invalid selector.");return b.getStats()}var c=[];this.transceivers.forEach(function(a){["rtpSender",
"rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&c.push(a[b].getStats())})});return Promise.all(c).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=d[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;
Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var r=["createOffer","createAnswer"];r.forEach(function(a){var b=q.prototype[a];q.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&
a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}});r=["setLocalDescription","setRemoteDescription","addIceCandidate"];r.forEach(function(a){var b=q.prototype[a];q.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=
q.prototype[a];q.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return q}},{sdp:17}],17:[function(g,f,e){var a={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};a.localCName=a.generateIdentifier();a.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};a.splitSections=function(a){return a.split("\nm\x3d").map(function(a,
b){return(0<b?"m\x3d"+a:a).trim()+"\r\n"})};a.getDescription=function(b){return(b=a.splitSections(b))&&b[0]};a.getMediaSections=function(b){b=a.splitSections(b);b.shift();return b};a.matchPrefix=function(b,e){return a.splitLines(b).filter(function(a){return 0===a.indexOf(e)})};a.parseCandidate=function(a){a=0===a.indexOf("a\x3dcandidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],
10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},c=8;c<a.length;c+=2)switch(a[c]){case "raddr":b.relatedAddress=a[c+1];break;case "rport":b.relatedPort=parseInt(a[c+1],10);break;case "tcptype":b.tcpType=a[c+1];break;case "ufrag":b.ufrag=a[c+1];b.usernameFragment=a[c+1];break;default:b[a[c]]=a[c+1]}return b};a.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var c=a.type;
b.push("typ");b.push(c);"host"!==c&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));if(a.usernameFragment||a.ufrag)b.push("ufrag"),b.push(a.usernameFragment||a.ufrag);return"candidate:"+b.join(" ")};a.parseIceOptions=function(a){return a.substr(14).split(" ")};a.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};
a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],10);b.channels=3===a.length?parseInt(a[2],10):1;b.numChannels=b.channels;return b};a.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var c=a.channels||a.numChannels||1;return"a\x3drtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==c?"/"+c:"")+"\r\n"};a.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};
a.writeExtmap=function(a){return"a\x3dextmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};a.parseFmtp=function(a){for(var b={},c=a.substr(a.indexOf(" ")+1).split(";"),e=0;e<c.length;e++)a=c[e].trim().split("\x3d"),b[a[0].trim()]=a[1];return b};a.writeFmtp=function(a){var b="",c=a.payloadType;void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var e=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?
e.push(b+"\x3d"+a.parameters[b]):e.push(b)});b+="a\x3dfmtp:"+c+" "+e.join(";")+"\r\n"}return b};a.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};a.writeRtcpFb=function(a){var b="",c=a.payloadType;void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a\x3drtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};a.parseSsrcMedia=
function(a){var b=a.indexOf(" "),c={ssrc:parseInt(a.substr(7,b-7),10)},e=a.indexOf(":",b);-1<e?(c.attribute=a.substr(b+1,e-b-1),c.value=a.substr(e+1)):c.attribute=a.substr(b+1);return c};a.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};a.getMid=function(b){if(b=a.matchPrefix(b,"a\x3dmid:")[0])return b.substr(6)};a.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};
a.getDtlsParameters=function(b,e){return{role:"auto",fingerprints:a.matchPrefix(b+e,"a\x3dfingerprint:").map(a.parseFingerprint)}};a.writeDtlsParameters=function(a,e){var b="a\x3dsetup:"+e+"\r\n";a.fingerprints.forEach(function(a){b+="a\x3dfingerprint:"+a.algorithm+" "+a.value+"\r\n"});return b};a.getIceParameters=function(b,e){b=a.splitLines(b);b=b.concat(a.splitLines(e));return{usernameFragment:b.filter(function(a){return 0===a.indexOf("a\x3dice-ufrag:")})[0].substr(12),password:b.filter(function(a){return 0===
a.indexOf("a\x3dice-pwd:")})[0].substr(10)}};a.writeIceParameters=function(a){return"a\x3dice-ufrag:"+a.usernameFragment+"\r\na\x3dice-pwd:"+a.password+"\r\n"};a.parseRtpParameters=function(b){for(var e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=a.splitLines(b)[0].split(" "),f=3;f<c.length;f++){var g=c[f],h=a.matchPrefix(b,"a\x3drtpmap:"+g+" ")[0];if(h){var h=a.parseRtpMap(h),d=a.matchPrefix(b,"a\x3dfmtp:"+g+" ");h.parameters=d.length?a.parseFmtp(d[0]):{};h.rtcpFeedback=a.matchPrefix(b,
"a\x3drtcp-fb:"+g+" ").map(a.parseRtcpFb);e.codecs.push(h);switch(h.name.toUpperCase()){case "RED":case "ULPFEC":e.fecMechanisms.push(h.name.toUpperCase())}}}a.matchPrefix(b,"a\x3dextmap:").forEach(function(b){e.headerExtensions.push(a.parseExtmap(b))});return e};a.writeRtpDescription=function(b,e){var c="",c=c+("m\x3d"+b+" "),c=c+(0<e.codecs.length?"9":"0"),c=c+" UDP/TLS/RTP/SAVPF ",c=c+(e.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+
"\r\n"),c=c+"c\x3dIN IP4 0.0.0.0\r\n",c=c+"a\x3drtcp:9 IN IP4 0.0.0.0\r\n";e.codecs.forEach(function(b){c+=a.writeRtpMap(b);c+=a.writeFmtp(b);c+=a.writeRtcpFb(b)});var f=0;e.codecs.forEach(function(a){a.maxptime>f&&(f=a.maxptime)});0<f&&(c+="a\x3dmaxptime:"+f+"\r\n");c+="a\x3drtcp-mux\r\n";e.headerExtensions&&e.headerExtensions.forEach(function(b){c+=a.writeExtmap(b)});return c};a.parseRtpEncodingParameters=function(b){var e=[],c=a.parseRtpParameters(b),f=-1!==c.fecMechanisms.indexOf("RED"),g=-1!==
c.fecMechanisms.indexOf("ULPFEC"),h=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"cname"===a.attribute}),d=0<h.length&&h[0].ssrc,k,h=a.matchPrefix(b,"a\x3dssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,10)})});0<h.length&&1<h[0].length&&h[0][0]===d&&(k=h[0][1]);c.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:d,codecPayloadType:parseInt(a.parameters.apt,10)},
d&&k&&(a.rtx={ssrc:k}),e.push(a),f&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:d,mechanism:g?"red+ulpfec":"red"},e.push(a)))});0===e.length&&d&&e.push({ssrc:d});var n=a.matchPrefix(b,"b\x3d");n.length&&(n=0===n[0].indexOf("b\x3dTIAS:")?parseInt(n[0].substr(7),10):0===n[0].indexOf("b\x3dAS:")?950*parseInt(n[0].substr(5),10)-16E3:void 0,e.forEach(function(a){a.maxBitrate=n}));return e};a.parseRtcpParameters=function(b){var e={},c=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"cname"===
a.attribute})[0];c&&(e.cname=c.value,e.ssrc=c.ssrc);c=a.matchPrefix(b,"a\x3drtcp-rsize");e.reducedSize=0<c.length;e.compound=0===c.length;b=a.matchPrefix(b,"a\x3drtcp-mux");e.mux=0<b.length;return e};a.parseMsid=function(b){var e=a.matchPrefix(b,"a\x3dmsid:");if(1===e.length)return b=e[0].substr(7).split(" "),{stream:b[0],track:b[1]};b=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"msid"===a.attribute});if(0<b.length)return b=b[0].value.split(" "),
{stream:b[0],track:b[1]}};a.generateSessionId=function(){return Math.random().toString().substr(2,21)};a.writeSessionBoilerplate=function(b,e,c){e=void 0!==e?e:2;b=b?b:a.generateSessionId();return"v\x3d0\r\no\x3d"+(c||"thisisadapterortc")+" "+b+" "+e+" IN IP4 127.0.0.1\r\ns\x3d-\r\nt\x3d0 0\r\n"};a.writeMediaSection=function(b,e,c,f){e=a.writeRtpDescription(b.kind,e);e+=a.writeIceParameters(b.iceGatherer.getLocalParameters());e+=a.writeDtlsParameters(b.dtlsTransport.getLocalParameters(),"offer"===
c?"actpass":"active");e+="a\x3dmid:"+b.mid+"\r\n";e=b.direction?e+("a\x3d"+b.direction+"\r\n"):b.rtpSender&&b.rtpReceiver?e+"a\x3dsendrecv\r\n":b.rtpSender?e+"a\x3dsendonly\r\n":b.rtpReceiver?e+"a\x3drecvonly\r\n":e+"a\x3dinactive\r\n";b.rtpSender&&(c="msid:"+f.id+" "+b.rtpSender.track.id+"\r\n",e=e+("a\x3d"+c)+("a\x3dssrc:"+b.sendEncodingParameters[0].ssrc+" "+c),b.sendEncodingParameters[0].rtx&&(e+="a\x3dssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" "+c,e+="a\x3dssrc-group:FID "+b.sendEncodingParameters[0].ssrc+
" "+b.sendEncodingParameters[0].rtx.ssrc+"\r\n"));e+="a\x3dssrc:"+b.sendEncodingParameters[0].ssrc+" cname:"+a.localCName+"\r\n";b.rtpSender&&b.sendEncodingParameters[0].rtx&&(e+="a\x3dssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" cname:"+a.localCName+"\r\n");return e};a.getDirection=function(b,e){b=a.splitLines(b);for(var c=0;c<b.length;c++)switch(b[c]){case "a\x3dsendrecv":case "a\x3dsendonly":case "a\x3drecvonly":case "a\x3dinactive":return b[c].substr(2)}return e?a.getDirection(e):"sendrecv"};
a.getKind=function(b){return a.splitLines(b)[0].split(" ")[0].substr(2)};a.isRejected=function(a){return"0"===a.split(" ",2)[1]};a.parseMLine=function(b){b=a.splitLines(b)[0].substr(2).split(" ");return{kind:b[0],port:parseInt(b[1],10),protocol:b[2],fmt:b.slice(3).join(" ")}};a.parseOLine=function(b){b=a.matchPrefix(b,"o\x3d")[0].substr(2).split(" ");return{username:b[0],sessionId:b[1],sessionVersion:parseInt(b[2],10),netType:b[3],addressType:b[4],address:b[5]}};a.isValidSDP=function(b){if("string"!==
typeof b||0===b.length)return!1;b=a.splitLines(b);for(var e=0;e<b.length;e++)if(2>b[e].length||"\x3d"!==b[e].charAt(1))return!1;return!0};"object"===typeof f&&(f.exports=a)},{}]},{},[1])(1)}()},function(n,r,k){k(53)(k(54))},function(n,r){n.exports=function(k){function g(f){"undefined"!==typeof console&&(console.error||console.log)("[Script Loader]",f)}try{"undefined"!==typeof execScript&&"undefined"!==typeof attachEvent&&"undefined"===typeof addEventListener?execScript(k):"undefined"!==typeof eval?
eval.call(null,k):g("EvalError: No eval function available")}catch(f){g(f)}}},function(n,r){n.exports="/* globals $$, jQuery, Elements, document, window, L */\n\n/**\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\n* directory of this distribution and at\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\n*/\nthis.L \x3d this.L || {};\n\n/**\n * @param {HTMLElement} element\n * @param {String}      prop\n * @returns {String|Number}\n */\nL.GetComputedStyle \x3d (computedElement, prop) \x3d\x3e {\n  if (computedElement.currentStyle) {\n    return computedElement.currentStyle[prop];\n  } else if (window.getComputedStyle) {\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\n  }\n  return computedElement.style[prop];\n};\n\n  /**\n   *\n   * @type {Function}\n   * @constructor\n   */\nL.ElementQueries \x3d function ElementQueries() {\n      /**\n       *\n       * @param element\n       * @returns {Number}\n       */\n  function getEmSize(element \x3d document.documentElement) {\n    const fontSize \x3d L.GetComputedStyle(element, 'fontSize');\n    return parseFloat(fontSize) || 16;\n  }\n\n      /**\n       *\n       * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\n       *\n       * @param element\n       * @param value\n       * @param units\n       * @returns {*}\n       */\n  function convertToPx(element, originalValue) {\n    let vh;\n    let vw;\n    let chooser;\n    const units \x3d originalValue.replace(/[0-9]*/, '');\n    const value \x3d parseFloat(originalValue);\n    switch (units) {\n      case 'px':\n        return value;\n      case 'em':\n        return value * getEmSize(element);\n      case 'rem':\n        return value * getEmSize();\n              // Viewport units!\n              // According to http://quirksmode.org/mobile/tableViewport.html\n              // documentElement.clientWidth/Height gets us the most reliable info\n      case 'vw':\n        return (value * document.documentElement.clientWidth) / 100;\n      case 'vh':\n        return (value * document.documentElement.clientHeight) / 100;\n      case 'vmin':\n      case 'vmax':\n        vw \x3d document.documentElement.clientWidth / 100;\n        vh \x3d document.documentElement.clientHeight / 100;\n        chooser \x3d Math[units \x3d\x3d\x3d 'vmin' ? 'min' : 'max'];\n        return value * chooser(vw, vh);\n      default:\n        return value;\n              // for now, not supporting physical units (since they are just a set number of px)\n              // or ex/ch (getting accurate measurements is hard)\n    }\n  }\n\n      /**\n       *\n       * @param {HTMLElement} element\n       * @constructor\n       */\n  function SetupInformation(element) {\n    this.element \x3d element;\n    this.options \x3d [];\n    let i;\n    let j;\n    let option;\n    let width \x3d 0;\n    let height \x3d 0;\n    let value;\n    let actualValue;\n    let attrValues;\n    let attrValue;\n    let attrName;\n\n          /**\n           * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\n           */\n    this.addOption \x3d (newOption) \x3d\x3e {\n      this.options.push(newOption);\n    };\n\n    const attributes \x3d ['min-width', 'min-height', 'max-width', 'max-height'];\n\n          /**\n           * Extracts the computed width/height and sets to min/max- attribute.\n           */\n    this.call \x3d () \x3d\x3e {\n              // extract current dimensions\n      width \x3d this.element.offsetWidth;\n      height \x3d this.element.offsetHeight;\n\n      attrValues \x3d {};\n\n      for (i \x3d 0, j \x3d this.options.length; i \x3c j; i +\x3d 1) {\n        option \x3d this.options[i];\n        value \x3d convertToPx(this.element, option.value);\n\n        actualValue \x3d option.property \x3d\x3d\x3d 'width' ? width : height;\n        attrName \x3d `${option.mode}-${option.property}`;\n        attrValue \x3d '';\n\n        if (option.mode \x3d\x3d\x3d 'min' \x26\x26 actualValue \x3e\x3d value) {\n          attrValue +\x3d option.value;\n        }\n\n        if (option.mode \x3d\x3d\x3d 'max' \x26\x26 actualValue \x3c\x3d value) {\n          attrValue +\x3d option.value;\n        }\n\n        if (!attrValues[attrName]) attrValues[attrName] \x3d '';\n        if (attrValue \x26\x26 (` ${attrValues[attrName]} `)\n                                            .indexOf(` ${attrValue} `) \x3d\x3d\x3d -1) {\n          attrValues[attrName] +\x3d ` ${attrValue}`;\n        }\n      }\n\n      for (let k \x3d 0; k \x3c attributes.length; k +\x3d 1) {\n        if (attrValues[attributes[k]]) {\n          this.element.setAttribute(attributes[k],\n                                                attrValues[attributes[k]].substr(1));\n        } else {\n          this.element.removeAttribute(attributes[k]);\n        }\n      }\n    };\n  }\n\n      /**\n       * @param {HTMLElement} element\n       * @param {Object}      options\n       */\n  function setupElement(originalElement, options) {\n    const element \x3d originalElement;\n    if (element.elementQueriesSetupInformation) {\n      element.elementQueriesSetupInformation.addOption(options);\n    } else {\n      element.elementQueriesSetupInformation \x3d new SetupInformation(element);\n      element.elementQueriesSetupInformation.addOption(options);\n      element.sensor \x3d new L.ResizeSensor(element, () \x3d\x3e {\n        element.elementQueriesSetupInformation.call();\n      });\n    }\n    element.elementQueriesSetupInformation.call();\n    return element;\n  }\n\n      /**\n       * @param {String} selector\n       * @param {String} mode min|max\n       * @param {String} property width|height\n       * @param {String} value\n       */\n  function queueQuery(selector, mode, property, value) {\n    let query;\n    if (document.querySelectorAll) query \x3d document.querySelectorAll.bind(document);\n    if (!query \x26\x26 typeof $$ !\x3d\x3d 'undefined') query \x3d $$;\n    if (!query \x26\x26 typeof jQuery !\x3d\x3d 'undefined') query \x3d jQuery;\n\n    if (!query) {\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\n    }\n\n    const elements \x3d query(selector) || [];\n    for (let i \x3d 0, j \x3d elements.length; i \x3c j; i +\x3d 1) {\n      elements[i] \x3d setupElement(elements[i], {\n        mode,\n        property,\n        value,\n      });\n    }\n  }\n\n  const regex \x3d /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?\x3d[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi;  // jshint ignore:line\n\n      /**\n       * @param {String} css\n       */\n  function extractQuery(originalCss) {\n    let match;\n    const css \x3d originalCss.replace(/'/g, '\"');\n    while ((match \x3d regex.exec(css)) !\x3d\x3d null) {\n      if (match.length \x3e 5) {\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\n      }\n    }\n  }\n\n      /**\n       * @param {CssRule[]|String} rules\n       */\n  function readRules(originalRules) {\n    if (!originalRules) {\n      return;\n    }\n    let selector \x3d '';\n    let rules \x3d originalRules;\n    if (typeof originalRules \x3d\x3d\x3d 'string') {\n      rules \x3d originalRules.toLowerCase();\n      if (rules.indexOf('min-width') !\x3d\x3d -1 || rules.indexOf('max-width') !\x3d\x3d -1) {\n        extractQuery(rules);\n      }\n    } else {\n      for (let i \x3d 0, j \x3d rules.length; i \x3c j; i +\x3d 1) {\n        if (rules[i].type \x3d\x3d\x3d 1) {\n          selector \x3d rules[i].selectorText || rules[i].cssText;\n          if (selector.indexOf('min-height') !\x3d\x3d -1 ||\n                          selector.indexOf('max-height') !\x3d\x3d -1) {\n            extractQuery(selector);\n          } else if (selector.indexOf('min-width') !\x3d\x3d -1 ||\n                                 selector.indexOf('max-width') !\x3d\x3d -1) {\n            extractQuery(selector);\n          }\n        } else if (rules[i].type \x3d\x3d\x3d 4) {\n          readRules(rules[i].cssRules || rules[i].rules);\n        }\n      }\n    }\n  }\n\n      /**\n       * Searches all css rules and setups the event listener\n       * to all elements with element query rules..\n       */\n  this.init \x3d () \x3d\x3e {\n    const styleSheets \x3d document.styleSheets || [];\n    for (let i \x3d 0, j \x3d styleSheets.length; i \x3c j; i +\x3d 1) {\n      if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssText')) {\n        readRules(styleSheets[i].cssText);\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssRules')) {\n        readRules(styleSheets[i].cssRules);\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'rules')) {\n        readRules(styleSheets[i].rules);\n      }\n    }\n  };\n};\n\nfunction init() {\n  (new L.ElementQueries()).init();\n}\n\nif (window.addEventListener) {\n  window.addEventListener('load', init, false);\n} else {\n  window.attachEvent('onload', init);\n}\n\n  /**\n   * Iterate over each of the provided element(s).\n   *\n   * @param {HTMLElement|HTMLElement[]} elements\n   * @param {Function}                  callback\n   */\nfunction forEachElement(elements, callback \x3d () \x3d\x3e {}) {\n  const elementsType \x3d Object.prototype.toString.call(elements);\n  const isCollectionTyped \x3d (elementsType \x3d\x3d\x3d '[object Array]' ||\n          (elementsType \x3d\x3d\x3d '[object NodeList]') ||\n          (elementsType \x3d\x3d\x3d '[object HTMLCollection]') ||\n          (typeof jQuery !\x3d\x3d 'undefined' \x26\x26 elements instanceof jQuery) || // jquery\n          (typeof Elements !\x3d\x3d 'undefined' \x26\x26 elements instanceof Elements) // mootools\n      );\n  let i \x3d 0;\n  const j \x3d elements.length;\n  if (isCollectionTyped) {\n    for (; i \x3c j; i +\x3d 1) {\n      callback(elements[i]);\n    }\n  } else {\n    callback(elements);\n  }\n}\n  /**\n   * Class for dimension change detection.\n   *\n   * @param {Element|Element[]|Elements|jQuery} element\n   * @param {Function} callback\n   *\n   * @constructor\n   */\nL.ResizeSensor \x3d function ResizeSensor(element, callback \x3d () \x3d\x3e {}) {\n      /**\n       *\n       * @constructor\n       */\n  function EventQueue() {\n    let q \x3d [];\n    this.add \x3d (ev) \x3d\x3e {\n      q.push(ev);\n    };\n\n    let i;\n    let j;\n    this.call \x3d () \x3d\x3e {\n      for (i \x3d 0, j \x3d q.length; i \x3c j; i +\x3d 1) {\n        q[i].call();\n      }\n    };\n\n    this.remove \x3d (ev) \x3d\x3e {\n      const newQueue \x3d [];\n      for (i \x3d 0, j \x3d q.length; i \x3c j; i +\x3d 1) {\n        if (q[i] !\x3d\x3d ev) newQueue.push(q[i]);\n      }\n      q \x3d newQueue;\n    };\n\n    this.length \x3d () \x3d\x3e q.length;\n  }\n\n      /**\n       *\n       * @param {HTMLElement} element\n       * @param {Function}    resized\n       */\n  function attachResizeEvent(htmlElement, resized) {\n    // Only used for the dirty checking, so the event callback count is limted\n    //  to max 1 call per fps per sensor.\n    // In combination with the event based resize sensor this saves cpu time,\n    // because the sensor is too fast and\n    // would generate too many unnecessary events.\n    const customRequestAnimationFrame \x3d window.requestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    function delay(fn) {\n      return window.setTimeout(fn, 20);\n    };\n\n    const newElement \x3d htmlElement;\n    if (!newElement.resizedAttached) {\n      newElement.resizedAttached \x3d new EventQueue();\n      newElement.resizedAttached.add(resized);\n    } else if (newElement.resizedAttached) {\n      newElement.resizedAttached.add(resized);\n      return;\n    }\n\n    newElement.resizeSensor \x3d document.createElement('div');\n    newElement.resizeSensor.className \x3d 'resize-sensor';\n    const style \x3d 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' +\n                      'overflow: hidden; z-index: -1; visibility: hidden;';\n    const styleChild \x3d 'position: absolute; left: 0; top: 0; transition: 0s;';\n\n    newElement.resizeSensor.style.cssText \x3d style;\n    newElement.resizeSensor.innerHTML \x3d\n              `\x3cdiv class\x3d\"resize-sensor-expand\" style\x3d\"${style}\"\x3e` +\n                  `\x3cdiv style\x3d\"${styleChild}\"\x3e\x3c/div\x3e` +\n              '\x3c/div\x3e' +\n              `\x3cdiv class\x3d\"resize-sensor-shrink\" style\x3d\"${style}\"\x3e` +\n                  `\x3cdiv style\x3d\"${styleChild} width: 200%; height: 200%\"\x3e\x3c/div\x3e` +\n              '\x3c/div\x3e';\n    newElement.appendChild(newElement.resizeSensor);\n\n    if (L.GetComputedStyle(newElement, 'position') \x3d\x3d\x3d 'static') {\n      newElement.style.position \x3d 'relative';\n    }\n\n    const expand \x3d newElement.resizeSensor.childNodes[0];\n    const expandChild \x3d expand.childNodes[0];\n    const shrink \x3d newElement.resizeSensor.childNodes[1];\n\n    const reset \x3d () \x3d\x3e {\n      expandChild.style.width \x3d `${100000}px`;\n      expandChild.style.height \x3d `${100000}px`;\n\n      expand.scrollLeft \x3d 100000;\n      expand.scrollTop \x3d 100000;\n\n      shrink.scrollLeft \x3d 100000;\n      shrink.scrollTop \x3d 100000;\n    };\n\n    reset();\n    let dirty \x3d false;\n\n    const dirtyChecking \x3d () \x3d\x3e {\n      if (!newElement.resizedAttached) return;\n\n      if (dirty) {\n        newElement.resizedAttached.call();\n        dirty \x3d false;\n      }\n\n      customRequestAnimationFrame(dirtyChecking);\n    };\n\n    customRequestAnimationFrame(dirtyChecking);\n    let lastWidth;\n    let lastHeight;\n    let cachedWidth;\n    let cachedHeight; // useful to not query offsetWidth twice\n\n    const onScroll \x3d () \x3d\x3e {\n      if ((cachedWidth \x3d newElement.offsetWidth) !\x3d\x3d lastWidth ||\n                (cachedHeight \x3d newElement.offsetHeight) !\x3d\x3d lastHeight) {\n        dirty \x3d true;\n\n        lastWidth \x3d cachedWidth;\n        lastHeight \x3d cachedHeight;\n      }\n      reset();\n    };\n\n    const addEvent \x3d (el, name, cb) \x3d\x3e {\n      if (el.attachEvent) {\n        el.attachEvent(`on${name}`, cb);\n      } else {\n        el.addEventListener(name, cb);\n      }\n    };\n\n    addEvent(expand, 'scroll', onScroll);\n    addEvent(shrink, 'scroll', onScroll);\n  }\n\n  forEachElement(element, (elem) \x3d\x3e {\n    attachResizeEvent(elem, callback);\n  });\n\n  this.detach \x3d (ev) \x3d\x3e {\n    L.ResizeSensor.detach(element, ev);\n  };\n};\n\nL.ResizeSensor.detach \x3d (element, ev) \x3d\x3e {\n  forEachElement(element, (elem) \x3d\x3e {\n    const elementItem \x3d elem;\n    if (elementItem.resizedAttached \x26\x26 typeof ev \x3d\x3d\x3d 'function') {\n      elementItem.resizedAttached.remove(ev);\n      if (elementItem.resizedAttached.length()) return;\n    }\n    if (elementItem.resizeSensor) {\n      if (elementItem.contains(elementItem.resizeSensor)) {\n        elementItem.removeChild(elementItem.resizeSensor);\n      }\n      delete elementItem.resizeSensor;\n      delete elementItem.resizedAttached;\n    }\n  });\n};\n"}])["default"];
//# sourceMappingURL=erizo.js.map
